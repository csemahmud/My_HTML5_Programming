/*!CK:3340504691!*//*1390346161,178186557*/

if (self.CavalryLogger) { CavalryLogger.start_js(["w7zj0"]); }

__d("EntstreamFeedObject",["Parent","cx"],function(a,b,c,d,e,f){var g=b('Parent'),h=b('cx'),i={getRoot:function(j){return g.byClass(j,"_5jmm");}};e.exports=i;});
__d("EntstreamFeedObjectFollowup",["CSS","DOM","EntstreamFeedObject","Event","React","XUICloseButton.react","csx","cx","ge"],function(a,b,c,d,e,f){var g=b('CSS'),h=b('DOM'),i=b('EntstreamFeedObject'),j=b('Event'),k=b('React'),l=b('XUICloseButton.react'),m=b('csx'),n=b('cx'),o=b('ge'),p={getFollowup:function(q){var r=h.scry(q,"._5lum");return r?r[0]:null;},addFollowup:function(q,r,s){var t=g.hasClass(q,"_5pat"),u=h.create('div',{className:"_5lum"});if(t){g.addClass(u,"_5pau");}else g.addClass(u,"_1f84");if(r){var v=h.create('div',{},r),w=h.create('div',{'class':"_5dh8"});k.renderComponent(l({size:"medium",shade:"dark"}),w);h.appendContent(u,w);j.listen(w,'click',function(){h.remove(u);});h.appendContent(u,v);}if(s)g.addClass(u,s);var x=p.getFollowup(q);if(x){h.replace(x,u);}else h.prependContent(q,u);},removeFollowup:function(q){var r=p.getFollowup(q);h.remove(r);},appendToFollowup:function(q,r){var s=i.getRoot(o(q)),t=p.getFollowup(s);h.appendContent(t,r);},getFollowupMessage:function(q){var r=i.getRoot(o(q)),s=h.find(r,"._1f86");return s;},replaceFollowupMessage:function(q,r){var s=p.getFollowupMessage(q);h.replace(s,r);},resetAfroFollowupContent:function(q,r){p.unhideFollowupMessage(q);var s=i.getRoot(o(q)),t=h.find(s,"._5lul");h.replace(t,r);},hideFollowupMessage:function(q){var r=p.getFollowupMessage(q);g.hide(r);},unhideFollowupMessage:function(q){var r=p.getFollowupMessage(q);g.show(r);}};e.exports=p;});
__d("EntstreamFeedObjectFollow",["EntstreamFeedObject","EntstreamFeedObjectFollowup","Event","Parent","cx","ge"],function(a,b,c,d,e,f){var g=b('EntstreamFeedObject'),h=b('EntstreamFeedObjectFollowup'),i=b('Event'),j=b('Parent'),k=b('cx'),l=b('ge'),m={toggleFollow:function(n,o,p){var q=n.getValue()=='follow_post'?p.follow_post:p.unfollow_post,r=g.getRoot(l(o));if(h.getFollowup(r)){h.replaceFollowupMessage(r,q);}else{h.addFollowup(r,q,"_521o");var s=h.getFollowup(r);i.listen(s,'click',function(event){var t=event.getTarget(),u="_1f89";if(j.byClass(t,u)){m.toggleFollow(n,o,p);n.toggleMenuItem();}});}}};e.exports=m;});
__d("EntstreamFeedObjectHide",["Event","CSS","EntstreamFeedObject","EntstreamFeedObjectFollowup","Focus","TabbableElements","cx","ge"],function(a,b,c,d,e,f){var g=b('Event'),h=b('CSS'),i=b('EntstreamFeedObject'),j=b('EntstreamFeedObjectFollowup'),k=b('Focus'),l=b('TabbableElements'),m=b('cx'),n=b('ge'),o={hide:function(p,q){var r=i.getRoot(n(p));j.addFollowup(r,q);h.addClass(r,"_i6m");o.setFocus(r);},registerUnhide:function(p,q){g.listen(p,'click',function(){if(q)q.send();o.unhide(i.getRoot(p));});},setFocus:function(p){var q=l.find(p);if(q&&q[0])k.setWithoutOutline(q[0]);},unhide:function(p){j.removeFollowup(p);h.removeClass(p,"_i6m");o.setFocus(p);}};e.exports=o;});
__d("YouTube",["CSS","DOM","DOMQuery","Event","Keys","LitestandStoryInsertionStatus","SubscriptionsHandler","UserAgent","Focus","copyProperties","cx"],function(a,b,c,d,e,f){var g=b('CSS'),h=b('DOM'),i=b('DOMQuery'),j=b('Event'),k=b('Keys'),l=b('LitestandStoryInsertionStatus'),m=b('SubscriptionsHandler'),n=b('UserAgent'),o=b('Focus'),p=b('copyProperties'),q=b('cx');function r(s,t,u){"use strict";var v=new m();v.addSubscriptions(j.listen(s,'load',this.listening.bind(this)),l.registerBlocker(function(){return this.playerState===r.STATE_PLAYING;}.bind(this)));p(this,{iframe:s,autofocus:t,autoplay:u,playerState:r.STATE_UNSTARTED,muted:false,volume:100,currentTime:0,timer:null,handler:v});if(t)o.set(s);}r.prototype.id=function(){"use strict";return this.iframe.id;};r.prototype.post=function(s){"use strict";s.id=this.id();this.iframe.contentWindow.postMessage(JSON.stringify(s),'*');};r.prototype.listening=function(){"use strict";this.post({event:'listening'});clearTimeout(this.timer);this.timer=setTimeout(this.listening.bind(this),100);};r.prototype.update=function(s){"use strict";if(s.event=='initialDelivery'){clearTimeout(this.timer);if((n.webkit()||n.firefox())&&s.info&&s.info.debugText.match(/flashVersion/)){this.addAccessibleButtons();if(n.firefox())this.iframe.tabIndex=-1;}}if(s.info)['playerState','muted','volume','currentTime'].forEach(function(t){if(s.info.hasOwnProperty(t))this[t]=s.info[t];}.bind(this));};r.prototype.togglePlay=function(){"use strict";this.post({event:'command',func:(this.playerState==r.STATE_PLAYING)?'pauseVideo':'playVideo'});};r.prototype.toggleMute=function(){"use strict";this.post({event:'command',func:this.muted?'unMute':'mute'});};r.prototype.addAccessibleButtons=function(){"use strict";this.addAccessibleButton('Mute',"_505m",this.toggleMute.bind(this));this.addAccessibleButton('Play',"_505n",this.togglePlay.bind(this));};r.prototype.addAccessibleButton=function(s,t,u){"use strict";var v=h.create('button',{'class':t,tabindex:0},s);h.insertAfter(this.iframe,v);this.handler.addSubscriptions(j.listen(v,'click',u),j.listen(v,'mouseover',g.hide.bind(null,v)),j.listen(this.iframe,'mouseout',g.show.bind(null,v)),j.listen(v,'focus',function(){if(!this.autoplay&&this.playerState==r.STATE_UNSTARTED){this.post({event:'command',func:'playVideo'});this.post({event:'command',func:'pauseVideo'});}}.bind(this)),j.listen(v,'keydown',function(w){switch(w.keyCode){case k.UP:case k.DOWN:this.post({event:'command',func:'setVolume',args:[this.volume+((w.keyCode==k.UP)?10:-10)]});w.prevent();break;case k.RIGHT:case k.LEFT:this.post({event:'command',func:'seekTo',args:[this.currentTime+((w.keyCode==k.RIGHT)?10:-10)]});w.prevent();break;}}.bind(this)));return v;};r.prototype.destroy=function(){"use strict";this.handler.release();delete r.instances[this.id()];if(!Object.keys(r.instances).length)r.handler.remove();};r.register=function(s,t,u){"use strict";if(!window.postMessage)return;if(!Object.keys(r.instances).length)r.handler=j.listen(window,'message',function(w){try{var x=JSON.parse(w.data);if(r.instances[x.id])r.instances[x.id].update(x);}catch(w){}});var v=new r(i.find(s,'iframe'),t,u);r.instances[v.id()]=v;};p(r,{STATE_UNSTARTED:-1,STATE_PLAYING:1,instances:{},handler:null});e.exports=r;});
__d("EntstreamHomeFeedObjectHide",["AsyncRequest","CSS","DOM","EntstreamFeedObject","EntstreamFeedObjectHide","Event","TrackingNodes","YouTube","csx","cx","ge","tx","$"],function(a,b,c,d,e,f){var g=b('AsyncRequest'),h=b('CSS'),i=b('DOM'),j=b('EntstreamFeedObject'),k=b('EntstreamFeedObjectHide'),l=b('Event'),m=b('TrackingNodes'),n=b('YouTube'),o=b('csx'),p=b('cx'),q=b('ge'),r=b('tx'),s=b('$'),t={stopVideo:function(u){var v=s(u),w=i.find(v,"^._5jmm"),x=i.scry(w,'iframe');for(var y=0;y<x.length;y++){var z=n.instances[i.getID(x[y])];if(z&&(z.playerState===n.STATE_PLAYING))z.togglePlay();}var aa=i.scry(w,'video');for(var ba=0;ba<aa.length;ba++)if(('paused' in aa[ba])&&!aa[ba].paused)if(typeof aa[ba].pause==='function')aa[ba].pause();},hide:function(u,v,w,x){t.stopVideo(u);var y=j.getRoot(q(u)),z=h.hasClass(y,"_5pat"),aa;if(z&&w=='afrostart'){aa='';}else{var ba=w=='hide'||w=='afrostart'?"This story is now hidden from your News Feed.":"This story has been marked as spam.",ca=w=='hide'||w=='afrostart'?"Unhide":"Undo",da=m.getTrackingInfo(m.types.UNHIDE_LINK),ea=i.create('a',{href:'#','data-ft':da},ca),fa={};if(v)fa.token=v;if(x)fa.hideable_token=x;var ga=new g().setURI('/ajax/entstream/home/story/unhide').setMethod('POST').setData(fa).setRelativeTo(ea);k.registerUnhide(ea,ga);aa=i.create('div',{'class':"_1f86"},[ba,' ',ea]);}k.hide(u,aa);},registerHide:function(u,v,w,x){l.listen(u,'click',function(){t.hide(u.getAttribute('id'),v,w,x);});}};e.exports=t;});
__d("EntstreamHomeFeedObjectOptionsMenu",["EntstreamHomeFeedObjectHide","EntstreamFeedObjectFollow"],function(a,b,c,d,e,f){var g=b('EntstreamHomeFeedObjectHide'),h=b('EntstreamFeedObjectFollow');function i(j,k,l,m,n){j.subscribe('itemclick',function(o,p){switch(p.item.getValue()){case 'hide':case 'markspam':case 'afrostart':g.hide(k,l,p.item.getValue(),n);break;case 'follow_post':case 'unfollow_post':h.toggleFollow(p.item,k,m);break;}}.bind(this));}e.exports=i;});
__d("UIIntentionalStreamRefresher",["Arbiter","LiveTimer","Run","UIIntentionalStreamMessage","UserActivity","DOM","coalesce","copyProperties","csx"],function(a,b,c,d,e,f){var g=b('Arbiter'),h=b('LiveTimer'),i=b('Run'),j=b('UIIntentionalStreamMessage'),k=b('UserActivity'),l=b('DOM'),m=b('coalesce'),n=b('copyProperties'),o=b('csx');function p(q,r){this.isAutoRefreshing=false;this.lastRefresh=Date.now();p.instance=this;this.setAutoRefreshConfig(q);this.updateConfigHandler=g.subscribe(j.UPDATE_AUTOREFRESH_CONFIG,this.updateAutoRefreshConfig.bind(this));this.updateRefreshTimeHandler=g.subscribe(j.UPDATE_LAST_REFRESH_TIME,this.updateLastRefreshTime.bind(this));i.onLeave(this.unload.bind(this));this.userActivity();this.uaToken=k.subscribe(this.userActivity.bind(this));this.autoRefreshInterval=setInterval(this.checkAutoPageRefresh.bind(this),this.checkAutoRefreshTimeInterval);this.activeRefreshInterval=setInterval(this.checkActiveRefresh.bind(this),this.checkActiveRefreshTimeInterval);this.enableAutoRefresh(r);g.subscribe(j.UPDATE_STREAM,h.loop.bind(h,true));g.subscribe(j.REFRESH_STREAM,h.loop.bind(h,true));this.feedAdsDialogHandler=g.subscribe(['FeedProfileQuestionAnswered','ProfileQuestionAnswered'],this.refreshFeedAdsDialog.bind(this));}n(p,{DISABLE_AUTOREFRESH_TIME:4*60*1000,CHECK_AUTOREFRESH_INTERVAL:5*60*1000,AUTOREFRESH_INACTIVE_TIME:30*60*1000,CHECK_ACTIVE_REFRESH_TIME:5*60*1000,ACTIVE_REFRESH_TIME:30*1000,create:function(q,r){new p(q,r);}});n(p.prototype,{updateAutoRefreshConfig:function(q,r){if(q==j.UPDATE_AUTOREFRESH_CONFIG)this.setAutoRefreshConfig(r);},updateLastRefreshTime:function(q){if(q==j.UPDATE_LAST_REFRESH_TIME)this.lastRefresh=Date.now();},refreshFeedAdsDialog:function(q,r){l.scry(document.body,".personalizeStreamAds").forEach(function(s){l.replace(s,r);});},setAutoRefreshConfig:function(q){q=q||{};var r=24*60*60*1000;if(!this.storyInterval)this.storyInterval=m(q.story_interval,null);this.allowAutoRefresh=m(q.allow_auto_refresh,false);this.inactiveThreshold=m(q.inactive_threshold,0);this.activeRefreshTime=m(q.fast_refresh_rate,r);this.inactiveRefreshTime=m(q.slow_refresh_rate,r);this.allowPolling=m(q.allow_polling,false);this.refreshFactor=m(q.refresh_factor,10);this.minRefreshInterval=m(q.min_refresh_interval,60*1000);this.activeRefresh=m(q.active_refresh,false);this.checkActiveRefreshTimeInterval=m(q.check_active_refresh_interval,p.CHECK_ACTIVE_REFRESH_TIME);this.activeRefreshTimeInterval=m(q.active_refresh_interval,p.ACTIVE_REFRESH_TIME);this.disableAutoRefreshTime=m(q.disable_autorefresh_time,p.DISABLE_AUTOREFRESH_TIME);this.checkAutoRefreshTimeInterval=m(q.check_autorefresh_time_interval,p.CHECK_AUTOREFRESH_INTERVAL);this.autoRefreshInactiveTime=m(q.autorefresh_inactive_time,p.AUTOREFRESH_INACTIVE_TIME);return this;},unload:function(){this.enableAutoRefresh(false);this.cleanupRefreshInterval();k.unsubscribe(this.uaToken);this.updateConfigHandler&&this.updateConfigHandler.unsubscribe();this.updateRefreshTimeHandler&&this.updateRefreshTimeHandler.unsubscribe();this.feedAdsDialogHandler&&this.feedAdsDialogHandler.unsubscribe();},userActivity:function(){var q=this.isInactive();this.lastActivity=Date.now();this.isAutoRefreshing=true;if(q&&this.canAutoRefresh())this.runAutoRefresh();return true;},isInactive:function(){return this.getMSSinceLastActivity()>this.inactiveThreshold;},getMSSinceLastActivity:function(){return Date.now()-this.lastActivity;},getMSSinceLastRefresh:function(){return Date.now()-this.lastRefresh;},getRefreshInterval:function(){if(this.isInactive()){return this.inactiveRefreshTime;}else if(this.storyInterval!=null){var q=this.storyInterval*this.refreshFactor;return Math.max(q,this.activeRefreshTime);}else return this.activeRefreshTime;},canAutoRefresh:function(){return this.isAutoRefreshing&&this.allowAutoRefresh;},cancelUpdate:function(){if(this.updateTask){clearTimeout(this.updateTask);this.updateTask=null;}},runUpdatePoll:function(){this.updateTask=null;if(this.canAutoRefresh())this.runAutoRefresh();},runAutoRefresh:function(){var q=50;if(this.getMSSinceLastRefresh()>=this.minRefreshInterval-q)g.inform(j.UPDATE_STREAM);this.schedulePoll(this.getRefreshInterval());},schedulePoll:function(q){this.cancelUpdate();if(this.allowPolling)this.updateTask=setTimeout(this.runUpdatePoll.bind(this),q);},enableAutoRefresh:function(q,r){this.isAutoRefreshing=q;if(q){var s=r?0:this.getRefreshInterval();this.schedulePoll(s);}else this.cancelUpdate();},checkAutoPageRefresh:function(){if(!this.allowAutoRefresh)return;if(this.isAutoRefreshing&&(this.getMSSinceLastActivity()>this.disableAutoRefreshTime))this.isAutoRefreshing=false;if(this.getMSSinceLastRefresh()<this.autoRefreshInactiveTime)return;var q=this.getMSSinceLastActivity();if(q>this.autoRefreshInactiveTime)g.inform(j.REFRESH_STREAM,{});},checkActiveRefresh:function(){if(!this.allowAutoRefresh)return;if(this.getMSSinceLastRefresh()<this.activeRefreshTimeInterval)return;if(this.getMSSinceLastActivity()<this.activeRefreshTimeInterval)g.inform(j.UPDATE_STREAM);},cleanupRefreshInterval:function(){if(this.autoRefreshInterval){clearInterval(this.autoRefreshInterval);this.autoRefreshInterval=null;}if(this.activeRefreshInterval){clearInterval(this.activeRefreshInterval);this.activeRefreshInterval=null;}}});e.exports=p;});
__d("UIIntentionalStream",["Animation","Arbiter","AsyncRequest","AsyncResponse","CSS","DataStore","DOM","DOMScroll","Event","HTML","JSLogger","NavigationMessage","OnVisible","PageTransitions","Run","ScrollAwareDOM","Style","UIIntentionalStreamMessage","UIIntentionalStreamRefresher","UIPagelet","URI","Vector","$","coalesce","copyProperties","createArrayFrom","ge","isEmpty","merge","reportData","startsWith"],function(a,b,c,d,e,f){var g=b('Animation'),h=b('Arbiter'),i=b('AsyncRequest'),j=b('AsyncResponse'),k=b('CSS'),l=b('DataStore'),m=b('DOM'),n=b('DOMScroll'),o=b('Event'),p=b('HTML'),q=b('JSLogger'),r=b('NavigationMessage'),s=b('OnVisible'),t=b('PageTransitions'),u=b('Run'),v=b('ScrollAwareDOM'),w=b('Style'),x=b('UIIntentionalStreamMessage'),y=b('UIIntentionalStreamRefresher'),z=b('UIPagelet'),aa=b('URI'),ba=b('Vector'),ca=b('$'),da=b('coalesce'),ea=b('copyProperties'),fa=b('createArrayFrom'),ga=b('ge'),ha=b('isEmpty'),ia=b('merge'),ja=b('reportData'),ka=b('startsWith');function la(){h.subscribe(x.SET_AUTO_INSERT,ma);}function ma(oa,pa){if(oa!=x.SET_AUTO_INSERT)return;var qa=na.instance;if(qa)qa.pauseAutoInsert=pa.pause;}function na(oa,pa,qa,ra,sa,ta,ua,va,wa,xa,ya){if(!oa)throw new Error('UIIntentionalStream instantiated with no root.');ea(this,{id:oa.id,root:oa,instanceName:pa,newest:qa,oldest:ra,oldestMR:ra,shouldShowHidden:false,defaultFilter:sa,currentFilterKey:xa,sourceType:ta,lastSeenTime:ya,hasPendingRefresh:false,pauseAutoInsert:false,error:m.scry(oa,'div.UIIntentionalStream_Error')[0],pager:m.scry(oa,'div.uiMorePager')[0],filterNullState:m.scry(oa,'div.friendListFilterNullState')[0],streamContent:m.find(oa,'.UIIntentionalStream_Content'),requestNum:0,scrollLoadCount:1,maxScrollLoadCount:1,scrollPosition:0,lastViewStateID:0,cachedScrollQID:0,jslog:q.create('stream'),scrollListener:null,newIndexOffset:0});this.addScrollTrace('init',{});u.onLeave(this.unload.bind(this));if(!na.instances)na.instances={};na.instances[pa]=this;na.instance=this;la();this.setupSubscriptions();}ea(na.prototype,{subscribeToComposerPublish:function(){this.subscriptions.push(h.subscribe('composer/publish',function(event,oa){var pa=ca(oa.composer_id).getAttribute('data-location');if(pa==='maincolumn'&&oa.streamStory)this.addComposerContent(oa.streamStory,500);}.bind(this)));},setupSubscriptions:function(){this.subscriptions=[];this.subscribeToComposerPublish();this.subscriptions.push(h.subscribe(x.UPDATE_STREAM,this.updateStream.bind(this)));this.subscriptions.push(h.subscribe(x.REFRESH_STREAM,this.refreshStream.bind(this)));this.scrollListener=o.listen(window,'scroll',this.checkFirstScroll.bind(this));this.checkFirstScroll();u.onLoad(this.checkFirstStory.bind(this));},tearDownSubscriptions:function(){if(!this.subscriptions)return;this.subscriptions.forEach(h.unsubscribe);this.subscriptions=null;if(this.scrollListener){this.scrollListener.remove();this.scrollListener=null;}},unload:function(){this.addScrollTrace('unload',{});h.inform(x.UNLOAD);this.tearDownSubscriptions();na.instance=null;na.instances[this.instanceName]=null;this.clearScrollLoader(true);window.disableScrollLoad=null;y.instance&&y.instance.unload();},_getUpdateInsertType:function(){return na.REFRESH_PREPEND;},updateStream:function(oa){if(oa!=x.UPDATE_STREAM||this.hasPendingRefresh||this.isAutoRefreshPaused())return;this.loadNewer({showLoader:false,ignoreSelf:true,insertType:this._getUpdateInsertType()});},clearScrollLoader:function(oa){if(this.currentScrollListener){this.currentScrollListener.remove();this.currentScrollListener=null;}if(oa||this.scrollLoadCount>=this.maxScrollLoadCount)window.disableScrollLoad=true;},loadOlderPosts:function(oa){var pa={filter:this.getCurrentFilterKey(),oldest:this.oldest,oldestMR:this.oldestMR,last_seen_time:this.lastSeenTime,scroll_count:this.scrollLoadCount,scroll_position:this.scrollPosition,last_viewstate_id:this.lastViewStateID,cached_scroll_qid:this.cachedScrollQID};this.homeloadID&&(pa.homeload_id=this.homeloadID);pa=ia(pa,oa);this.loadWithParams(pa);},loadWithParams:function(oa){var pa=m.scry(this.root,'div.fbStreamPager.hasMorePosts')[0];if(pa){if(k.hasClass(pa,'async_saving'))return;k.addClass(pa,'async_saving');}this.addScrollTrace('loadwithparams',oa);z.loadFromEndpoint('MoreStoriesPagelet','home_stream',oa,{append:true,usePipe:true});},setScrollLoadCount:function(oa){this.maxScrollLoadCount=oa;},setHomeloadID:function(oa){this.homeloadID=oa;},loadMoreOnScroll:function(oa,pa){if(window.disableScrollLoad)return;var qa=function(){if(window.disableScrollLoad)return;var ta={delay_load_count:pa};this.loadOlderPosts(ta);}.bind(this),ra=m.scry(this.root,'ul.uiStream li.genericStreamStory');if(!ra.length)return;this.addScrollTrace('loadmoreonscroll',{});var sa=ra[ra.length-oa-1];if(sa){this.currentScrollListener=new s(sa,qa,null,0);}else qa();},updateTimeRange:function(oa,pa){if(!this.newest||this.newest<oa){this.newest=oa;this.addScrollTrace('update_newest',{newest:this.newest});}if(!this.oldest||(pa&&(pa<this.oldest))){this.oldest=pa;this.addScrollTrace('update_oldest',{oldest:this.oldest});}},updateOldestMR:function(oa){if(!this.oldestMR||oa<this.oldestMR){this.oldestMR=oa;this.addScrollTrace('update_oldestmr',{oldestmr:this.oldestMR});}},updateScrollPosition:function(oa){this.scrollPosition=oa;this.addScrollTrace('update_scrollposition',{scrollposition:this.scrollPosition});},updateLastViewStateID:function(oa){this.lastViewStateID=oa;this.addScrollTrace('update_lastviewstateid',{lastviewstateid:this.lastViewStateID});},updateCachedScrollQID:function(oa){this.cachedScrollQID=oa;this.addScrollTrace('update_cachedscrollqid',{qid:this.cachedScrollQID});},getID:function(){return this.id;},getCurrentFilterKey:function(){if(this.currentFilterKey)return this.currentFilterKey;var oa=aa.getMostRecentURI().getQueryData();if(oa&&oa.sk){this.currentFilterKey=oa.sk;}else if(oa&&oa.filter){this.currentFilterKey=oa.filter;}else if(this.defaultFilter)this.currentFilterKey=this.defaultFilter;return this.currentFilterKey;},resetFilterKey:function(oa){this.currentFilterKey=oa;},loadOlder:function(oa){oa=oa||{};if(!this.oldest)return;var pa=this.getCurrentParams();pa.oldest=this.oldest;this.refresh(na.REFRESH_APPEND,pa,oa);return this;},loadNewer:function(oa){if(!this.newest)return;oa=oa||{};var pa=this.getCurrentParams();pa.newest=this.newest;if(oa.ignoreSelf)pa.ignore_self=true;pa.load_newer=true;var qa=da(oa.insertType,na.REFRESH_PREPEND);this.refresh(qa,pa,oa);return this;},checkFirstStory:function(){this.logFirstStory('first_story_load');},checkFirstScroll:function(){if(this.scrollListener&&ba.getScrollPosition().y>0){this.scrollListener.remove();this.scrollListener=null;this.logFirstStory('first_scrolling');}},logFirstStory:function(oa){if(!ga('home_stream')||!ga('home_stream').childElementCount||!ga('home_stream').children[0].getAttribute('data-ft'))return;var pa=ga('home_stream').children[0].getAttribute('data-ft'),qa=JSON.parse(pa);if(!(("mf_story_key" in qa)&&("qid" in qa)))return;var ra={mf_story_key:qa.mf_story_key,qid:qa.qid};ja(oa,{ft:ra});},getCurrentParams:function(){var oa={},pa=aa.getMostRecentURI().getQueryData();pa.filter=this.getCurrentFilterKey();var qa=this.getValidParams();if(qa){qa.forEach(function(ra){oa[ra]=pa[ra];});}else oa=pa;return oa;},setHomeFilter:function(oa){this._homeFilter=oa;},setHomeFilterLoading:function(oa){if(this._homeFilter)this._homeFilter.setLoading(oa);},refresh:function(oa,pa,qa){h.inform(x.UPDATE_LAST_REFRESH_TIME);this.homeloadID&&(pa.homeload_id=this.homeloadID);this.addScrollTrace('refresh',{type:oa,data:pa,kwargs:qa});this.currentFilterKey=pa.filter;if(pa.filter==na.FEED_FILTER_KEY_DUAL_NEWS_FEED){this.currentFilterKey=this.defaultFilter;}else if(na.isHighlightsFilter(pa.filter)||pa.filter===na.FEED_FILTER_KEY_NEWS_FEED)this.defaultFilter=this.currentFilterKey;qa=qa||{};var ra=++this.requestNum,sa=da(qa.showLoader,true),ta=this.instanceName,ua=function(ya){na.getInstance(ta).handleResponse(ra,oa,ya,qa);},va=function(ya){na.getInstance(ta).handleError(ra,oa,ya,qa);},wa=function(ya){na.getInstance(ta).handleFinally(oa,pa.filter,ya);};if(!(pa.request_type=oa))pa.request_type='none';if(pa.filter){qa.show_hidden=pa.show_hidden?pa.show_hidden:false;}else qa.show_hidden=this.shouldShowHidden;pa=ea(this.getCurrentParams(),pa);this.hasPendingRefresh=true;var xa=new i().setURI(this.getEndpoint()).setReadOnly(true).setOption('retries',0).setMethod(this.getRefreshMethod()).setData(pa).setHandler(ua).setErrorHandler(va).setFinallyHandler(wa);if(oa==na.REFRESH_APPEND&&sa)xa.setStatusElement(this.pager);xa.send();if(oa==na.REFRESH_TRANSITION){if(this.pager)this.pager.style.display='none';this.clearScrollLoader();this.oldest=this.newest=null;}if(sa)this.setHomeFilterLoading(true);},addComposerContent:function(oa,pa){if(this.isOnNewsFeedFilter())k.addClass(oa,'uiStreamBoulderHighlight');this.addContentPrepend(oa,pa);},applyNewIndexes:function(oa){for(var pa=oa.length-1;pa>=0;pa--)oa[pa].setAttribute('data-insertion-position',--this.newIndexOffset);h.inform('Stream/totalHeadLoadedStories',-this.newIndexOffset);},addContentPrepend:function(oa,pa){if(oa.length){fa(oa).reverse().forEach(function(va){this.addContentPrepend(va,pa);}.bind(this));return;}var qa,ra=ba.getScrollPosition().y,sa=ba.getElementPosition(this.streamContent).y,ta=this.scrollOnPrepend&&ra>=sa;if(ta){var ua=function(va){var wa=m.find(va,'^li.uiStreamStory');if(!wa)return;l.set(wa,'origHeight',wa.offsetHeight);o.listen(va,'load',function(){var xa=l.get(wa,'origHeight');if(wa.offsetHeight!=xa){window.scrollBy(0,wa.offsetHeight-xa);l.set(wa,'origHeight',wa.offsetHeight);}});};qa=g.insert.bind(null,this.streamContent,oa,(function(va,wa){m.prependContent(this.streamContent,wa);h.inform('reflow');window.scrollBy(0,wa.offsetHeight);m.scry(wa,'img').forEach(ua);}).bind(this));}else qa=(function(){w.set(oa,'opacity',0);v.prependContent(this.streamContent,oa);h.inform('reflow');new g(oa).from('opacity',0).to('opacity',1).duration(400).ondone(function(){h.inform(x.UPDATE_HTML_CONTENT);}).go();}).bind(this);if(pa){k.hide(oa);m.appendContent(document.body,oa);setTimeout(function(){k.show(oa);qa();},pa);}else qa();},addContentAppend:function(oa){m.appendContent(this.streamContent,oa);},handleResponse:function(oa,pa,qa,ra){this.addScrollTrace('handle_response',{requestnum:oa,type:pa,kwargs:ra});ra=ra||{};var sa=qa.getPayload();this.filterNullState&&m.remove(this.filterNullState);if(ha(sa))return;if(sa.autoRefreshConfig)h.inform(x.UPDATE_AUTOREFRESH_CONFIG,sa.autoRefreshConfig);this.setHomeFilterLoading(false);if(pa==na.REFRESH_EXPAND){var ta=m.find(ca(ra.expandStoryID),'div.UIIntentionalStory_CollapsedStories');k.hide(ta);k.removeClass(ta,'UIIntentionalStory_CollapsedStoriesLoading');}if(this.error)this.error.style.display='none';if(oa!=this.requestNum)return;if('show_hidden' in ra)this.shouldShowHidden=ra.show_hidden;if('newestStoryTime' in sa&&sa.newestStoryTime>this.newest)this.newest=sa.newestStoryTime;if(pa!=na.REFRESH_PREPEND){if('oldestStoryTime' in sa&&(!this.oldest||sa.oldestStoryTime<this.oldest))this.oldest=sa.oldestStoryTime;if('scrollPosition' in sa)this.scrollPosition=sa.scrollPosition;if('lastViewStateID' in sa)this.lastViewStateID=sa.lastViewStateID;if('oldestMRStoryTime' in sa)this.oldestMR=sa.oldestMRStoryTime;if('cachedScrollQID' in sa){this.cachedScrollQID=sa.cachedScrollQID;}else this.cachedScrollQID=0;}if(sa.html){var ua=p(sa.html).getNodes();switch(pa){case na.REFRESH_PREPEND:this.applyNewIndexes(ua);this.addContentPrepend(ua);break;case na.REFRESH_APPEND:this.addContentAppend(ua);this.clearScrollLoader(true);break;case na.REFRESH_TRANSITION:m.setContent(this.streamContent,ua);this.scrollLoadCount=1;if(!ra.noScroll)n.scrollTo(new ba(0,0,"document"),false);break;case na.REFRESH_EXPAND:m.insertAfter(ca(ra.expandStoryID),ua);break;case na.DELAYED_STREAM:this.addContentAppend(ua);break;}h.inform(x.UPDATE_HTML_CONTENT);}},handleError:function(oa,pa,qa,ra){if(oa!=this.requestNum)return;this.setHomeFilterLoading(false);var sa=qa.getError();if(sa==1357001)j.defaultErrorHandler(qa);if(pa==na.REFRESH_EXPAND){var ta=m.find(ca(ra.expandStoryID),'div.UIIntentionalStory_CollapsedStories');k.removeClass(ta,'UIIntentionalStory_CollapsedStoriesLoading');}if(!ra.delayLoadCount&&pa!=na.REFRESH_PREPEND&&this.error)w.set(this.error,'display','block');},handleFinally:function(oa,pa){if(oa==na.REFRESH_TRANSITION){t.transitionComplete();h.inform(r.NAVIGATION_COMPLETED);}this.hasPendingRefresh=false;},getValidParams:function(){return na.VALID_PARAMS;},getEndpoint:function(){return na.ENDPOINT;},getRefreshMethod:function(){return na.REFRESH_METHOD;},isOnNewHighlights:function(){var oa=this.getCurrentFilterKey();return (na.isHighlightsFilter(oa)||(oa==na.FEED_FILTER_KEY_DUAL_NEWS_FEED&&na.isHighlightsFilter(this.defaultFilter)));},isLiveStreamBox:function(){var oa=this.getCurrentFilterKey();return oa&&oa.indexOf(na.FEED_FILTER_KEY_LIVE_STREAM_BOX)===0;},isOnNewsFeedFilter:function(){var oa=this.getCurrentFilterKey();return (oa==na.FEED_FILTER_KEY_NEWS_FEED||na.isHighlightsFilter(oa)||oa==na.FEED_FILTER_KEY_DUAL_NEWS_FEED);},isAutoRefreshPaused:function(){if(this.isOnNewHighlights()||this.isLiveStreamBox())return false;return this.pauseAutoInsert;},addScrollTrace:function(oa,pa){this.jslog.debug(oa,pa);},refreshStream:function(oa,pa){if(oa!=x.REFRESH_STREAM)return;var qa=this.getCurrentFilterKey(),ra={filter:qa},sa={filter:qa};pa.noScroll&&(sa.noScroll=1);this.refresh(na.REFRESH_TRANSITION,ra,sa);},getNewest:function(){return this.newest;}});ea(na,{ANIMATION_DURATION:300,REFRESH_METHOD:'GET',REFRESH_TRANSITION:1,REFRESH_PREPEND:2,REFRESH_APPEND:3,REFRESH_EXPAND:5,DELAYED_STREAM:6,FEED_FILTER_KEY_NEW_HIGHLIGHTS:'h',FEED_FILTER_KEY_NEWS_FEED:'lf',FEED_FILTER_KEY_DUAL_NEWS_FEED:'nf',FEED_FILTER_KEY_LIVE_STREAM_BOX:'pub',VALID_PARAMS:['filter','show_hidden'],ENDPOINT:'/ajax/intent.php',getInstance:function(oa){return na.instances[oa];},isHighlightsFilter:function(oa){if(!oa)return false;return ka(oa,na.FEED_FILTER_KEY_NEW_HIGHLIGHTS);},getStoriesByAssoc:function(oa){return m.scry(na.instance.root,'div.aid_'+oa);}});e.exports=na;});
__d("FutureHomeSideNav",["Arbiter","AsyncRequest","CSS","DOM","FutureSideNav","FutureSideNavItem","FutureSideNavSection","NavigationMessage","UIIntentionalStream","UIPagelet","emptyFunction","tx"],function(a,b,c,d,e,f){var g=b('Arbiter'),h=b('AsyncRequest'),i=b('CSS'),j=b('DOM'),k=b('FutureSideNav'),l=b('FutureSideNavItem'),m=b('FutureSideNavSection'),n=b('NavigationMessage'),o=b('UIIntentionalStream'),p=b('UIPagelet'),q=b('emptyFunction'),r=b('tx');for(var s in k)if(k.hasOwnProperty(s))u[s]=k[s];var t=k===null?null:k.prototype;u.prototype=Object.create(t);u.prototype.constructor=u;u.__superConstructor__=k;function u(){"use strict";if(k!==null)k.apply(this,arguments);}u.prototype.init=function(){"use strict";t.init.apply(this,arguments);this.ajaxPipe=true;this.seeAllEndpoint="/ajax/home/generic.php";this.typeSections={favorites:'pinnedNav',profiles:'pinnedNav',company:'companyNav',apps:'appsNav',groups:'groupsNav',pages:'pagesNav',lists:'listsNav',interests:'interestsNav',connect_apps:'connectNav',type_user:'pinnedNav',type_group:'groupsNav',type_page:'pagesNav',type_friend_list:'listsNav',type_interest_list:'interestsNav',type_non_canvas_app:'appsNav',type_facebook_app:'appsNav'};this._arbiterSubscriptions.push(g.subscribe(n.NAVIGATION_FAVORITE_UPDATE,this.updateFavorite.bind(this)),g.subscribe(n.NAVIGATION_FIRST_RESPONSE,this.navigationFirstResponse.bind(this)));};u.prototype._initSection=function(ba){"use strict";var ca=t._initSection.call(this,ba);for(var da in this.typeSections){var ea=this.typeSections[da];if(ca.id==ea){var fa=j.scry(ca.node,'h4.navHeader')[0];if(fa){var ga='\/bookmarks\/('+da+')(\/)?';ca.seeall=this._initItem({node:fa,id:ca.id,endpoint:this.seeAllEndpoint,key:['bookmarks'],path:[{regex:ga}]});}}}return ca;};u.prototype._constructItem=function(ba,ca){"use strict";return new aa(ba,ca);};u.prototype._constructSection=function(ba){"use strict";return new x(ba);};u.prototype.getSection=function(ba){"use strict";return this.typeSections[ba]&&this.sections[this.typeSections[ba]];};u.prototype._getItemForKey=function(ba){"use strict";var ca=t._getItemForKey.call(this,"nf");if(ca&&ca.matchKey(ba)){return ca;}else return t._getItemForKey.call(this,ba);};u.prototype._isCurrentPath=function(ba){"use strict";return ((ba.getDomain()===this.uri.getDomain())&&(ba.getPath()==='/'||ba.getPath()==='/home.php'));};u.prototype._handleMenuClick=function(ba,ca,da,event){"use strict";if(i.hasClass(da,'favorite')){g.inform(n.NAVIGATION_FAVORITE_UPDATE,{key:ca.numericKey,favorite:!ba.equals(this.getSection('favorites'))});}else t._handleMenuClick.call(this,ba,ca,da,event);};u.prototype._handleLinkClick=function(ba,ca,event){"use strict";var da=this._getItemForNode(ca);if(da&&(da.type=='groups'||da.type=='pages'||da.type=='lists'||da.type=='interests'||da.type=='type_group'||da.type=='type_page'||da.type=='type_friend_list'||da.type=='type_interest_list'))da.setCount(0);t._handleLinkClick.call(this,ba,ca,event);};u.prototype.removeItemByKey=function(ba){"use strict";g.inform(n.NAVIGATION_ITEM_REMOVED,ba);t.removeItemByKey.call(this,ba);};u.prototype.toggleItemByKey=function(ba,ca){"use strict";var da=this.getNodeForKey(ba);if(!ca){g.inform(n.NAVIGATION_ITEM_HIDDEN,ba);da&&i.hide(da);}else da&&i.show(da);var ea=this._getItemForKey(ba);this.getSection(ea.type).refresh();};u.prototype.removeItem=function(ba){"use strict";var ca=this.getSection(ba.type);t.removeItem.call(this,ba);ca.refresh();};u.prototype.updateFavorite=function(ba,ca){"use strict";var da=this._findItem(function(ia){return ia.matchKey(ca.key)&&ia.canFavorite();}),ea=this.getSection("favorites"),fa=q,ga=ca.favorite?ea.addEndpoint:ea.removeEndpoint;if(!da&&ca.favorite){fa=function(){p.loadFromEndpoint('PinnedNavigationPagelet','pagelet_pinned_nav');};}else if(!da){fa=function(){p.loadFromEndpoint('BookmarkNavigationPagelet','pagelet_bookmark_nav');};}else{var ha=this.getSection(da.type);if(ca.favorite){i.show(da.node);this.moveItem(ea,da);da.showFavorite();}else if(!ha.equals(ea)){this.moveItem(ha,da,true);da.hideFavorite();}else this.removeItem(da);ha.refresh();ea.refresh();ca.key=da.numericKey;g.inform('NavigationMessage.FAVORITES_UPDATED');}new h().setURI(ga).setData({id:ca.key}).setHandler(fa).send();};u.prototype._doPageTransition=function(ba,ca){"use strict";this._unloadStreams();var da=t._doPageTransition.call(this,ba,ca);if(da&&(ba.type=='groups'||ba.type=='lists'||ba.type=='interests'||ba.type=='type_group'||ba.type=='type_page'||ba.type=='type_friend_list'||ba.type=='type_interest_list')){ba.setCount(0);ba.hideUnreadDot();}return da;};u.prototype._unloadStreams=function(){"use strict";var ba=window.UIIntentionalStream&&o.instances,ca=['nile','global','friends','blade'];ba&&ca.forEach(function(da){ba[da]&&ba[da].unload();});};u.prototype.navigationFirstResponse=function(){"use strict";this.setSelected(this.loading);};for(var v in m)if(m.hasOwnProperty(v))x[v]=m[v];var w=m===null?null:m.prototype;x.prototype=Object.create(w);x.prototype.constructor=x;x.__superConstructor__=m;function x(ba){"use strict";m.call(this,ba);this.editEndpoint='/ajax/bookmark/edit/';this.addEndpoint='/ajax/bookmark/add/';this.removeEndpoint='/ajax/bookmark/delete/';}x.prototype.refresh=function(){"use strict";var ba=j.scry(this.node,'li.sideNavItem'),ca=j.scry(this.node,'div.actionLinks'),da=ba.some(i.shown);i.conditionShow(j.find(this.node,'h4.navHeader'),da);ca.length&&i.conditionShow(ca[0],da);};for(var y in l)if(l.hasOwnProperty(y))aa[y]=l[y];var z=l===null?null:l.prototype;aa.prototype=Object.create(z);aa.prototype.constructor=aa;aa.__superConstructor__=l;function aa(){"use strict";if(l!==null)l.apply(this,arguments);}aa.prototype.canFavorite=function(){"use strict";return !!this._getFavoriteLabel();};aa.prototype.showFavorite=function(){"use strict";j.setContent(this._getFavoriteLabel(),"Remove from Favorites");};aa.prototype.hideFavorite=function(){"use strict";j.setContent(this._getFavoriteLabel(),"Add to Favorites");};aa.prototype.hideUnreadDot=function(){"use strict";var ba=j.scry(this.node,'img.unreadDot')[0];ba&&i.hide(ba);};aa.prototype._getFavoriteLabel=function(){"use strict";return j.scry(this.node,'li.favorite span.itemLabel')[0];};e.exports=u;});
__d("legacy:home-side-nav-future-js",["FutureHomeSideNav"],function(a,b,c,d){a.FutureHomeSideNav=b('FutureHomeSideNav');},3);
__d("KeyboardShortcuts",["KeyEventController","Layer","ModalLayer"],function(a,b,c,d,e,f){var g=b('KeyEventController'),h=b('Layer'),i=b('ModalLayer');function j(l,m,n){"use strict";this.key=l;this.handler=m;this.filter=n;this.register();}j.prototype.register=function(){"use strict";this.token=g.registerKey(this.key,this.handler,this.filter);};j.prototype.remove=function(){"use strict";this.token.remove();};var k={_tokens:[[]],register:function(l,m,n){n=n||{};var o=n.allowDefault?m:function(event,s){m.apply(this,arguments);event.prevent();},p=n.baseFilters||[g.defaultFilter],q=function(event,s){for(var t=0,u=p.length;t<u;t++)if(!p[t](event,s))return false;return !n.filter||n.filter(event,s);},r=new j(l,o,q);this._tokens[this._tokens.length-1].push(r);return r;},init:function(){h.subscribe('show',function(l,m){if(m.hasBehavior(i))this.pushLayer();}.bind(this));h.subscribe('hide',function(l,m){if(m.hasBehavior(i))this.popLayer();}.bind(this));},pushLayer:function(){var l=this._tokens[this._tokens.length-1];l&&l.forEach(function(m){m.remove();});this._tokens.push([]);},popLayer:function(){var l=this._tokens.length-1;if(l<0)return;var m=this._tokens[l];m.forEach(function(o){o.remove();});this._tokens.pop();var n=this._tokens[l-1];n&&n.forEach(function(o){o.register();});}};k.init();e.exports=k;});
__d("FeedBaseKeyboardController",["$","Arbiter","AsyncDialog","AsyncRequest","Banzai","BanzaiODS","CSS","DOM","DOMScroll","DOMQuery","Event","Focus","KeyboardShortcuts","KeyEventController","LikeConfirmer","NavigationMessage","Parent","Run","SubscriptionsHandler","Vector","ViewportBounds","emptyFunction","ge","getActiveElement","isAsyncScrollQuery","throttle"],function(a,b,c,d,e,f){var g=b('$'),h=b('Arbiter'),i=b('AsyncDialog'),j=b('AsyncRequest'),k=b('Banzai'),l=b('BanzaiODS'),m=b('CSS'),n=b('DOM'),o=b('DOMScroll'),p=b('DOMQuery'),q=b('Event'),r=b('Focus'),s=b('KeyboardShortcuts'),t=b('KeyEventController'),u=b('LikeConfirmer'),v=b('NavigationMessage'),w=b('Parent'),x=b('Run'),y=b('SubscriptionsHandler'),z=b('Vector'),aa=b('ViewportBounds'),ba=b('emptyFunction'),ca=b('ge'),da=b('getActiveElement'),ea=b('isAsyncScrollQuery'),fa=b('throttle'),ga;function ha(){ga=m.hasClass(document.documentElement,'tinyViewport')?0:g('pagelet_bluebar').offsetTop+g('pagelet_bluebar').offsetHeight;}setTimeout(ha,0);q.listen(window,'resize',fa(ha));function ia(ja){"use strict";this.root=ja;this.init();}ia.prototype.getStories=function(){"use strict";};ia.prototype.getParentStory=function(ja){"use strict";};ia.prototype.isStory=function(ja){"use strict";};ia.prototype.isHoldoutStory=function(ja){"use strict";};ia.prototype.getHeadline=function(ja){"use strict";};ia.prototype.getPreviousStory=function(ja){"use strict";};ia.prototype.getNextStory=function(ja){"use strict";};ia.prototype.setSelected=function(ja,ka){"use strict";};ia.prototype.clickLike=function(){"use strict";};ia.prototype.clickComment=function(){"use strict";};ia.prototype.clickShare=function(){"use strict";};ia.prototype.openAttachment=function(){"use strict";};ia.prototype.focusComposer=function(){"use strict";var ja=n.scry(ca('pagelet_composer'),'textarea')[0];if(ja){r.set(ja);o.scrollToTop(true);}};ia.prototype.getScrollOffset=function(){"use strict";return 10;};ia.prototype.getAnimationLength=function(ja){"use strict";return Math.min(Math.abs(z.getElementPosition(ja).y-aa.getTop()-document.body.scrollTop),400);};ia.prototype.findTop=function(){"use strict";var ja=this.getStories();for(var ka=0;ka<ja.length;ka++)if(z.getElementPosition(ja[ka]).y>z.getScrollPosition().y)return ja[ka];};ia.prototype.onLeave=function(){"use strict";this.subscriptions&&this.subscriptions.release();};ia.prototype.getHelpDialogRequest=function(){"use strict";if(!this.dialogRequest){this.dialogRequest=new j('/ajax/keyboard_shortcuts');this.dialogRequest.setReadOnly(true);}else if(this.dialogRequest.transport)return null;return this.dialogRequest;};ia.prototype.init=function(){"use strict";x.onLeave(this.onLeave.bind(this));this.subscriptions=new y();this.subscriptions.addSubscriptions(h.subscribe(v.NAVIGATION_BEGIN,this.onLeave.bind(this)),s.register('j',this.vert.bind(this,1)),s.register('k',this.vert.bind(this,-1)),s.register('l',function(){var ja=this.getParentStory(da());u.like(function(){this.setSelected(ja,false);this.clickLike();}.bind(this),da());}.bind(this),{filter:this.hasActiveStory.bind(this)}),s.register('c',this.clickComment.bind(this),{filter:this.hasActiveStory.bind(this)}),s.register('o',this.openAttachment.bind(this),{filter:this.hasActiveStory.bind(this)}),s.register('p',this.focusComposer.bind(this)),s.register('s',this.clickShare.bind(this),{filter:this.hasActiveStory.bind(this)}),s.register('SLASH',function(){var ja=this.getHelpDialogRequest();ja&&i.send(ja);}.bind(this),{filter:function(event,ja){return event.getModifiers().shift;}}),s.register('ESCAPE',function(){var ja=this.findTop();ja&&this.setFocused(ja);}.bind(this),{baseFilters:[t.filterEventTypes,t.filterEventModifiers]}),q.listen(document,'focusin',function(event){var ja=event.getTarget(),ka=(ja.nodeName=='OBJECT'||ja.nodeName=='EMBED'),la=this.getParentStory(ja);if(la&&(this.selected!=la)&&!ka){this.setSelected(la,false);if(!this.isInteractive(ja))this.setFocused(la);}}.bind(this)));};ia.prototype.hasActiveStory=function(event,ja){"use strict";var ka=da();return !(ka&&m.shown(ka))||!!this.getParentStory(ka);};ia.prototype.click=function(ja){"use strict";if(!this.selected)return;var ka;for(var la=0,ma=arguments.length;la<ma;la++){ka=n.scry(this.selected,arguments[la])[0];if(ka&&m.shown(ka)){ka.click();return;}}};ia.prototype.vert=function(ja){"use strict";if(!this.scrollInitialized){this.subscriptions.addSubscriptions(q.listen(document,'scroll',function(){if(this.selected&&!this.scrolling)this.setSelected(null,false);}.bind(this)));this.scrollInitialized=true;}var ka,la;if(this.selected){if(k.isEnabled('kbshortcuts_feed')){la=ja>0?'kbshortcuts.scroll_down':'kbshortcuts.scroll_up';l.bumpEntityKey('kbshortcuts_feed',la);}if(this.selected.id=='pagelet_composer'){ka=ja>0?this.getStories()[0]:null;if(this.isHoldoutStory(ka))ka=this.getPreviousStory(ka);}else ka=ja>0?this.getNextStory(this.selected):(this.getPreviousStory(this.selected)||ca('pagelet_composer'));if(!ka){return;}else if(!p.isElementNode(ka)){m.removeClass(this.selected,'selectedStorySimple');this.selected=ka;return this.vert(ja);}}if(!ka||w.byClass(ka,'hidden_elem')||!n.contains(document,ka)){ka=this.findTop();if(ka&&ja<0)ka=this.getPreviousStory(ka);if(this.isHoldoutStory(ka))ka=this.getPreviousStory(ka);}if(!ka)return;this.anim&&this.anim.stop();var ma=(Date.now()-(this.lastScroll||0)>30),na=this.setFocused.bind(this,ka);if(ea()){ma=false;na();na=ba;}this.scrolling=true;this.scrollingTimer&&window.clearTimeout(this.scrollingTimer);this.anim=o.scrollTo(ka,ma?this.getAnimationLength(ka):0,false,z.getViewportDimensions().y-ga-this.getScrollOffset(),0,function(){this.scrollingTimer=window.setTimeout(function(){this.scrolling=false;}.bind(this),300);na();}.bind(this));this.setSelected(ka,true);this.lastScroll=Date.now();};ia.prototype.isInteractive=function(ja){"use strict";return ((ja.nodeName=='INPUT')||(ja.nodeName=='BUTTON')||(ja.nodeName=='TEXTAREA')||(ja.nodeName=='A')||!!w.byAttribute(ja,'contenteditable'));};ia.prototype.setTabindexOnHeadline=function(ja,ka){"use strict";if(this.isStory(ja)){var la=this.getHeadline(ja);if(la)la.tabIndex=ka;}};ia.prototype.setTabindexOnStory=function(ja,ka){"use strict";if(this.isStory(ja))ja.tabIndex=ka;};ia.prototype.setFocused=function(ja){"use strict";if(this.isStory(ja))r.setWithoutOutline(ja);};e.exports=ia;});
__d("PageAdsAttachmentLinkShareConstants",[],function(a,b,c,d,e,f){var g={LINK_ATTACHMENT_CLICK:'link_attachment_click'};e.exports=g;});
__d("FeedTrackingAsync",["Arbiter","collectDataAttributes","copyProperties"],function(a,b,c,d,e,f){var g=b('Arbiter'),h=b('collectDataAttributes'),i=b('copyProperties');function j(){g.subscribe('AsyncRequest/send',function(k,l){var m=l.request,n=m.getRelativeTo();if(n){var o=m.getData(),p=h(n,['ft']);i(o,p);}});}e.exports={init:j};});
__d("LitestandViewportHeight",["Arbiter","CSS","Event","cx","debounce","emptyFunction"],function(a,b,c,d,e,f){var g=b('Arbiter'),h=b('CSS'),i=b('Event'),j=b('cx'),k=b('debounce'),l=b('emptyFunction'),m,n={SMALL:'small',NORMAL:'normal',LARGE:'large',getSize:function(){if(m==="_4vcw")return n.SMALL;if(m==="_4vcx")return n.LARGE;return n.NORMAL;},init:function(o){n.init=l;var p=k(function(){var q=document.documentElement,r=q.clientHeight,s;if(r<=o.max_small_height){s="_4vcw";}else if(r>=o.min_large_height)s="_4vcx";if(s!==m){m&&h.removeClass(q,m);m=s;m&&h.addClass(q,m);g.inform('ViewportSizeChange');}});p();i.listen(window,'resize',p);}};e.exports=n;});
__d("LitestandOffscreenController",["Arbiter","CSS","DOM","Event","LitestandMessages","LitestandViewportHeight","Parent","Run","Style","SubscriptionsHandler","Vector","cx","queryThenMutateDOM","runAfterScrollingStops","throttle"],function(a,b,c,d,e,f){var g=b('Arbiter'),h=b('CSS'),i=b('DOM'),j=b('Event'),k=b('LitestandMessages'),l=b('LitestandViewportHeight'),m=b('Parent'),n=b('Run'),o=b('Style'),p=b('SubscriptionsHandler'),q=b('Vector'),r=b('cx'),s=b('queryThenMutateDOM'),t=b('runAfterScrollingStops'),u=b('throttle'),v=1,w=9,x=7,y={},z=false,aa,ba,ca,da,ea=[];function fa(){aa&&aa.release();aa=null;z=false;}function ga(){y={};ea=[];}function ha(){for(var ta in y){var ua=y[ta];if(ua.hidden)ua.dirty=true;}}function ia(){if(l.getSize()===l.SMALL)return x;return w;}function ja(){da=da||q.getViewportDimensions().y;ba=q.getScrollPosition().y;ca=ba+da;if(v){ba-=da*v;ca+=da*v;}for(var ta in y){var ua=y[ta];ua.position=q.getElementPosition(ua.element).y;if(!ua.hidden)ua.height=ua.element.offsetHeight;}}function ka(){var ta=[];for(var ua in y){var va=y[ua],wa=va.position,xa=wa+va.height<ba,ya=wa>ca;if(!va.hidden&&(xa||ya)){la(va);}else if(!xa&&!ya){va.pendingHide=false;if(va.hidden){if(va.dirty&&wa<ba){ta.push(ua);h.addClass(ma(va),"_49nu");}else o.apply(va.element,{height:'',marginBottom:''});h.show(ma(va));va.dirty=false;va.hidden=false;}}}if(!ta.length)return;var za=0;s(function(){for(var ab=0,bb=ta.length;ab<bb;ab++){var cb=y[ta[ab]];za+=cb.height-ma(cb).offsetHeight+o.getFloat(cb.element,'marginBottom');}},function(){for(var ab=0,bb=ta.length;ab<bb;ab++){var cb=y[ta[ab]];h.removeClass(ma(cb),"_49nu");o.apply(cb.element,{height:'',marginBottom:''});}za&&(document.body.scrollTop-=za);});}function la(ta){if(!ta.pendingHide){ea.push(ta);ta.pendingHide=true;}}function ma(ta){if(ta.wrapperElement)return ta.wrapperElement;var ua=ta.element;if(ua.firstElementChild)return (ta.wrapperElement=ua.firstElementChild);for(var va=0;va<ua.childNodes.length;va++)if(ua.childNodes[va].tagName)return (ta.wrapperElement=ua.childNodes[va]);}function na(){var ta=ia()+'px';for(var ua=0;ua<ea.length;ua++){var va=ea[ua];if(va.pendingHide&&!va.hidden){o.apply(va.element,{height:va.height+'px',marginBottom:ta});h.hide(ma(va));va.hidden=true;va.pendingHide=false;}}ea=[];}function oa(){t(na,'LitestandOffscreenController/hide');s(ja,ka,'LitestandOffscreenController');}function pa(){for(var ta in y){var ua=y[ta];if(!ma(ua).childNodes.length){i.remove(ua.element);delete y[ta];}}}function qa(ta,ua){var va=m.byClass(ua.story,"_4ikz");if(!va)return;va=y[i.getID(va)];if(va&&va.hidden)va.dirty=true;}function ra(){n.onLeave(fa);aa=new p();aa.addSubscriptions(g.subscribe(k.FILTER_SWITCH_BEGIN,ga),g.subscribe(k.STORIES_REMOVED,pa),g.subscribe('Entstream/StoryUpdated',qa),g.subscribe('ViewportSizeChange',ha),j.listen(window,'scroll',u(oa)),j.listen(window,'resize',u(function(){da=null;oa();})));z=true;}var sa={attachSubstream:function(ta){z||ra();y[i.getID(ta)]={element:ta};}};e.exports=sa;});
__d("LitestandComposerBase",["Animation","Arbiter","ComposerXController","DOM","LitestandMessages","Run","SubscriptionsHandler","copyProperties"],function(a,b,c,d,e,f){var g=b('Animation'),h=b('Arbiter'),i=b('ComposerXController'),j=b('DOM'),k=b('LitestandMessages'),l=b('Run'),m=b('SubscriptionsHandler'),n=b('copyProperties'),o=600;function p(q){this._composerID=q;this._subscriptions=new m();this.init();}n(p.prototype,{init:function(){this._subscriptions.addSubscriptions(h.subscribe('LitestandComposer/publish',function(q,r){if(r.composer_id===this._composerID)this.liveInsertComposerStory(this._composerID,r.markup);}.bind(this)),h.subscribe(k.FILTER_SWITCH_BEGIN,this._cleanup.bind(this)));l.onLeave(this._cleanup.bind(this));},_cleanup:function(){this._subscriptions&&this._subscriptions.release();this._subscriptions=null;},liveInsertComposerStory:function(q,r){q&&i.reset(q);if(!r)return;j.prependContent(this.getStreamRoot(),r);new g(r).from('opacity',0).to('opacity',1).duration(o).go();},getStreamRoot:function(){}});e.exports=p;});
__d("LitestandComposer",["Arbiter","LitestandComposerBase","LitestandStream"],function(a,b,c,d,e,f){var g=b('Arbiter'),h=b('LitestandComposerBase'),i=b('LitestandStream');for(var j in h)if(h.hasOwnProperty(j))l[j]=h[j];var k=h===null?null:h.prototype;l.prototype=Object.create(k);l.prototype.constructor=l;l.__superConstructor__=h;function l(){"use strict";if(h!==null)h.apply(this,arguments);}l.prototype.init=function(){"use strict";k.init.call(this);this._subscriptions.addSubscriptions(g.subscribe('LitestandComposer/globalPublish',function(m,n){if(n.top_news_id===i.getSectionID())this.liveInsertComposerStory(null,n.markup);}.bind(this)));};l.prototype.getStreamRoot=function(){"use strict";return i.getStreamRoot();};l.initComposer=function(m){"use strict";new l(m);};e.exports=l;});
__d("LitestandStreamLoader",["Arbiter","AsyncRequest","CSS","DOM","Event","JSXDOM","LitestandMessages","LitestandOffscreenController","LitestandStream","NavigationMessage","OnVisible","Run","throttle","UIPagelet","UserActivity","$","copyProperties","ge","getUnboundedScrollPosition"],function(a,b,c,d,e,f){var g=b('Arbiter'),h=b('AsyncRequest'),i=b('CSS'),j=b('DOM'),k=b('Event'),l=b('JSXDOM'),m=b('LitestandMessages'),n=b('LitestandOffscreenController'),o=b('LitestandStream'),p=b('NavigationMessage'),q=b('OnVisible'),r=b('Run'),s=b('throttle'),t=b('UIPagelet'),u=b('UserActivity'),v=b('$'),w=b('copyProperties'),x=b('ge'),y=b('getUnboundedScrollPosition'),z=false,aa=false,ba={},ca,da,ea,fa,ga,ha,ia=0,ja,ka,la=[],ma=0,na,oa;function pa(){r.onLeave(qa);la=[g.subscribe(p.NAVIGATION_BEGIN,qa),g.subscribe(m.FILTER_SWITCH_BEGIN,qa),g.subscribe(m.NEWER_STORIES_INSERTED,function(){oa=null;}),g.subscribe(m.TOUR_BEGIN,function(){z=true;}),g.subscribe(m.TOUR_END,function(){z=false;ta();}),g.subscribe(m.STORIES_REMOVED,ra),g.subscribe(m.UPDATE_STREAM,ya),g.subscribe(m.REFRESH_STREAM,ya)];aa=true;}function qa(){g.inform(m.LEAVE_HOME);ba={};ka=null;ia=0;la.forEach(g.unsubscribe);la=[];ca&&ca.remove();ga&&clearTimeout(ga);ga=null;fa=null;oa=null;ja&&ja.remove();ja=null;aa=false;ma=0;}function ra(){ba={};}function sa(){if(o.hasAutoUpdateTest())return;if(ga)return;ga=setTimeout(function(){ga=null;za();},ka.pollIntervalMS);}function ta(){if(ka&&fa&&ka.pollIntervalMS&&ka.pollIntervalMS>1000)sa();}function ua(){ca=new q(j.find(da,'a'),eb.bind(null,ea),false,ka.bufferPixels);}function va(){var gb=y(window).y;return gb>ka.firstPagerScrollBuffer;}function wa(){if(va()){ua();ja&&ja.remove();ja=null;}}function xa(gb){var hb=j.find(da,'a');k.listen(hb,'click',function(event){eb(ea);ja&&ja.remove();ja=null;event.preventDefault();});var ib=o.getVisibleStoryCount(ha),jb=ka.maxStories;if(jb&&ib>=jb)return;if(gb&&!va()){ja=k.listen(window,'scroll',s(wa));}else ua();}function ya(){za();g.inform(m.UPDATE_LAST_REFRESH_TIME);}function za(){if(z||!fa)return;if(!o.hasAutoUpdateTest()&&!u.isActive(ka.newStoryIdleTime)){u.subscribeOnce(za);return;}if(o.hasOtherFeedsSwitcherExpansion())new h().setURI('/ajax/litestand/other_feed_counts').setData({section_id:o.getSectionID()}).send();if(o.disableNewStoryBar()&&!o.canInsertNewerStories()&&!o.hasAutoUpdateTest()){sa();return;}if(!oa){var gb=l.div({style:{left:'-10000px',opacity:0,position:'absolute'}});oa=j.getID(gb);j.prependContent(o.getStreamRoot(),gb);}var hb=l.div(null);j.prependContent(v(oa),hb);t.loadFromEndpoint('LitestandNewerStoriesPagelet',hb,w(fa,{cursor:na,containerID:oa}));}function ab(gb){var hb=j.getID(da);i.addClass(da,'async_saving');var ib=cb();if(ba[ib])throw new Error('This cursor has been used before, stories will be '+'repeated. Cursor: '+ib);ba[ib]=ib;var jb={cursor:ib,pager_config:gb,pager_id:hb,scroll_count:++ia};if(o.getHomeloadID())jb.homeload_id=o.getHomeloadID();t.loadFromEndpoint(ka.pagerController,j.getID(ha),jb,{append:true,automatic:true,usePipe:true});}function bb(){return db()[0].getAttribute('data-cursor');}function cb(){var gb=db();return gb[gb.length-1].getAttribute('data-cursor');}function db(){var gb=j.scry(ha,o.getStoriesSelector());return gb.filter(function(hb){return hb.getAttribute('data-cursor');});}function eb(gb){ab(gb);ca&&ca.remove();ca=null;}var fb={register:function(gb,hb,ib,jb){aa||pa();ka=o.getStreamConfig(hb);ea=ib;ha=v(gb);na=bb();da=jb;xa(true);ta();},removeOldPager:function(gb,hb){j.remove(v(gb));i.show(v(hb));},removeLoadingIndicator:function(gb,hb){var ib=x(gb);if(ib)j.remove(ib);i.show(hb);},moreStoriesInserted:function(gb){g.inform(m.STORIES_INSERTED,{substream_id:gb});if(o.hideOffscreenSubstreams())n.attachSubstream(v(gb));},attachNewPager:function(gb){da=gb;da&&xa(false);},setPollerData:function(gb){if(gb){fa=gb;ta();}},updatePollerCursor:function(gb){na=gb;ta();},headLoadCompleted:function(gb){na=gb.newCursor;ta();var hb=gb.stories;if(hb&&hb.length>0){for(var ib=hb.length-1;ib>=0;ib--)hb[ib].setAttribute('data-insertion-position',--ma);g.inform('Stream/totalHeadLoadedStories',-ma);}}};e.exports=fb;});
__d("MercuryLeftNavCountControl",["Arbiter","CSS","DOM","MercuryThreadlistConstants","MessagingTag","MercuryThreadInformer","MercuryUnreadState","copyProperties"],function(a,b,c,d,e,f){var g=b('Arbiter'),h=b('CSS'),i=b('DOM'),j=b('MercuryThreadlistConstants'),k=b('MessagingTag'),l=b('MercuryThreadInformer').get(),m=b('MercuryUnreadState').get(),n=b('copyProperties'),o,p,q=function(r,s){o=r;p=s;this.render();this.listenerToken=l.subscribe('unread-updated',this.render.bind(this));this.subscriptions=[g.subscribe('onload/exit',this.cleanup.bind(this))];};n(q.prototype,{render:function(){var r=m.exceedsMaxCount(k.INBOX);if(r){i.setContent(o,j.MAX_UNREAD_COUNT);}else{var s=m.getUnreadCount(k.INBOX);i.setContent(o,s.toString());h.conditionClass(o.parentNode,'hidden_elem',s<=0);}i.setContent(p,r?'+':'');},cleanup:function(){this.subscriptions.forEach(g.unsubscribe);l.unsubscribe(this.listenerToken);}});e.exports=q;});
__d("MercuryLeftNav",["DOM","MercuryServerRequests","MercuryLeftNavCountControl"],function(a,b,c,d,e,f){var g=b('DOM'),h=b('MercuryServerRequests').get(),i=b('MercuryLeftNavCountControl');function j(k,l){h.handleUpdate(l);var m=g.scry(k,'span.countValue')[0],n=g.scry(k,'span.maxCountIndicator')[0];new i(m,n);}e.exports=j;});
__d("ViewportTracking",["Arbiter","Banzai","DOM","DOMDimensions","Event","NavigationMessage","Run","Style","SubscriptionsHandler","UIIntentionalStreamMessage","UserActivity","Vector","clickRefAction","collectDataAttributes","copyProperties","debounce","getElementPosition","throttle"],function(a,b,c,d,e,f){var g=b('Arbiter'),h=b('Banzai'),i=b('DOM'),j=b('DOMDimensions'),k=b('Event'),l=b('NavigationMessage'),m=b('Run'),n=b('Style'),o=b('SubscriptionsHandler'),p=b('UIIntentionalStreamMessage'),q=b('UserActivity'),r=b('Vector'),s=b('clickRefAction'),t=b('collectDataAttributes'),u=b('copyProperties'),v=b('debounce'),w=b('getElementPosition'),x=b('throttle'),y=97,z='vpv';function aa(){"use strict";}aa.prototype.init=function(ba){"use strict";this.useBanzai=!!ba.banzai;this.readStoryIDs={};this.minSizeToBeVisible=200;this.minFractionToBeVisibleForTimetracking=.5;this.minFractionForAdditionalView=0;this.timetrackingThrottlingInterval=100;this.minTimeToReportImmediately=500;this.cachedAllStories=null;this.cachedViewportHeight=j.getViewportDimensions().height;this.isTimetrackingEnabled=0;this.storyEnteredVPTimestamp={};this.alreadyLoggedDurationStories=[];this.userInactiveLock=false;this.userActivityPollerTimeoutID=-1;this._headLoadStoryCount=0;this.getDataFromConfig(ba);this.isLoose=!!ba.is_loose;this.maxScrollPosition=0;this.porportionRatio=.5;this.is_proportion=!!ba.is_proportion;if(this.is_proportion)this.proportionRatio=ba.proportion_ratio;if(ba.tracking_duration_config){this.timetrackingThrottlingInterval=ba.tracking_duration_config.timetracking_throttling_interval;this.userActivityPollingInterval=ba.tracking_duration_config.user_activity_polling_interval;this.timeToBeConsideredInactive=ba.tracking_duration_config.time_to_be_considered_inactive;this.minFractionToBeVisibleForTimetracking=ba.tracking_duration_config.min_fraction_to_be_visible;this.minTimeToReportImmediately=ba.tracking_duration_config.min_time_to_report_immediately;this.minFractionForAdditionalView=ba.tracking_duration_config.min_fraction_for_additional_view;}var ca,da=v(this.fireTimer,this.getTimeout(),this);if(this.isLoose){this.minSizeToBeVisible=0;ca=x(function(){this.maxScrollPosition=Math.max(this.maxScrollPosition,r.getScrollPosition().y);da();}.bind(this));}else ca=da;if(!ba.scroll_only)this.fireTimer();var ea=x(this.updateTimeTrackingData.bind(this,false),this.timetrackingThrottlingInterval);this.subscriptions=new o();this.subscriptions.addSubscriptions(this._getScrollListener(ca),k.listen(window,'resize',function(){this.cachedViewportHeight=j.getViewportDimensions().height;ca();}.bind(this)),g.subscribe(p.UPDATE_HTML_CONTENT,function(){if(q.isActive())ca();}.bind(this)),g.subscribe(l.NAVIGATION_BEGIN,this.cleanup.bind(this)),g.subscribe('Stream/totalHeadLoadedStories',function(fa,ga){this._headLoadStoryCount=ga;}.bind(this)));if(this.isTimetrackingEnabled){this.updateTimeTrackingData(false);this.subscriptions.addSubscriptions(this._getScrollListener(ea));this._userActivityPoller();}m.onLeave(this.cleanup.bind(this));};aa.prototype._getScrollListener=function(ba){"use strict";return k.listen(window,'scroll',ba);};aa.prototype.cleanup=function(){"use strict";if(this.subscriptions){this.subscriptions.release();this.subscriptions=null;}if(this.isTimetrackingEnabled){clearTimeout(this.userActivityPollerTimeoutID);this.updateTimeTrackingData(true);}this._headLoadStoryCount=0;};aa.prototype.fireTimer=function(){"use strict";this.getStoriesInView().forEach(this.markStoryRead.bind(this));};aa.prototype._userActivityPoller=function(){"use strict";if(!this.userInactiveLock&&!q.isActive(this.timeToBeConsideredInactive)){this.userInactiveLock=true;this.updateTimeTrackingData(true);q.subscribeOnce(function(){this.updateTimeTrackingData(false);this.userInactiveLock=false;}.bind(this));}this.userActivityPollerTimeoutID=setTimeout(this._userActivityPoller.bind(this),this.userActivityPollingInterval);};aa.prototype.addVisibleStoriesTimestamps=function(ba,ca){"use strict";var da={};for(var ea=0,fa=ba.length;ea<fa;ea++){var ga=this.getStoryID(ba[ea]);da[ga]=true;if(ga in this.storyEnteredVPTimestamp)continue;this.storyEnteredVPTimestamp[ga]={ts:ca,story:ba[ea]};}return da;};aa.prototype.removeTimestampsOfStoriesNotInView=function(ba,ca){"use strict";for(var da in this.storyEnteredVPTimestamp)if(!(da in ba)){this.recordTimeStoryWasInView(this.storyEnteredVPTimestamp[da].story,this.storyEnteredVPTimestamp[da].ts,ca);delete this.storyEnteredVPTimestamp[da];}};aa.prototype.updateTimeTrackingData=function(ba){"use strict";if(!this.storyEnteredVPTimestamp)this.storyEnteredVPTimestamp={};var ca=Date.now(),da={},ea;if(!ba)da=this.getAllStoriesInView();ea=this.addVisibleStoriesTimestamps(da,ca);this.removeTimestampsOfStoriesNotInView(ea,ca);};aa.prototype.getStoriesInView=function(){"use strict";var ba=this.getAllStories(),ca=[],da=false;for(var ea=0;ea<ba.length;ea++){var fa=ba[ea],ga=this.getStoryID(fa);if(this.hasBeenVisible(ga))continue;if(this.isVisible(fa)){if(fa.getAttribute('data-insertion-position')===null)fa.setAttribute('data-insertion-position',ea-this._headLoadStoryCount);ca.push(fa);da=true;}else if(da)break;}return ca;};aa.prototype.getAllStoriesFromCache=function(){"use strict";if(this.cachedAllStories===null)this.cachedAllStories=this.getAllStories();return this.cachedAllStories;};aa.prototype.invalidateAllStoriesCache=function(){"use strict";this.cachedAllStories=null;};aa.prototype.getAllStoriesInView=function(){"use strict";var ba=this.getAllStoriesFromCache(),ca=[],da=false,ea=0,fa=ba.length,ga=1;if(this._indexOfLastVisibleStoryOnPreviousPass>fa/2){ea=fa-1;fa=-1;ga=-ga;}for(var ha=ea;ha!=fa;ha+=ga){var ia=ba[ha];if(this._isVisible(ia,false,this.minFractionToBeVisibleForTimetracking*j.getElementDimensions(ia).height)){if(ia.getAttribute('data-insertion-position')===null)ia.setAttribute('data-insertion-position',ha-this._headLoadStoryCount);ca.push(ia);da=true;}else if(da){this._indexOfLastVisibleStoryOnPreviousPass=ha-ga;break;}}for(ha=this.alreadyLoggedDurationStories.length-1;ha>=0;ha--){ia=this.alreadyLoggedDurationStories[ha];if(!this._isVisible(ia,false,this.minFractionForAdditionalView*j.getElementDimensions(ia).height))this.alreadyLoggedDurationStories.splice(ha,1);}return ca;};aa.prototype.getTimetrackingDataToLog=function(ba,ca,da){"use strict";var ea={evt:y,vpvd_start_timestamp:ca,vpvd_time_delta:da-ca,story_height:j.getElementDimensions(ba).height,viewport_height:this.cachedViewportHeight};return {ft:ea};};aa.prototype.recordTimeStoryWasInView=function(ba,ca,da){"use strict";if(this.isTimetrackingEnabled){if(this.alreadyLoggedDurationStories.indexOf(ba)>-1){return;}else this.alreadyLoggedDurationStories.push(ba);var ea=this.getTimetrackingDataToLog(ba,ca,da),fa=t(ba,['ft']);u(ea.ft,fa.ft);var ga=!!fa.ft.ei&&(ea.ft.vpvd_time_delta>this.minTimeToReportImmediately);delete ea.ei;this.sendDataToLog(ba,ea,ga);}};aa.prototype.hasBeenVisible=function(ba){"use strict";return ba in this.readStoryIDs;};aa.prototype.isVisible=function(ba){"use strict";return this._isVisible(ba,this.isLoose,this.minSizeToBeVisible);};aa.prototype._isVisible=function(ba,ca,da){"use strict";var ea=r.getScrollPosition().y,fa=j.getViewportDimensions().height,ga=w(ba),ha=j.getElementDimensions(ba),ia=fa+this.maxScrollPosition-ea;if(!ga.x&&!ga.y&&!ha.x&&!ha.y)return false;if(ca&&ga.y<ia)return true;var ja=Math.max(ga.y,0),ka=Math.min(ga.y+ha.height,fa),la;if(this.is_proportion){la=ha.height*this.proportionRatio;}else la=Math.min(ha.height,da);return (ka-ja)>=la;};aa.prototype.sendDataToLog=function(ba,ca,da){"use strict";if(this.useBanzai){var ea={};if(da)ea.delay=0;h.post('feed_tracking',ca,ea);}else s(z,ba,null,'FORCE',ca);};aa.prototype.markStoryRead=function(ba){"use strict";var ca=this.getStoryID(ba);if(!ca||this.hasBeenVisible(ca))return;this.readStoryIDs[ca]=true;var da=this.getDataToLog(ba),ea=i.scry(ba,".fbStoryAttachmentImage")[0];if(ea){var fa=j.getElementDimensions(ea).width,ga=j.getElementDimensions(ea).height;da.ft.story_image_height=ga;da.ft.story_image_width=fa;}var ha=t(ba,['ft']);u(da.ft,ha.ft);delete da.ei;this.sendDataToLog(ba,da,false);};e.exports=aa;});
__d("collectSubtreeData",[],function(a,b,c,d,e,f){function g(i,j,k,l,m){if(i.offsetWidth===0&&i.offsetHeight===0)return m;var n={};if(i.getAttribute)for(r=0;r<j.length;r++){t=j[r];var o=i.getAttribute(k[t]);if(o){n[t]={};var p=JSON.parse(o);for(var q in l)if(p[q]!==undefined){n[t][q]=true;if(m[t]===undefined)m[t]={};if(m[t][q]===undefined)m[t][q]=[];if(l[q].length>0)m[t][q].push(l[q]);m[t][q].push('('+p[q]);}}}for(var r=0;r<i.childNodes.length;r++){var s=i.childNodes[r];g(s,j,k,l,m);}for(var t in n)for(var u in n[t]){var v=m[t][u][m[t][u].length-1];if(v.length>0&&v.charAt(0)=='('){m[t][u][m[t][u].length-1]=v.substr(1);}else m[t][u].push(')');}return m;}function h(i,j){var k={};for(var l=0;l<j.length;++l)k[j[l]]='data-'+j[l];var m={tn:"","tn-debug":","},n={};g(i,j,k,m,n);for(var o in n)for(var p in n[o])n[o][p]=n[o][p].join('');return n;}e.exports=h;});
__d("recordTNTreeData",["collectSubtreeData"],function(a,b,c,d,e,f){var g=b('collectSubtreeData');function h(i,j){var k={},l=g(i,['ft']);for(var m in l.ft){k[m+'_tree']=l.ft[m];if(m==='tn-debug')i.setAttribute('tn-debug_subtree',l.ft[m]);}k.evt_value=i.offsetHeight;if(j)k.offset=Math.max(0,i.offsetTop-j.offsetTop);return k;}e.exports=h;});
__d("StoryTopicMap",[],function(a,b,c,d,e,f){var g={},h={registerTopics:function(i,j){g[i]=j;},getTopicsForFTID:function(i){return g[i]||[];}};e.exports=h;});
__d("XFeedAdsChainingControllerURIBuilder",["XControllerURIBuilder"],function(a,b,c,d,e,f){var g=b('XControllerURIBuilder');e.exports=g.create("\/feed\/ads_chaining\/",{actor_id:{type:"Int",required:true},ft_id:{type:"String"},origin:{type:"String",required:true},ei:{type:"String",required:true},data_ownerid:{type:"String",required:true}});});
__d("XPubcontentFeedChainingControllerURIBuilder",["XControllerURIBuilder"],function(a,b,c,d,e,f){var g=b('XControllerURIBuilder');e.exports=g.create("\/pubcontent\/feed_chaining\/",{actor_id:{type:"Int",required:true},ft_id:{type:"String"},origin:{type:"String",required:true}});});
__d("XPubcontentRelatedShareChainingControllerURIBuilder",["XControllerURIBuilder"],function(a,b,c,d,e,f){var g=b('XControllerURIBuilder');e.exports=g.create("\/pubcontent\/related_share\/",{attachment_div_id:{type:"String",required:true},global_share_id:{type:"Int",required:true},video_div_id:{type:"String"}});});
__d("XPubcontentTopicChainingControllerURIBuilder",["XControllerURIBuilder"],function(a,b,c,d,e,f){var g=b('XControllerURIBuilder');e.exports=g.create("\/pubcontent\/topic_chaining\/",{pivotal_topic_ids:{type:"IntVector"}});});
__d("PubcontentFeedChainingController",["Arbiter","AsyncRequest","AttachmentRelatedShareConstants","DOM","FeedAdsChainingConfig","PageAdsAttachmentLinkShareConstants","PageLikeButton","PubcontentFeedChainingConfig","PubcontentRelatedShareChainingConfig","PubcontentTopicChainingConfig","StoryTopicMap","UFIFeedbackTargets","UFIUIEvents","XFeedAdsChainingControllerURIBuilder","XPubcontentFeedChainingControllerURIBuilder","XPubcontentRelatedShareChainingControllerURIBuilder","XPubcontentTopicChainingControllerURIBuilder"],function(a,b,c,d,e,f){var g=b('Arbiter'),h=b('AsyncRequest'),i=b('AttachmentRelatedShareConstants'),j=b('DOM'),k=b('FeedAdsChainingConfig'),l=b('PageAdsAttachmentLinkShareConstants'),m=b('PageLikeButton'),n=b('PubcontentFeedChainingConfig'),o=b('PubcontentRelatedShareChainingConfig'),p=b('PubcontentTopicChainingConfig'),q=b('StoryTopicMap'),r=b('UFIFeedbackTargets'),s=b('UFIUIEvents'),t=b('XFeedAdsChainingControllerURIBuilder'),u=b('XPubcontentFeedChainingControllerURIBuilder'),v=b('XPubcontentRelatedShareChainingControllerURIBuilder'),w=b('XPubcontentTopicChainingControllerURIBuilder'),x='ad_fan_page_action',y='ad_like_page_post_action',z='ad_share_attachment_click_action',aa='page_story_like_action',ba='related_share_article_click',ca='related_share_video_click',da='page_share_like_action',ea='topic_story_like_action';function fa(){"use strict";this.$PubcontentFeedChainingController0=n;this.$PubcontentFeedChainingController1=k;this.$PubcontentFeedChainingController2=o;this.$PubcontentFeedChainingController3=p;this.$PubcontentFeedChainingController4={};g.subscribe(m.LIKED,this.$PubcontentFeedChainingController5.bind(this));g.subscribe(s.UFIActionLinkLike,this.$PubcontentFeedChainingController6.bind(this));g.subscribe(i.ARTICLE_CLICK,this.$PubcontentFeedChainingController7.bind(this));g.subscribe(i.VIDEO_CLICK,this.$PubcontentFeedChainingController8.bind(this));g.subscribe(l.LINK_ATTACHMENT_CLICK,this.$PubcontentFeedChainingController9.bind(this));fa.instance=this;}fa.prototype.$PubcontentFeedChainingController5=function(ga,ha){"use strict";var ia=this.findAdClientToken(ha.target);if(ia){this.$PubcontentFeedChainingControllera(ha.target,{origin:x,actor_id:ha.profile_id,client_token:ia});}else this.$PubcontentFeedChainingControllerb(ha.target,{origin:ha.origin,actor_id:ha.profile_id});};fa.prototype.$PubcontentFeedChainingController6=function(ga,ha){"use strict";if(!ha.ft_id)return;r.getFeedbackTarget(ha.ft_id,function(ia,ja){var ka=this.findAdClientToken(ia);if(ka&&ja.isshare){this.$PubcontentFeedChainingControllera(ia,{actor_id:ja.actorid,origin:y,ft_id:ja.entidentifier,client_token:ka});}else if(ja.isownerpage){this.$PubcontentFeedChainingControllerb(ia,{actor_id:ja.actorid,origin:aa});}else if(ja.isshare){this.$PubcontentFeedChainingControllerb(ia,{actor_id:ja.actorid,ft_id:ja.entidentifier,origin:da});}else{var la=q.getTopicsForFTID(ja.entidentifier);if(la&&la.length>0)this.$PubcontentFeedChainingControllerc(ia,{ft_id:ja.entidentifier,origin:ea,pivotal_topic_ids:la});}}.bind(this,ha.target));};fa.prototype.$PubcontentFeedChainingController7=function(ga,ha){"use strict";ha.origin=ba;this.$PubcontentFeedChainingControllerd(ha.attachment,ha);};fa.prototype.$PubcontentFeedChainingController8=function(ga,ha){"use strict";ha.origin=ca;this.$PubcontentFeedChainingControllerd(ha.attachment,ha);};fa.prototype.$PubcontentFeedChainingController9=function(ga,ha){"use strict";var ia=this.findAdClientToken(ha.attachment);if(ia){ha.origin=z;ha.client_token=ia;this.$PubcontentFeedChainingControllera(ha.attachment,ha);}};fa.prototype.$PubcontentFeedChainingControllere=function(ga){"use strict";return !!(ga&&ga.id&&!(ga.id in this.$PubcontentFeedChainingController4));};fa.prototype.$PubcontentFeedChainingControllerf=function(ga){"use strict";if(!ga)return false;if(ga.origin in this.$PubcontentFeedChainingController0||ga.origin in this.$PubcontentFeedChainingController2||ga.origin in this.$PubcontentFeedChainingController1){return true;}else{var ha=this.$PubcontentFeedChainingController3[ga.origin];if(!ha||!ha.rate)return false;var ia=Math.random();if(ia>ha.rate)return false;return true;}};fa.prototype.$PubcontentFeedChainingControllerg=function(ga){"use strict";this.$PubcontentFeedChainingController4[ga]=true;};fa.prototype.$PubcontentFeedChainingControllerh=function(ga){"use strict";delete this.$PubcontentFeedChainingController4[ga];};fa.prototype.$PubcontentFeedChainingControlleri=function(ga,ha){"use strict";var ia=this.findStory(ga);if(!this.$PubcontentFeedChainingControllere(ia))return null;if(!this.$PubcontentFeedChainingControllerf(ha))return null;var ja=this.findContainer(ia);if(!ja)return null;this.$PubcontentFeedChainingControllerg(ia.id);var ka=j.create('div'),la=j.appendContent(ja,ka);if(la.length!==1)return null;return {chainingWrapper:la[0],story:ia};};fa.prototype.$PubcontentFeedChainingControllera=function(ga,ha){"use strict";var ia=this.$PubcontentFeedChainingControlleri(ga,ha);if(!ia)return false;var ja=this.findStreamRoot(ia.story);if(!ja)return false;var ka=ja.getAttribute('id'),la=(new t()).setInt('actor_id',ha.actor_id).setString('origin',ha.origin).setString('ei',ha.client_token).setString('data_ownerid',ka);if(ha.ft_id)la.setString('ft_id',ha.ft_id);new h().setErrorHandler(this.$PubcontentFeedChainingControllerh.bind(this,ia.story.id)).setRelativeTo(ia.chainingWrapper).setURI(la.getURI()).send();return true;};fa.prototype.$PubcontentFeedChainingControllerd=function(ga,ha){"use strict";var ia=this.$PubcontentFeedChainingControlleri(ga,ha);if(!ia)return false;var ja=(new v()).setInt('global_share_id',ha.global_share_id).setString('attachment_div_id',j.getID(ha.attachment));if(ha.video_div_id)ja.setString('video_div_id',ha.video_div_id);var ka=new h().setErrorHandler(this.$PubcontentFeedChainingControllerh.bind(this,ia.story.id)).setRelativeTo(ia.chainingWrapper).setURI(ja.getURI()),la=JSON.parse(ia.story.getAttribute('data-ft'))||{};la&&ka.setData(la);ka.send();return true;};fa.prototype.$PubcontentFeedChainingControllerb=function(ga,ha){"use strict";var ia=this.$PubcontentFeedChainingControlleri(ga,ha);if(!ia)return false;var ja=(new u()).setInt('actor_id',ha.actor_id).setString('origin',ha.origin);if(ha.ft_id)ja.setString('ft_id',ha.ft_id);new h().setErrorHandler(this.$PubcontentFeedChainingControllerh.bind(this,ia.story.id)).setRelativeTo(ia.chainingWrapper).setURI(ja.getURI()).send();return true;};fa.prototype.$PubcontentFeedChainingControllerc=function(ga,ha){"use strict";var ia=this.$PubcontentFeedChainingControlleri(ga,ha);if(!ia)return false;var ja=(new w()).setIntVector('pivotal_topic_ids',ha.pivotal_topic_ids).getURI();new h().setErrorHandler(this.$PubcontentFeedChainingControllerh.bind(this,ia.story.id)).setRelativeTo(ia.chainingWrapper).setURI(ja).send();return true;};e.exports=fa;});
__d("PubcontentFbFeedChainingController",["DOM","PubcontentFeedChainingController","csx"],function(a,b,c,d,e,f){var g=b('DOM'),h=b('PubcontentFeedChainingController'),i=b('csx');for(var j in h)if(h.hasOwnProperty(j))l[j]=h[j];var k=h===null?null:h.prototype;l.prototype=Object.create(k);l.prototype.constructor=l;l.__superConstructor__=h;function l(){"use strict";if(h!==null)h.apply(this,arguments);}l.prototype.findStory=function(m){"use strict";var n="^div._5pat",o=g.scry(m,n);return o.length===1?o[0]:null;};l.prototype.findContainer=function(m){"use strict";var n="div._5pax",o=g.scry(m,n);if(o.length===0){var p="div._5yq4";o=g.scry(m,p);}return o.length>=1?o[0]:null;};l.prototype.findStreamRoot=function(m){"use strict";var n="^div._4ikz",o=g.scry(m,n);return o.length>=1?o[0]:null;};l.prototype.findAdClientToken=function(m){"use strict";var n=this.findStory(m);if(!n)return null;var o=n.getAttribute('data-ft');if(!o)return null;var p=JSON.parse(o);return p.ei;};e.exports=l;new l();});
__d("StreamViewportTracking",["Arbiter","DOM","UIIntentionalStreamMessage","ViewportTracking","ge","recordTNTreeData"],function(a,b,c,d,e,f){var g=b('Arbiter'),h=b('DOM'),i=b('UIIntentionalStreamMessage'),j=b('ViewportTracking'),k=b('ge'),l=b('recordTNTreeData'),m=51;for(var n in j)if(j.hasOwnProperty(n))p[n]=j[n];var o=j===null?null:j.prototype;p.prototype=Object.create(o);p.prototype.constructor=p;p.__superConstructor__=j;function p(){"use strict";if(j!==null)j.apply(this,arguments);}p.prototype.init=function(q,r){"use strict";if(r)this.$StreamViewportTracking0=r;o.init.call(this,q);this.initSubscriptions();};p.prototype.initSubscriptions=function(){"use strict";this.subscriptions.addSubscriptions(g.subscribe(i.UPDATE_LAST_REFRESH_TIME,this.invalidateAllStoriesCache.bind(this)),g.subscribe(i.UNLOAD,this.updateTimeTrackingData.bind(this,true)));};p.prototype.getDataFromConfig=function(q){"use strict";this.recordTNTree=q.record_tn_tree;this.timeout=q.record_delay;this.isTimetrackingEnabled=!!q.is_timetracking_enabled;};p.prototype.getTimeout=function(){"use strict";return this.timeout;};p.prototype.getStorySelector=function(){"use strict";return '.uiStreamStory';};p.prototype.getAllStories=function(){"use strict";var q=h.scry(this.getStream(),this.getStorySelector());return q.filter(function(r){return r.getAttribute('data-ft');});};p.prototype.getStoryID=function(q){"use strict";var r=JSON.parse(q.getAttribute('data-ft'));return r.mf_story_key;};p.prototype.getDataToLog=function(q){"use strict";var r={};if(this.recordTNTree){var s=this.getStream();r=l(q,s);var t=q.getAttribute('data-insertion-position');if(t!==null)r.inspos=t;}r.evt=m;return {ft:r};};p.prototype.getStream=function(){"use strict";if(this.$StreamViewportTracking0)return this.$StreamViewportTracking0;return k('home_stream');};p.init=function(q,r){"use strict";p.instance=new p();p.instance.init(q,r);};p.getInstance=function(){"use strict";return p.instance;};e.exports=p;});
__d("FbFeedKeyboardController",["CSS","DOM","DOMQuery","FeedBaseKeyboardController","JSXDOM","Parent","csx","cx","ge"],function(a,b,c,d,e,f){var g=b('CSS'),h=b('DOM'),i=b('DOMQuery'),j=b('FeedBaseKeyboardController'),k=b('JSXDOM'),l=b('Parent'),m=b('csx'),n=b('cx'),o=b('ge');function p(u){if(u.previousElementSibling)return u.previousElementSibling;u=u.previousSibling;while(u&&!h.isElementNode(u))u=u.previousSibling;return u||null;}function q(u){if(u.nextElementSibling)return u.nextElementSibling;u=u.nextSibling;while(u&&!h.isElementNode(u))u=u.nextSibling;return u||null;}for(var r in j)if(j.hasOwnProperty(r))t[r]=j[r];var s=j===null?null:j.prototype;t.prototype=Object.create(s);t.prototype.constructor=t;t.__superConstructor__=j;function t(){"use strict";if(j!==null)j.apply(this,arguments);}t.prototype.getStories=function(u){"use strict";return h.scry(u||this.root,"._5jmm");};t.prototype.isHoldoutStory=function(u){"use strict";return !!u&&g.hasClass(u,'holdoutAdStory');};t.prototype.isRelevantStory=function(u){"use strict";return i.isElementNode(u)&&!this.isHoldoutStory(u);};t.prototype.isStory=function(u){"use strict";return g.hasClass(u,"_5jmm");};t.prototype.clickLike=function(){"use strict";this.click('.UFILikeLink');};t.prototype.clickComment=function(){"use strict";this.click('.comment_link');};t.prototype.clickShare=function(){"use strict";this.click('.share_action_link');};t.prototype.openAttachment=function(){"use strict";this.click("._5dec","a._52c6","._4-eo",'.uiVideoThumb');};t.prototype.getHeadline=function(u){"use strict";return i.scry(u,"h5._5pbw")[0];};t.prototype.getPreviousSibling=function(u){"use strict";var v=p(u);if(v&&this.getParentStory(v))return v;v=null;var w=l.byClass(u,"_5pcb");if(w){var x=h.scry(w,"._5jmm"),y=x.indexOf(u);if(y===0){v=o('pagelet_composer');v=v&&l.byClass(v,"_5jmm");}else if(y>0)v=x[y-1];}return v||this.selected;};t.prototype.getPreviousStory=function(u){"use strict";var v=this.getPreviousSibling(u);while(v&&!this.isStory(v))v=this.getPreviousSibling(v);return v;};t.prototype.getParentStory=function(u){"use strict";return l.byClass(u,"_5jmm");};t.prototype.getNextSibling=function(u){"use strict";var v=q(u);if(v&&this.getParentStory(v))return v;v=null;var w=l.byClass(u,"_5pcb");if(w){var x=h.scry(w,"._5jmm"),y=x.indexOf(u);if(y>-1)v=x[y+1];}else if(o('pagelet_composer',u))v=h.scry(document,"div._5pcb ._5jmm")[0];return v||this.selected;};t.prototype.getNextStory=function(u){"use strict";var v=this.getNextSibling(u);while(v&&!this.isStory(v))v=this.getNextSibling(v);return v;};t.prototype.setSelected=function(u,v){"use strict";if(u){var w="_5qdu",x=i.scry(u,"._5qdu");if(!x.length&&v)h.prependContent(u,k.div({className:w}));}if(v){this.selected&&this.setTabindexOnStory(this.selected,'-1');this.selected&&g.removeClass(this.selected,"_5qdv");this.selected=u;u&&this.setTabindexOnStory(u,'0');u&&g.addClass(u,"_5qdv");}};t.init=function(u){"use strict";new t(u);};e.exports=t;});
__d("FbFeedViewportTracking",["Arbiter","LitestandMessages","LitestandStream","StreamViewportTracking","csx"],function(a,b,c,d,e,f){var g=b('Arbiter'),h=b('LitestandMessages'),i=b('LitestandStream'),j=b('StreamViewportTracking'),k=b('csx');for(var l in j)if(j.hasOwnProperty(l))n[l]=j[l];var m=j===null?null:j.prototype;n.prototype=Object.create(m);n.prototype.constructor=n;n.__superConstructor__=j;function n(){"use strict";if(j!==null)j.apply(this,arguments);}n.prototype.initSubscriptions=function(){"use strict";this.subscriptions.addSubscriptions(g.subscribe([h.STORIES_INSERTED,h.STORIES_REMOVED],this.invalidateAllStoriesCache.bind(this)),g.subscribe(h.LEAVE_HOME,this.updateTimeTrackingData.bind(this,true)));};n.prototype.getStorySelector=function(){"use strict";return "._5jmm";};n.prototype.getStream=function(){"use strict";return i.getStreamRoot();};n.init=function(o){"use strict";new n().init(o);};e.exports=n;});
__d("MenuTogglingItem",["DOM","MenuItem"],function(a,b,c,d,e,f){var g=b('DOM'),h=b('MenuItem');for(var i in h)if(h.hasOwnProperty(i))k[i]=h[i];var j=h===null?null:h.prototype;k.prototype=Object.create(j);k.prototype.constructor=k;k.__superConstructor__=h;function k(){"use strict";if(h!==null)h.apply(this,arguments);}k.prototype.handleClick=function(){"use strict";this.toggleMenuItem();return j.handleClick.call(this);};k.prototype.toggleMenuItem=function(){"use strict";this._swap('ajaxify','toggleAjaxify');this._swap('value','toggleValue');this._toggleItemText();};k.prototype.setValue=function(l){"use strict";this._data.value=l;};k.prototype._toggleItemText=function(){"use strict";var l=this._anchor;this._swap('markup','toggleMarkup');g.replace(l,this._renderItemContent());};k.prototype._swap=function(l,m){"use strict";var n=this._data[l];this._data[l]=this._data[m];this._data[m]=n;};e.exports=k;});