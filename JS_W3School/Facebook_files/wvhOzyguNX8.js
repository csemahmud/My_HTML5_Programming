/*!CK:2119725520!*//*1390272458,178186553*/

if (self.CavalryLogger) { CavalryLogger.start_js(["cW7DT"]); }

__d("CLoggerX",["Banzai","DOM","debounce","Event","ge","Parent","Keys"],function(a,b,c,d,e,f){var g=b('Banzai'),h=b('DOM'),i=b('debounce'),j=b('Event'),k=b('ge'),l=b('Parent'),m=10*60*1000,n=b('Keys').RETURN,o={},p=function(s){var t=(s.target||s.srcElement).id,u=(s.target||s.srcElement).value.trim().length,v=q.getTracker(t);if(!v)return;if(u>5&&!v.submitted){g.post('censorlogger',{cl_impid:v.impid,clearcounter:v.clearcounter,instrument:v.type,elementid:t,parent_fbid:(v.parent_fbid=='unknown'?null:v.parent_fbid),version:"x"},g.VITAL);q.setSubmitted(t,true);}else if(u===0&&v.submitted&&s.which!=n){o[t]=r(t);o[t]();}else if(u>0&&v.submitted)if(o[t])o[t].reset();},q={init:function(){this.trackedElements=this.trackedElements||{};this.feedbackForms=this.feedbackForms||{};},setImpressionID:function(s){this.init();this.impressionID=s;this.clean();},setComposerTargetData:function(s){this.cTargetID=s.targetID||'unknown';this.cTargetFBType=s.targetType||'unknown';},clean:function(){for(var s in this.trackedElements){if(o[s]){o[s].reset();delete o[s];}delete this.trackedElements[s];}},trackComposer:function(s,t,u){this.setComposerTargetData(u);this.startTracking(s,'composer',this.cTargetID,this.cTargetFBType,t);},trackFeedbackForm:function(s,t,u){this.init();this.impressionID=this.impressionID||u;var v,w;v=t?t.targetID||'unknown':'unknown';w=t?t.targetType||'unknown':'unknown';this.feedbackForms[s]={parent_fbid:v,parent_type:w};},trackMentionsInput:function(s,t){this.init();var u,v,w;if(!s)return;u=l.byTag(s,'form');if(!u)return;v=h.getID(u);w=this.feedbackForms[v];if(!w)return;var x=t||w.parent_fbid,y=t?416:w.parent_type;this.startTracking(s,'comment',x,y,u);},startTracking:function(s,t,u,v,w){this.init();var x=h.getID(s);if(this.getTracker(x))return;var y=h.getID(w);j.listen(s,'keyup',p.bind(this));this.trackedElements[x]={submitted:false,clearcounter:0,type:t,impid:this.impressionID,parent_fbid:u,parent_type:v,parentElID:y};this.addJoinTableInfoToForm(w,x);},getTracker:function(s){return (this.trackedElements?this.trackedElements[s]:null);},setSubmitted:function(s,t){if(this.trackedElements[s])this.trackedElements[s].submitted=t;},incrementClearCounter:function(s){var t=this.getTracker(s);if(!t)return;t.clearcounter++;t.submitted=false;var u=h.scry(k(t.parentElID),'input[name="clp"]')[0];if(u)u.value=this.getJSONRepForTrackerID(s);this.trackedElements[s]=t;},addJoinTableInfoToForm:function(s,t){var u=this.getTracker(t);if(!u)return;var v=h.scry(s,'input[name="clp"]')[0];if(!v)h.prependContent(s,h.create('input',{type:'hidden',name:'clp',value:this.getJSONRepForTrackerID(t)}));},getCLParamsForTarget:function(s,t){if(!s)return "";var u=h.getID(s);return this.getJSONRepForTrackerID(u,t);},getJSONRepForTrackerID:function(s,t){var u=this.getTracker(s);if(!u)return "";return JSON.stringify({cl_impid:u.impid,clearcounter:u.clearcounter,elementid:s,version:"x",parent_fbid:t||u.parent_fbid});}},r=function(s){return i(function(){q.incrementClearCounter(s);},m,q);};e.exports=q;});
__d("ClickTTIIdentifiers",[],function(a,b,c,d,e,f){var g={types:{TIMELINE_SEE_LIKERS:'timeline:seelikes'},getUserActionID:function(h){return '{"ua_id":"'+h+'"}';}};e.exports=g;});
__d("TrackingNodes",[],function(a,b,c,d,e,f){var g={types:{USER_NAME:2,LIKE_LINK:5,UNLIKE_LINK:6,ATTACHMENT:15,SHARE_LINK:17,USER_MESSAGE:18,SOURCE:21,BLINGBOX:22,VIEW_ALL_COMMENTS:24,COMMENT:25,COMMENT_LINK:26,SMALL_ACTOR_PHOTO:27,XBUTTON:29,HIDE_LINK:30,REPORT_SPAM_LINK:31,HIDE_ALL_LINK:32,ADD_COMMENT_BOX:34,UFI:36,DROPDOWN_BUTTON:55,UNHIDE_LINK:71,RELATED_SHARE_ARTICLE:73,RELATED_SHARE_VIDEO:75,NOTE:91},BASE_CODE_START:58,BASE_CODE_END:126,BASE_CODE_SIZE:69,PREFIX_CODE_START:42,PREFIX_CODE_END:47,PREFIX_CODE_SIZE:6,encodeTrackingInfo:function(h,i){var j=(h-1)%g.BASE_CODE_SIZE,k=parseInt((h-1)/g.BASE_CODE_SIZE,10);if(h<1||k>g.PREFIX_CODE_SIZE)throw Error('Invalid tracking node: '+h);var l="";if(k>0)l+=String.fromCharCode(k-1+g.PREFIX_CODE_START);l+=String.fromCharCode(j+g.BASE_CODE_START);if(typeof i!="undefined"&&i>0)l+=String.fromCharCode(48+Math.min(i,10)-1);return l;},decodeTN:function(h){if(h.length===0)return [0];var i=h.charCodeAt(0),j=1,k,l;if(i>=g.PREFIX_CODE_START&&i<=g.PREFIX_CODE_END){if(h.length==1)return [0];l=i-g.PREFIX_CODE_START+1;k=h.charCodeAt(1);j=2;}else{l=0;k=i;}if(k<g.BASE_CODE_START||k>g.BASE_CODE_END)return [0];var m=l*g.BASE_CODE_SIZE+(k-g.BASE_CODE_START)+1;if(h.length>j&&(h.charAt(j)>='0'&&h.charAt(j)<='9'))return [j+1,[m,parseInt(h.charAt(j),10)+1]];return [j,[m]];},parseTrackingNodeString:function(h){var i=[];while(h.length>0){var j=g.decodeTN(h);if(j.length==1)return [];i.push(j[1]);h=h.substring(j[0]);}return i;},getTrackingInfo:function(h,i){return '{"tn":"'+g.encodeTrackingInfo(h,i)+'"}';}};e.exports=g;});
__d("NumberFormat",["CurrentLocale","NumberFormatConfig"],function(a,b,c,d,e,f){var g=b('CurrentLocale'),h=b('NumberFormatConfig'),i=/(\d{3})(?=\d)/g,j=10000,k=['es_ES','es_LA','nb_NO','nn_NO'];function l(o){return (''+o).split('').reverse().join('');}function m(o,p){if((k.indexOf(g.get())>=0)&&(Math.abs(o)<j))return o.toString();var q=l(o);return l(q.replace(i,'$1'+p));}var n={formatIntegerWithDelimiter:m,formatInteger:function(o){return m(o,h.numberDelimiter);}};e.exports=n;});
__d("UFIBlingItem.react",["React","NumberFormat","cx","joinClasses"],function(a,b,c,d,e,f){var g=b('React'),h=b('NumberFormat'),i=b('cx'),j=b('joinClasses'),k=g.createClass({displayName:'UFIBlingItem',render:function(){var l=j(this.props.className,this.props.iconClassName,"UFIBlingBoxSprite"),m=h.formatIntegerWithDelimiter(this.props.count,this.props.contextArgs.numberdelimiter||',');return (g.DOM.span(null,g.DOM.i({className:l}),g.DOM.span({className:"UFIBlingBoxText"},m)));}});e.exports=k;});
__d("UFIBlingBox.react",["React","UFIBlingItem.react","UFIConstants","cx","tx"],function(a,b,c,d,e,f){var g=b('React'),h=b('UFIBlingItem.react'),i=b('UFIConstants'),j=b('cx'),k=b('tx'),l=g.createClass({displayName:'UFIBlingBox',render:function(){var m=[],n='';if(this.props.likes){m.push(h({className:((m.length>0?"mls":'')),contextArgs:this.props.contextArgs,count:this.props.likes,iconClassName:"UFIBlingBoxLikeIcon",key:"like"}));n+=(this.props.likes==1)?"1 like":k._("{count} likes",{count:this.props.likes});n+=' ';}if(this.props.comments){m.push(h({className:((m.length>0?"mls":'')),contextArgs:this.props.contextArgs,count:this.props.comments,iconClassName:"UFIBlingBoxCommentIcon",key:"comment"}));n+=(this.props.comments==1)?"1 comment":k._("{count} comments",{count:this.props.comments});n+=' ';}if(this.props.reshares){m.push(h({className:((m.length>0?"mls":'')),contextArgs:this.props.contextArgs,count:this.props.reshares,iconClassName:"UFIBlingBoxReshareIcon",key:"reshare"}));n+=(this.props.reshares==1)?"1 share":k._("{count} shares",{count:this.props.reshares});}var o=g.DOM.a({className:"UFIBlingBox uiBlingBox feedbackBling",href:this.props.permalink,'data-ft':this.props['data-ft'],'aria-label':n},m);if(this.props.comments<i.defaultPageSize){o.props.onClick=this.props.onClick;o.props.rel='ignore';}return o;}});e.exports=l;});
__d("UFICentralUpdates",["Arbiter","ChannelConstants","LiveTimer","ShortProfiles","UFIConstants","copyProperties","tx"],function(a,b,c,d,e,f){var g=b('Arbiter'),h=b('ChannelConstants'),i=b('LiveTimer'),j=b('ShortProfiles'),k=b('UFIConstants'),l=b('copyProperties'),m=b('tx'),n=0,o={},p={},q={},r={},s=[];g.subscribe(h.getArbiterType('live-data'),function(x,y){if(y&&y.obj){var z=y.obj,aa=z.comments||[];aa.forEach(function(ba){ba.timestamp.text="a few seconds ago";});w.handleUpdate(k.UFIPayloadSourceType.LIVE_SEND,z);}});function t(){if(!n){var x=q,y=o,z=p,aa=r;q={};o={};p={};r={};if(Object.keys(x).length)v('feedback-id-changed',x);if(Object.keys(y).length)v('feedback-updated',y);if(Object.keys(z).length)v('comments-updated',z);if(Object.keys(aa).length)v('instance-updated',aa);s.pop();}}function u(){if(s.length){return s[s.length-1];}else return k.UFIPayloadSourceType.UNKNOWN;}function v(event,x){w.inform(event,{updates:x,payloadSource:u()});}var w=l(new g(),{handleUpdate:function(x,y){if(Object.keys(y).length)this.synchronizeInforms(function(){s.push(x);var z=l({payloadsource:u()},y);this.inform('update-feedback',z);this.inform('update-comment-lists',z);this.inform('update-comments',z);this.inform('update-actions',z);(y.profiles||[]).forEach(function(aa){j.set(aa.id,aa);});if(y.servertime)i.restart(y.servertime);}.bind(this));},didUpdateFeedback:function(x){o[x]=true;t();},didUpdateComment:function(x){p[x]=true;t();},didUpdateFeedbackID:function(x,y){q[x]=y;t();},didUpdateInstanceState:function(x,y){if(!r[x])r[x]={};r[x][y]=true;t();},synchronizeInforms:function(x){n++;try{x();}catch(y){throw y;}finally{n--;t();}}});e.exports=w;});
__d("ClientIDs",["randomInt"],function(a,b,c,d,e,f){var g=b('randomInt'),h={},i={getNewClientID:function(){var j=Date.now(),k=j+':'+(g(0,4294967295)+1);h[k]=true;return k;},isExistingClientID:function(j){return !!h[j];}};e.exports=i;});
__d("UFIFeedbackTargets",["ClientIDs","KeyedCallbackManager","UFICentralUpdates","UFIConstants","copyProperties"],function(a,b,c,d,e,f){var g=b('ClientIDs'),h=b('KeyedCallbackManager'),i=b('UFICentralUpdates'),j=b('UFIConstants'),k=b('copyProperties'),l=new h();function m(u){var v={};u.forEach(function(w){var x=k({},w);delete x.commentlist;delete x.commentcount;v[w.entidentifier]=x;i.didUpdateFeedback(w.entidentifier);});l.addResourcesAndExecute(v);}function n(u){for(var v=0;v<u.length;v++){var w=u[v];switch(w.actiontype){case j.UFIActionType.LIKE_ACTION:p(w);break;case j.UFIActionType.SUBSCRIBE_ACTION:q(w);break;}}}function o(u){for(var v=0;v<u.length;v++){var w=u[v];if(w.orig_ftentidentifier)s(w.orig_ftentidentifier,w.ftentidentifier);}}function p(u){var v=r(u);if(v){u.hasviewerliked=!!u.hasviewerliked;if(u.clientid&&g.isExistingClientID(u.clientid)&&u.hasviewerliked!=v.hasviewerliked)return;v.likecount=u.likecount||0;v.likesentences=u.likesentences;if(u.actorid==v.actorforpost){v.hasviewerliked=u.hasviewerliked;}else if(u.hasviewerliked!=v.hasviewerliked){v.likesentences={current:u.likesentences.alternate,alternate:u.likesentences.current};if(v.hasviewerliked){v.likecount++;}else v.likecount--;}if(u.actorid!=v.actorforpost)v.likesentences.isunseen=true;m([v]);}}function q(u){var v=r(u);if(v){u.hasviewersubscribed=!!u.hasviewersubscribed;if(u.clientid&&g.isExistingClientID(u.clientid)&&u.hasviewersubscribed!=v.hasviewersubscribed)return;if(u.actorid==v.actorforpost)v.hasviewersubscribed=u.hasviewersubscribed;m([v]);}}function r(u){if(u.orig_entidentifier)s(u.orig_entidentifier,u.entidentifier);return l.getResource(u.entidentifier);}function s(u,v){var w=l.getResource(u);if(w){l.setResource(u,null);w.entidentifier=v;l.setResource(v,w);i.didUpdateFeedbackID(u,v);}}var t={getFeedbackTarget:function(u,v){var w=l.executeOrEnqueue(u,v),x=l.getUnavailableResources(w);x.length;return w;},unsubscribe:function(u){l.unsubscribe(u);}};i.subscribe('update-feedback',function(u,v){var w=v.feedbacktargets;if(w&&w.length)m(w);});i.subscribe('update-actions',function(u,v){if(v.actions&&v.actions.length)n(v.actions);});i.subscribe('update-comments',function(u,v){if(v.comments&&v.comments.length)o(v.comments);});e.exports=t;});
__d("UFILikeLink.react",["React","TrackingNodes","tx"],function(a,b,c,d,e,f){var g=b('React'),h=b('TrackingNodes'),i=b('tx'),j=g.createClass({displayName:'UFILikeLink',render:function(){var k=this.props.likeAction?"Like":"Unlike",l=h.getTrackingInfo(this.props.likeAction?h.types.LIKE_LINK:h.types.UNLIKE_LINK),m=this.props.likeAction?"Like this":"Unlike this";return (g.DOM.a({className:"UFILikeLink",href:"#",role:"button",'aria-live':"polite",title:m,onClick:this.props.onClick,'data-ft':l},k));}});e.exports=j;});
__d("UFISubscribeLink.react",["React","fbt","tx"],function(a,b,c,d,e,f){var g=b('React'),h=b('fbt'),i=b('tx'),j=g.createClass({displayName:'UFISubscribeLink',render:function(){var k=this.props.useNotifyLanguage,l=this.props.subscribeAction?(!k?"Follow Post":"Get Notifications"):(!k?"Unfollow Post":"Stop Notifications"),m=this.props.subscribeAction?(!k?"Get notified when someone comments":"Get a notification whenever someone comments."):(!k?"Stop getting notified when someone comments":"Stop getting notifications when someone comments.");return (g.DOM.a({className:"UFISubscribeLink",href:"#",role:"button",'aria-live':"polite",title:m,onClick:this.props.onClick},l));}});e.exports=j;});
__d("ProfileBrowserLink",["URI"],function(a,b,c,d,e,f){var g=b('URI'),h='/ajax/browser/dialog/',i='/browse/',j=function(l,m,n){return new g(l+m).setQueryData(n);},k={constructPageURI:function(l,m){return j(i,l,m);},constructDialogURI:function(l,m){return j(h,l,m);}};e.exports=k;});
__d("ProfileBrowserTypes",[],function(a,b,c,d,e,f){var g={LIKES:'likes',GROUP_MESSAGE_VIEWERS:'group_message_viewers',MUTUAL_FRIENDS:'mutual_friends',TODO_LIST_ASSIGNEES:'todo_list_assignees'};e.exports=g;});
__d("UFITimelineBlingBox.react",["ProfileBrowserLink","ProfileBrowserTypes","React","UFIBlingItem.react","URI","cx","fbt"],function(a,b,c,d,e,f){var g=b('ProfileBrowserLink'),h=b('ProfileBrowserTypes'),i=b('React'),j=b('UFIBlingItem.react'),k=b('URI'),l=b('cx'),m=b('fbt'),n=i.createClass({displayName:'UFITimelineBlingBox',render:function(){var o=[];if(this.props.likes&&this.props.enableShowLikes){var p=this._getProfileBrowserURI(),q="See who likes this",r=i.DOM.a({ajaxify:p.dialog,className:this._getItemClassName(o),'data-ft':this.props['data-ft'],'data-gt':this.props['data-gt'],'data-hover':"tooltip",'data-tooltip-alignh':"right",'data-tooltip-uri':this._getLikeToolTipURI(),href:p.page,rel:"dialog",role:"button",title:q},j({contextArgs:this.props.contextArgs,count:this.props.likes,iconClassName:"UFIBlingBoxTimelineLikeIcon"}));o.push(r);}if(this.props.comments&&this.props.enableShowComments){var s="Show comments",t=i.DOM.a({'aria-label':s,className:this._getItemClassName(o),'data-ft':this.props['data-ft'],'data-hover':"tooltip",'data-tooltip-alignh':"right",href:"#",onClick:this.props.commentOnClick},j({contextArgs:this.props.contextArgs,count:this.props.comments,iconClassName:"UFIBlingBoxTimelineCommentIcon"}));o.push(t);}if(this.props.reshares){var u="Show shares",v=this._getShareViewURI(),w=i.DOM.a({ajaxify:v.dialog,'aria-label':u,className:this._getItemClassName(o),'data-ft':this.props['data-ft'],'data-hover':"tooltip",'data-tooltip-alignh':"right",href:v.page,rel:"async"},j({contextArgs:this.props.contextArgs,count:this.props.reshares,iconClassName:"UFIBlingBoxTimelineReshareIcon"}));o.push(w);}return (i.DOM.span(null,o));},_getItemClassName:function(o){return ((o.length>0?"mls":'')+(' '+"UFIBlingBoxTimelineItem"));},_getLikeToolTipURI:function(){if(this.props.feedbackFBID){var o=new k('/ajax/timeline/likestooltip.php').setQueryData({obj_fbid:this.props.feedbackFBID});return o.toString();}else return null;},_getProfileBrowserURI:function(){if(this.props.feedbackFBID){var o=h.LIKES,p={id:this.props.feedbackFBID},q=g.constructDialogURI(o,p),r=g.constructPageURI(o,p),s={dialog:q.toString(),page:r.toString()};return s;}},_getShareViewURI:function(){if(this.props.feedbackFBID){var o=new k('/ajax/shares/view').setQueryData({target_fbid:this.props.feedbackFBID}),p=new k('/shares/view').setSubdomain('www').setQueryData({id:this.props.feedbackFBID}),q={dialog:o.toString(),page:p.toString()};return q;}}});e.exports=n;});
__d("UFICommentList",["ClientIDs","KeyedCallbackManager","UFICentralUpdates","UFIConstants","UFIFeedbackTargets"],function(a,b,c,d,e,f){"use strict";var g=b('ClientIDs'),h=b('KeyedCallbackManager'),i=b('UFICentralUpdates'),j=b('UFIConstants'),k=b('UFIFeedbackTargets');function l(m){this.count=0;this.deletedComments={};this.deletedCount=0;this.dataSource=new h();this.feedbackTargetID=m;this.lastRequestedOffset=0;this.lastRequestedLength=0;this.basePermalink="";this.commentPermalinks={};k.getFeedbackTarget(this.feedbackTargetID,function(n){this.basePermalink=n.permalink;}.bind(this));}l.prototype.addComment=function(m,n,o){var p=n&&g.isExistingClientID(n),q=this.dataSource.getAllResources(),r={};for(var s in q){var t=q[s];r[t]=s;}if(p&&n in r){r[m]=r[n];var u=r[n];this.dataSource.setResource(u,m);}else if(!r[m]){var v=this.count;this.count++;r[m]=v;this.dataSource.setResource(v,m);}if(o)this.commentPermalinks[m]=this.buildCommentPermalink(m,o,r[m]);i.didUpdateFeedback(this.feedbackTargetID);};l.prototype.addCommentIDs=function(m,n,o){var p={};for(var q=0;q<n;q++)p[m+q]=o[q]||j.unavailableCommentKey;this.dataSource.addResourcesAndExecute(p);i.didUpdateFeedback(this.feedbackTargetID);return this;};l.prototype.getComments=function(m,n,o,p){var q=[];for(var r=0;r<n;r++)q.push(m+r);var s=this.dataSource.getUnavailableResourcesFromRequest(q);if(s.length){var t=Math.min.apply(Math,s),u=Math.max.apply(Math,s),v=t,w=u-t+1;if(v<this.lastRequestedOffset||(v+w)>(this.lastRequestedOffset+this.lastRequestedLength)){this.lastRequestedOffset=v;this.lastRequestedLength=w;this.fetchComments(v,w,o);}}else this.dataSource.deferredExecuteOrEnqueue(q).addCallback(this.deferredCallback.bind(this,m,n,p));};l.prototype.fetchComments=function(m,n,o){};l.prototype.deferredCallback=function(m,n,o,p){};l.prototype.reset=function(){var m=this.dataSource.getAllResources();this.dataSource.reset();this.count=0;this.deletedCount=0;this.deletedComments={};this.lastRequestedOffset=0;this.lastRequestedLength=0;return m;};l.prototype.deleteComment=function(m){if(!(m in this.deletedComments)){this.deletedComments[m]=true;this.deletedCount++;}};l.prototype.undoDeleteComment=function(m){if(m in this.deletedComments){delete this.deletedComments[m];this.deletedCount--;}};l.prototype.updateCommentCount=function(m){this.count=m;this.deletedCount=0;return this;};l.prototype.getFeedbackTargetID=function(){return this.feedbackTargetID;};l.prototype.getCommentCount=function(){return this.count;};l.prototype.getDeletedCount=function(){return this.deletedCount;};l.prototype.getDisplayedCommentCount=function(){return this.count-this.deletedCount;};l.prototype.getBasePermalink=function(){return this.basePermalink;};l.prototype.buildCommentPermalink=function(m,n,o){};l.prototype.getPermalinkForComment=function(m){return this.commentPermalinks[m];};e.exports=l;});
__d("ImmutableObject",["invariant","isNode","merge","mergeInto","mergeHelpers"],function(a,b,c,d,e,f){"use strict";var g=b('invariant'),h=b('isNode'),i=b('merge'),j=b('mergeInto'),k=b('mergeHelpers'),l=k.checkMergeObjectArgs,m=k.isTerminal,n;function o(q){g(q instanceof n);}n=function q(r){j(this,r);};n.set=function(q,r){o(q);var s=new n(q);j(s,r);return s;};n.setField=function(q,r,s){var t={};t[r]=s;return n.set(q,t);};n.setDeep=function(q,r){o(q);return p(q,r);};function p(q,r){l(q,r);var s={},t=Object.keys(q);for(var u=0;u<t.length;u++){var v=t[u];if(!r.hasOwnProperty(v)){s[v]=q[v];}else if(m(q[v])||m(r[v])){s[v]=r[v];}else s[v]=p(q[v],r[v]);}var w=Object.keys(r);for(u=0;u<w.length;u++){var x=w[u];if(q.hasOwnProperty(x))continue;s[x]=r[x];}return (q instanceof n||r instanceof n)?new n(s):s;}e.exports=n;});
__d("UFIInstanceState",["UFICentralUpdates"],function(a,b,c,d,e,f){var g=b('UFICentralUpdates'),h={};function i(k){if(!h[k])h[k]={};}var j={getKeyForInstance:function(k,l){i(k);return h[k][l];},updateState:function(k,l,m){i(k);h[k][l]=m;g.didUpdateInstanceState(k,l);},updateStateField:function(k,l,m,n){var o=this.getKeyForInstance(k,l)||{};o[m]=n;this.updateState(k,l,o);}};e.exports=j;});
__d("UFIComments",["ClientIDs","ImmutableObject","UFICentralUpdates","UFIConstants","UFIInstanceState","invariant","merge","randomInt"],function(a,b,c,d,e,f){"use strict";var g=b('ClientIDs'),h=b('ImmutableObject'),i=b('UFICentralUpdates'),j=b('UFIConstants'),k=b('UFIInstanceState'),l=b('invariant'),m=b('merge'),n=b('randomInt'),o={},p={};function q(ga){return ga in p?p[ga]:ga;}function r(ga,ha){ga.forEach(function(ia){var ja=ia.ftentidentifier,ka=j.UFIPayloadSourceType,la=ia.clientid,ma=false,na=m({},ia);if(la){delete na.clientid;ma=g.isExistingClientID(la);if(ma&&p[la])return;}if((ha===ka.LIVE_SEND)||(ha===ka.USER_ACTION)||(ha===ka.ENDPOINT_ADD_COMMENT)||(ha===ka.ENDPOINT_EDIT_COMMENT))na.isunseen=true;if(ha===ka.ENDPOINT_COMMENT_FETCH||ha===ka.ENDPOINT_ID_COMMENT_FETCH)na.fromfetch=true;if(ma){if(o[la].ufiinstanceid)k.updateStateField(o[la].ufiinstanceid,'locallycomposed',ia.id,true);na.ufiinstanceid=o[la].ufiinstanceid;p[la]=ia.id;o[ia.id]=o[la];delete o[la];i.didUpdateComment(la);}fa.setComment(ia.id,new h(na));i.didUpdateComment(ia.id);i.didUpdateFeedback(ja);});}function s(ga){for(var ha=0;ha<ga.length;ha++){var ia=ga[ha];switch(ia.actiontype){case j.UFIActionType.COMMENT_LIKE:t(ia);break;case j.UFIActionType.DELETE_COMMENT:x(ia);break;case j.UFIActionType.LIVE_DELETE_COMMENT:y(ia);break;case j.UFIActionType.UNDO_DELETE_COMMENT:z(ia);break;case j.UFIActionType.REMOVE_PREVIEW:aa(ia);break;case j.UFIActionType.COMMENT_SET_SPAM:ba(ia);break;case j.UFIActionType.CONFIRM_COMMENT_REMOVAL:ca(ia);break;case j.UFIActionType.TRANSLATE_COMMENT:v(ia);break;case j.UFIActionType.COMMENT_LIKECOUNT_UPDATE:u(ia);break;}}}function t(ga){var ha=fa.getComment(ga.commentid);if(ha){var ia={},ja=ga.clientid&&g.isExistingClientID(ga.clientid);if(!ja){ia.hasviewerliked=ga.viewerliked;ia.likecount=ga.likecount;}ia.likeconfirmhash=n(0,1024);ea(ga.commentid,ia);}}function u(ga){var ha=fa.getComment(ga.commentid);if(ha&&ga.hasviewerliked===ha.hasviewerliked){var ia={likecount:ga.likecount,likeconfirmhash:n(0,1024)};ea(ga.commentid,ia);}}function v(ga){var ha=ga.commentid,ia=fa.getComment(ga.commentid);if(ia)ea(ha,{translatedtext:ga.translatedtext});}function w(ga){var ha={reportLink:ga.reportLink,commenterIsFOF:ga.commenterIsFOF,userIsMinor:ga.userIsMinor};if(ga.undoData)ha.undoData=ga.undoData;return ha;}function x(ga){var ha=fa.getComment(ga.commentid);da(ha,j.UFIStatus.DELETED);}function y(ga){var ha=fa.getComment(ga.commentid);if(ha&&ha.status!==j.UFIStatus.DELETED)da(ha,j.UFIStatus.LIVE_DELETED);}function z(ga){var ha=fa.getComment(ga.commentid);da(ha,j.UFIStatus.PENDING_UNDO_DELETE);}function aa(ga){ea(ga.commentid,{attachment:null});}function ba(ga){var ha=fa.getComment(ga.commentid),ia=ga.shouldHideAsSpam?j.UFIStatus.SPAM_DISPLAY:null;da(ha,ia);}function ca(ga){ea(ga.commentid,w(ga));}function da(ga,ha){ea(ga.id,{priorstatus:ga.status,status:ha});}function ea(ga,ha){var ia=fa.getComment(ga)||new h({});fa.setComment(ga,h.set(ia,ha));i.didUpdateComment(ia.id);i.didUpdateFeedback(ia.ftentidentifier);}var fa={getComment:function(ga){if(ga===j.unavailableCommentKey)return null;return o[q(ga)];},setComment:function(ga,ha){l(ha instanceof h);o[q(ga)]=ha;},resetComments:function(ga){for(var ha in ga)delete o[q(ha)];}};i.subscribe('update-comments',function(ga,ha){if(ha.comments&&ha.comments.length)r(ha.comments,ha.payloadsource);});i.subscribe('update-actions',function(ga,ha){if(ha.actions&&ha.actions.length)s(ha.actions);});e.exports=fa;});
__d("UFIToplevelCommentList",["MercuryServerDispatcher","UFICentralUpdates","UFICommentList","UFIComments","UFIConstants","UFIFeedbackTargets","URI"],function(a,b,c,d,e,f){"use strict";var g=b('MercuryServerDispatcher'),h=b('UFICentralUpdates'),i=b('UFICommentList'),j=b('UFIComments'),k=b('UFIConstants'),l=b('UFIFeedbackTargets'),m=b('URI'),n={};for(var o in i)if(i.hasOwnProperty(o))q[o]=i[o];var p=i===null?null:i.prototype;q.prototype=Object.create(p);q.prototype.constructor=q;q.__superConstructor__=i;q.getCommentList=function(t,u){if(!n[t])n[t]={};if(!n[t][u]){var v=new q(t,u),w=q.getCommentListsForFeedbackTargetID(t);if(w.length)v.updateCommentCount(w[0].getCommentCount());n[t][u]=v;}return n[t][u];};q.getCommentListsForFeedbackTargetID=function(t){var u=[],v=n[t]||{};for(var w in v)u.push(v[w]);return u;};q.getCommentListForFeedbackTargetID_UNSAFE=function(t){var u=q.getCommentListsForFeedbackTargetID(t);return u.length?u[0]:null;};q.resetCommentListsForFeedbackTargetID=function(t){if(!n[t])return;var u={};for(var v in n[t]){var w=n[t][v],x=w.reset();for(var y in x){var z=x[y];u[z]=true;}}j.resetComments(u);};function q(t,u){i.call(this,t);this.orderingMode=u;}q.prototype.fetchComments=function(t,u,v){g.trySend('/ajax/ufi/comment_fetch.php',{ft_ent_identifier:this.feedbackTargetID,viewas:v,source:null,offset:t,length:u,orderingmode:this.orderingMode});};q.prototype.deferredCallback=function(t,u,v,w){l.getFeedbackTarget(this.feedbackTargetID,function(x){var y={},z=t,aa=t+u-1;for(var ba=0;ba<u;ba++){var ca=x.isranked?aa-ba:z+ba,da=j.getComment(w[ca]);if(da)y[t+ba]=da;}v(y);}.bind(this));};q.prototype.getOrderingMode=function(){return this.orderingMode;};q.prototype.buildCommentPermalink=function(t,u,v){if(!this.basePermalink)return null;var w=Math.floor((this.count-v-1)/k.defaultPageSize)*k.defaultPageSize;return (m(this.basePermalink).addQueryData({comment_id:u,offset:w,total_comments:this.count}).toString());};g.registerEndpoints({'/ajax/ufi/comment_fetch.php':{mode:g.IMMEDIATE}});function r(t){var u=j.getComment(t.commentid),v=u.id,w=u.ftentidentifier,x=u.parentcommentid;if(x)return;if(u.status!==k.UFIStatus.DELETED&&u.status!==k.UFIStatus.FAILED_ADD)q.getCommentListsForFeedbackTargetID(w).forEach(function(y){y.deleteComment(v);});}function s(t){var u=j.getComment(t.commentid),v=u.id,w=u.ftentidentifier,x=u.parentcommentid;if(x)return;if(u.status===k.UFIStatus.DELETED)q.getCommentListsForFeedbackTargetID(w).forEach(function(y){y.undoDeleteComment(v);});}h.subscribe('update-actions',function(t,u){if(u.actions&&u.actions.length)for(var v=0;v<u.actions.length;v++){var w=u.actions[v];switch(w.actiontype){case k.UFIActionType.DELETE_COMMENT:r(w);break;case k.UFIActionType.UNDO_DELETE_COMMENT:s(w);break;}}});h.subscribe('update-comment-lists',function(t,u){var v=u.commentlists;if(v&&v.comments&&Object.keys(v).length)for(var w in v.comments)for(var x in v.comments[w]){var y=v.comments[w][x];q.getCommentList(w,x).addCommentIDs(y.range.offset,y.range.length,y.values);}});h.subscribe('update-comments',function(t,u){if(u.comments&&u.comments.length)u.comments.forEach(function(v){if(v.parentcommentid)return;var w=v.ftentidentifier;q.getCommentListsForFeedbackTargetID(w).forEach(function(x){x.addComment(v.id,v.clientid,v.legacyid);});});});h.subscribe('update-feedback',function(t,u){if(u.feedbacktargets&&u.feedbacktargets.length)u.feedbacktargets.forEach(function(v){var w=v.entidentifier,x=v.defaultcommentorderingmode,y={};if(x)y[x]=true;if(v.orderingmodes)v.orderingmodes.forEach(function(aa){y[aa.value]=true;});for(var z in y)q.getCommentList(w,z).updateCommentCount(v.commentcount);});});e.exports=q;});
__d("UFIUserActions",["AsyncResponse","CLoggerX","ClientIDs","ImmutableObject","JSLogger","Nectar","UFICentralUpdates","UFIComments","UFIConstants","UFIFeedbackTargets","MercuryServerDispatcher","collectDataAttributes","copyProperties","tx"],function(a,b,c,d,e,f){var g=b('AsyncResponse'),h=b('CLoggerX'),i=b('ClientIDs'),j=b('ImmutableObject'),k=b('JSLogger'),l=b('Nectar'),m=b('UFICentralUpdates'),n=b('UFIComments'),o=b('UFIConstants'),p=b('UFIFeedbackTargets'),q=b('MercuryServerDispatcher'),r=b('collectDataAttributes'),s=b('copyProperties'),t=b('tx'),u=k.create('UFIUserActions'),v={BAN:'ban',UNDO_BAN:'undo_ban'},w={changeCommentLike:function(ia,ja,ka){var la=n.getComment(ia);if(la.hasviewerliked!=ja){var ma=x(ka.target),na=ja?1:-1,oa={commentid:ia,actiontype:o.UFIActionType.COMMENT_LIKE,viewerliked:ja,likecount:la.likecount+na};m.handleUpdate(o.UFIPayloadSourceType.USER_ACTION,{actions:[oa]});q.trySend('/ajax/ufi/comment_like.php',s({comment_id:ia,legacy_id:la.legacyid,like_action:ja,ft_ent_identifier:la.ftentidentifier,source:ka.source,client_id:i.getNewClientID()},ma));}},addComment:function(ia,ja,ka,la){p.getFeedbackTarget(ia,function(ma){var na=x(la.target),oa=i.getNewClientID();if(!ma.actorforpost)return;var pa={ftentidentifier:ia,body:{text:ja},author:ma.actorforpost,id:oa,islocal:true,ufiinstanceid:la.ufiinstanceid,likecount:0,hasviewerliked:false,parentcommentid:la.replyid,attachment:la.attachedsticker,photo_comment:la.attachedphoto,timestamp:{time:Date.now(),text:"a few seconds ago"}},qa={actiontype:o.UFIActionType.SUBSCRIBE_ACTION,actorid:ma.actorforpost,hasviewersubscribed:true,entidentifier:ia};m.handleUpdate(o.UFIPayloadSourceType.USER_ACTION,{comments:[pa],actions:[qa]});var ra=null;if(la.replyid)ra=(n.getComment(la.replyid)).fbid;var sa=h.getCLParamsForTarget(la.target,ra);q.trySend('/ajax/ufi/add_comment.php',s({ft_ent_identifier:ma.entidentifier,comment_text:ka,source:la.source,client_id:oa,reply_fbid:ra,parent_comment_id:la.replyid,timeline_log_data:la.timelinelogdata,rootid:la.rootid,clp:sa,attached_sticker_fbid:la.attachedsticker?la.attachedsticker.fbid:0,attached_photo_fbid:la.attachedphoto?la.attachedphoto.fbid:0,giftoccasion:la.giftoccasion},na));});},editComment:function(ia,ja,ka,la){var ma=x(la.target),na=n.getComment(ia);na=j.set(na,{status:o.UFIStatus.PENDING_EDIT,body:{text:ja},timestamp:{time:Date.now(),text:"a few seconds ago"},originalTimestamp:na.timestamp.time,editnux:null,attachment:la.attachedSticker,photo_comment:la.attachedPhoto});m.handleUpdate(o.UFIPayloadSourceType.USER_ACTION,{comments:[na]});q.trySend('/ajax/ufi/edit_comment.php',s({ft_ent_identifier:na.ftentidentifier,comment_text:ka,source:la.source,comment_id:na.id,parent_comment_id:na.parentcommentid,attached_sticker_fbid:la.attachedSticker?la.attachedSticker.fbid:0,attached_photo_fbid:la.attachedPhoto?la.attachedPhoto.fbid:0},ma));},translateComment:function(ia,ja){q.trySend('/ajax/ufi/translate_comment.php',{ft_ent_identifier:ia.ftentidentifier,comment_ids:[ia.id],source:ja.source});},setHideAsSpam:function(ia,ja,ka){var la=x(ka.target),ma=n.getComment(ia),na={commentid:ia,actiontype:o.UFIActionType.COMMENT_SET_SPAM,shouldHideAsSpam:ja};m.handleUpdate(o.UFIPayloadSourceType.USER_ACTION,{actions:[na]});q.trySend('/ajax/ufi/comment_spam.php',s({comment_id:ia,spam_action:ja,ft_ent_identifier:ma.ftentidentifier,source:ka.source},la));},removeComment:function(ia,ja){var ka=x(ja.target),la=n.getComment(ia),ma={actiontype:o.UFIActionType.DELETE_COMMENT,commentid:ia,oneclick:ja.oneclick};m.handleUpdate(o.UFIPayloadSourceType.USER_ACTION,{actions:[ma]});q.trySend('/ajax/ufi/delete_comment.php',s({comment_id:la.id,comment_legacyid:la.legacyid,ft_ent_identifier:la.ftentidentifier,one_click:ja.oneclick,source:ja.source,client_id:i.getNewClientID(),timeline_log_data:ja.timelinelogdata},ka));},undoRemoveComment:function(ia,ja,ka){var la=n.getComment(ia);if(!la.undoData){u.error('noundodata',{comment:ia});return;}var ma=x(ka.target),na={actiontype:o.UFIActionType.UNDO_DELETE_COMMENT,commentid:ia};m.handleUpdate(o.UFIPayloadSourceType.USER_ACTION,{actions:[na]});var oa=la.undoData;oa.page_admin=ja;var pa=s(ma,oa);q.trySend('/ajax/ufi/undo_delete_comment.php',pa);},banUser:function(ia,ja,ka,la){var ma=ka?v.BAN:v.UNDO_BAN;q.trySend('/ajax/ufi/ban_user.php',{page_id:ja,commenter_id:ia.author,action:ma,comment_id:ia.id,client_side:true});},changeLike:function(ia,ja,ka){p.getFeedbackTarget(ia,function(la){var ma=x(ka.target);if(la.hasviewerliked!==ja){var na=ja?1:-1,oa={actiontype:o.UFIActionType.LIKE_ACTION,actorid:la.actorforpost,hasviewerliked:ja,likecount:la.likecount+na,entidentifier:ia,likesentences:{current:la.likesentences.alternate,alternate:la.likesentences.current}};m.handleUpdate(o.UFIPayloadSourceType.USER_ACTION,{actions:[oa]});q.trySend('/ajax/ufi/like.php',s({like_action:ja,ft_ent_identifier:ia,source:ka.source,client_id:i.getNewClientID(),rootid:ka.rootid,giftoccasion:ka.giftoccasion},ma));}});},changeSubscribe:function(ia,ja,ka){p.getFeedbackTarget(ia,function(la){var ma=x(ka.target);if(la.hasviewersubscribed!==ja){var na={actiontype:o.UFIActionType.SUBSCRIBE_ACTION,actorid:la.actorforpost,hasviewersubscribed:ja,entidentifier:ia};m.handleUpdate(o.UFIPayloadSourceType.USER_ACTION,{actions:[na]});q.trySend('/ajax/ufi/subscribe.php',s({subscribe_action:ja,ft_ent_identifier:ia,source:ka.source,client_id:i.getNewClientID(),rootid:ka.rootid,comment_expand_mode:ka.commentexpandmode},ma));}});},fetchSpamComments:function(ia,ja,ka,la){q.trySend('/ajax/ufi/id_comment_fetch.php',{ft_ent_identifier:ia,viewas:la,comment_ids:ja,parent_comment_id:ka,source:null});},removePreview:function(ia,ja){var ka=x(ja.target),la={commentid:ia.id,actiontype:o.UFIActionType.REMOVE_PREVIEW};m.handleUpdate(o.UFIPayloadSourceType.USER_ACTION,{actions:[la]});q.trySend('/ajax/ufi/remove_preview.php',s({comment_id:ia.id,ft_ent_identifier:ia.ftentidentifier,source:ja.source},ka));}};function x(ia){if(!ia)return {ft:{}};var ja={ft:r(ia,['ft']).ft};l.addModuleData(ja,ia);return ja;}function y(ia){var ja=ia.request.data;g.defaultErrorHandler(ia);var ka=ja.client_id||ja.comment_id,la=n.getComment(ka),ma=(la.status===o.UFIStatus.PENDING_EDIT)?o.UFIStatus.FAILED_EDIT:o.UFIStatus.FAILED_ADD;la=j.setDeep(la,{status:ma,allowRetry:z(ia),body:{mentionstext:ja.comment_text,mentionsphoto:la.photo_comment}});m.handleUpdate(o.UFIPayloadSourceType.USER_ACTION,{comments:[la]});}function z(ia){var ja=ia.getError();if(ja===1404102)return false;if(ia.silentError)return true;if(ja===1357012||ja===1357006)return false;return true;}function aa(ia){var ja=ia.request.data,ka=ja.comment_id,la=n.getComment(ka);la=j.set(la,{status:la.priorstatus||null,priorstatus:undefined});m.handleUpdate(o.UFIPayloadSourceType.USER_ACTION,{comments:[la]});}function ba(ia){var ja=ia.request.data,ka=ja.comment_id,la=n.getComment(ka);if(ja.like_action===la.hasviewerliked){var ma=la.hasviewerliked?-1:1,na={commentid:ka,actiontype:o.UFIActionType.COMMENT_LIKE,viewerliked:!la.hasviewerliked,likecount:la.likecount+ma};m.handleUpdate(o.UFIPayloadSourceType.USER_ACTION,{actions:[na]});}g.defaultErrorHandler(ia);}function ca(ia){var ja=ia.request.data,ka=ja.ft_ent_identifier;p.getFeedbackTarget(ka,function(la){if(la.hasviewerliked===ja.like_action){var ma=la.hasviewerliked?-1:1,na={actiontype:o.UFIActionType.LIKE_ACTION,actorid:la.actorforpost,hasviewerliked:!la.hasviewerliked,likecount:la.likecount+ma,entidentifier:ka,likesentences:{current:la.likesentences.alternate,alternate:la.likesentences.current}};m.handleUpdate(o.UFIPayloadSourceType.USER_ACTION,{actions:[na]});}});g.defaultErrorHandler(ia);}function da(ia){var ja=ia.request.data,ka=ja.ft_ent_identifier;p.getFeedbackTarget(ka,function(la){if(la.hasviewersubscribed===ja.subscribe_action){var ma={actiontype:o.UFIActionType.SUBSCRIBE_ACTION,actorid:la.actorforpost,hasviewersubscribed:!la.hasviewersubscribed,entidentifier:ka};m.handleUpdate(o.UFIPayloadSourceType.USER_ACTION,{actions:[ma]});}});g.defaultErrorHandler(ia);}q.registerEndpoints({'/ajax/ufi/comment_like.php':{mode:q.BATCH_CONDITIONAL,error_handler:ba,batch_if:ea,batch_function:ha},'/ajax/ufi/comment_spam.php':{mode:q.IMMEDIATE,error_handler:aa},'/ajax/ufi/add_comment.php':{mode:q.IMMEDIATE,error_handler:y},'/ajax/ufi/delete_comment.php':{mode:q.IMMEDIATE,error_handler:aa},'/ajax/ufi/undo_delete_comment.php':{mode:q.IMMEDIATE,error_handler:aa},'/ajax/ufi/ban_user.php':{mode:q.IMMEDIATE},'/ajax/ufi/edit_comment.php':{mode:q.IMMEDIATE,error_handler:y},'/ajax/ufi/like.php':{mode:q.BATCH_CONDITIONAL,error_handler:ca,batch_if:fa,batch_function:ha},'/ajax/ufi/subscribe.php':{mode:q.BATCH_CONDITIONAL,error_handler:da,batch_if:ga,batch_function:ha},'/ajax/ufi/id_comment_fetch.php':{mode:q.IMMEDIATE},'/ajax/ufi/remove_preview.php':{mode:q.IMMEDIATE},'/ajax/ufi/translate_comment.php':{mode:q.IMMEDIATE}});function ea(ia,ja){return ia&&ia.ft_ent_identifier==ja.ft_ent_identifier&&ia.comment_id==ja.comment_id;}function fa(ia,ja){return ia&&ia.ft_ent_identifier==ja.ft_ent_identifier;}function ga(ia,ja){return ia&&ia.ft_ent_identifier==ja.ft_ent_identifier;}function ha(ia,ja){return ja;}e.exports=w;});
__d("UFIUIEvents",[],function(a,b,c,d,e,f){var g='UFIUIEvents/ufiActionLinkLike',h='UFIUIEvents/ufiActionLinkUnlike',i={UFIActionLinkLike:g,UFIActionLinkUnlike:h};e.exports=i;});
__d("UFIActionLinkController",["Arbiter","ClickTTIIdentifiers","CSS","DOMQuery","Parent","React","TrackingNodes","UFIBlingBox.react","UFICentralUpdates","UFIConstants","UFIFeedbackTargets","UFILikeLink.react","UFISubscribeLink.react","UFITimelineBlingBox.react","UFIToplevelCommentList","UFIUserActions","UFIUIEvents","copyProperties"],function(a,b,c,d,e,f){var g=b('Arbiter'),h=b('ClickTTIIdentifiers'),i=b('CSS'),j=b('DOMQuery'),k=b('Parent'),l=b('React'),m=b('TrackingNodes'),n=b('UFIBlingBox.react'),o=b('UFICentralUpdates'),p=b('UFIConstants'),q=b('UFIFeedbackTargets'),r=b('UFILikeLink.react'),s=b('UFISubscribeLink.react'),t=b('UFITimelineBlingBox.react'),u=b('UFIToplevelCommentList'),v=b('UFIUserActions'),w=b('UFIUIEvents'),x=b('copyProperties');function y(aa,ba,ca){if(this._root)throw new Error('UFIActionLinkController attempted to initialize when a root was'+' already present');var da=j.scry(aa,ba)[0];if(da){var ea=document.createElement('span');da.parentNode.replaceChild(ea,da);ea.appendChild(da);if(typeof ca==="function")ca(ea);}else var fa=g.subscribe('PhotoSnowlift.DATA_CHANGE',function(){g.unsubscribe(fa);y(aa,ba,ca);},g.SUBSCRIBE_NEW);}var z=function(aa,ba,ca){this._id=ba.ftentidentifier;this._ftFBID=ca.targetfbid;this._source=ba.source;this._contextArgs=ba;this._ufiRoot=aa;this._isOnTimeline=this._isRenderingOnTimeline();if(this._isOnTimeline){this._attemptInitializeTimelineBling();}else this._attemptInitializeBling();if(ca.viewercanlike)this._attemptInitializeLike();if(ca.viewercansubscribetopost)this._attemptInitializeSubscribe();o.subscribe('feedback-updated',function(da,ea){var fa=ea.updates;if(this._id in fa)this.render();}.bind(this));o.subscribe('feedback-id-changed',function(da,ea){var fa=ea.updates;if(this._id in fa)this._id=fa[this._id];}.bind(this));};x(z.prototype,{_attemptInitializeBling:function(){y(this._ufiRoot,'^form .uiBlingBox',function(aa){this._blingRoot=aa;if(this._dataReady)this._renderBling();}.bind(this));},_attemptInitializeTimelineBling:function(){if(this._root)throw new Error('UFIActionLinkController attempted to initialize when a root was'+' already present');var aa=j.scry(this._ufiRoot,'^form .fbTimelineFeedbackActions span')[0];if(aa){i.addClass(aa,"UFIBlingBoxTimeline");var ba=j.scry(aa,'.fbTimelineFeedbackLikes')[0];this._enableShowLikes=ba?true:false;var ca=j.scry(aa,'.fbTimelineFeedbackComments')[0];this._enableShowComments=ca?true:false;}this._blingTimelineRoot=aa;if(this._dataReady)this._renderTimelineBling();},_attemptInitializeLike:function(){y(this._ufiRoot,'^form .like_link',function(aa){this._likeRoot=aa;if(this._dataReady)this._renderLike();}.bind(this));},_attemptInitializeSubscribe:function(){y(this._ufiRoot,'^form .unsub_link',function(aa){this._subscribeRoot=aa;if(this._dataReady)this._renderSubscribe();}.bind(this));},render:function(){this._dataReady=true;if(this._isOnTimeline){this._renderTimelineBling();}else this._renderBling();this._renderLike();this._renderSubscribe();},_renderBling:function(){if(this._blingRoot)q.getFeedbackTarget(this._id,function(aa){var ba=function(event){if(this._contextArgs.blingtogglescomments){var fa=k.byTag(event.target,"form");i.toggleClass(fa,"collapsed_comments");i.toggleClass(fa,"hidden_add_comment");}event.preventDefault();}.bind(this),ca=m.getTrackingInfo(m.types.BLINGBOX),da=u.getCommentListForFeedbackTargetID_UNSAFE(this._id).getDisplayedCommentCount(),ea=n({likes:aa.likecount,comments:da,reshares:aa.sharecount,permalink:aa.permalink,contextArgs:this._contextArgs,onClick:ba,'data-ft':ca});this._blingBox=l.renderComponent(ea,this._blingRoot);}.bind(this));},_renderTimelineBling:function(){if(this._blingTimelineRoot)q.getFeedbackTarget(this._id,function(aa){var ba=m.getTrackingInfo(m.types.BLINGBOX),ca=h.getUserActionID(h.types.TIMELINE_SEE_LIKERS),da=function(event){var ga=k.byTag(event.target,"form");i.removeClass(ga,"collapsed_comments");var ha=j.scry(ga,'a.UFIPagerLink');if(ha.length)ha[0].click();event.preventDefault();}.bind(this),ea=u.getCommentListForFeedbackTargetID_UNSAFE(this._id).getDisplayedCommentCount(),fa=t({comments:ea,commentOnClick:da,contextArgs:this._contextArgs,'data-ft':ba,'data-gt':ca,enableShowComments:this._enableShowComments,enableShowLikes:this._enableShowLikes,feedbackFBID:this._ftFBID,likes:aa.likecount,reshares:aa.sharecount});l.renderComponent(fa,this._blingTimelineRoot);}.bind(this));},_renderLike:function(){if(this._likeRoot)q.getFeedbackTarget(this._id,function(aa){var ba=!aa.hasviewerliked,ca=function(event){var ea=ba?w.UFIActionLinkLike:w.UFIActionLinkUnlike;g.inform(ea,{ft_id:this._id,like_action:ba,target:event.target});v.changeLike(this._id,ba,{source:this._source,target:event.target,rootid:this._contextArgs.rootid,giftoccasion:this._contextArgs.giftoccasion});event.preventDefault();}.bind(this),da=r({onClick:ca,likeAction:ba});this._likeLink=l.renderComponent(da,this._likeRoot);}.bind(this));},_renderSubscribe:function(){if(this._subscribeRoot)q.getFeedbackTarget(this._id,function(aa){var ba=!aa.hasviewersubscribed,ca=function(event){v.changeSubscribe(this._id,ba,{source:this._source,target:event.target,rootid:this._contextArgs.rootid,commentexpandmode:aa.commentexpandmode});event.preventDefault();}.bind(this),da=s({onClick:ca,subscribeAction:ba,useNotifyLanguage:this._contextArgs.usenotifylanguage});this._subscribeLink=l.renderComponent(da,this._subscribeRoot);}.bind(this));},_isRenderingOnTimeline:function(){if(this._source===p.UFIFeedbackSourceType.PROFILE){var aa=j.scry(this._ufiRoot,'^form .fbTimelineFeedbackActions span');return (aa.length>0);}return false;}});e.exports=z;});
__d("MentionsInputUtils",[],function(a,b,c,d,e,f){var g={generateDataFromTextWithEntities:function(h){var i=h.text,j=[];(h.ranges||[]).forEach(function(l){var m=l.entities[0];if(!m.external)j.push({uid:m.id,text:i.substr(l.offset,l.length),offset:l.offset,length:l.length,weakreference:!!m.weakreference});});var k={value:i,mentions:j};return k;}};e.exports=g;});
__d("ClipboardPhotoUploader",["ArbiterMixin","AsyncRequest","mixin"],function(a,b,c,d,e,f){var g=b('ArbiterMixin'),h=b('AsyncRequest'),i=b('mixin'),j=i(g);for(var k in j)if(j.hasOwnProperty(k))m[k]=j[k];var l=j===null?null:j.prototype;m.prototype=Object.create(l);m.prototype.constructor=m;m.__superConstructor__=j;function m(n,o){"use strict";this.uploadURIString=n;this.data=o;}m.prototype.handlePaste=function(event){"use strict";if(!event.clipboardData)return;var n=event.clipboardData.items;if(!n)return;for(var o=0;o<n.length;++o){var p=n[o];if(p.kind==='file'&&p.type.indexOf('image/')!==-1){var q=new FormData();q.append('pasted_file',p.getAsFile());var r=new h();r.setURI(this.uploadURIString).setData(this.data).setRawData(q).setHandler(function(s){this.inform('upload_success',s);}.bind(this)).setErrorHandler(function(s){this.inform('upload_error',s);}.bind(this));this.inform('upload_start');r.send();break;}}};e.exports=m;});
__d("DOMContainer.react",["React","invariant","isNode"],function(a,b,c,d,e,f){var g=b('React'),h=b('invariant'),i=b('isNode'),j=g.createClass({displayName:'DOMContainer',getDOMChild:function(){var k=this.props.children;h(i(k));return k;},shouldComponentUpdate:function(k,l){return k.children!==this.props.children;},componentDidMount:function(){this.getDOMNode().appendChild(this.getDOMChild());},componentDidUpdate:function(){var k=this.getDOMNode();while(k.lastChild)k.removeChild(k.lastChild);k.appendChild(this.getDOMChild());},render:function(){return g.DOM.span(null);}});e.exports=j;});
__d("LegacyMentionsInput.react",["PlaceholderListener","Bootloader","CLogConfig","TypeaheadMetricsConfig","Event","Keys","React","ReactPropTypes","cx"],function(a,b,c,d,e,f){b('PlaceholderListener');var g=b('Bootloader'),h=b('CLogConfig'),i=b('TypeaheadMetricsConfig'),j=b('Event'),k=b('Keys'),l=b('React'),m=b('ReactPropTypes'),n=b('cx'),o=l.createClass({displayName:'ReactLegacyMentionsInput',propTypes:{initialData:m.object,placeholder:m.string,datasource:m.object,ref:m.string,viewOptionsTypeObjects:m.object,viewOptionsTypeObjectsOrder:m.array,hashtags:m.bool,onEnterSubmit:m.func,onFocus:m.func,onBlur:m.func,onTypingStateChange:m.func,onPaste:m.func},componentDidMount:function(){this.props.initialData&&this._initializeTextarea(this.getDOMNode());},hasEnteredText:function(){return !!(this._mentionsInput&&this._mentionsInput.getValue().trim());},_handleKeydown:function(event){var p=event.nativeEvent,q=this.props.onEnterSubmit,r=j.getKeyCode(p)==k.RETURN&&!j.$E(p).getModifiers().any,s=this._mentionsInput&&this._mentionsInput.getTypeahead().getView().getSelection();if(q&&r&&!s){var t=event.target,u=t.value&&t.value.trim(),v={visibleValue:u,encodedValue:u};if(this._mentionsInput)v.encodedValue=this._mentionsInput.getRawValue().trim();var w=q(v,event);if(w&&this._mentionsInput){this._mentionsInput.reset();event.preventDefault();}}},_handleFocus:function(){this.props.onFocus&&this.props.onFocus();this._initializeTextarea(this.refs.root.getDOMNode());},_handleBlur:function(){this.props.onBlur&&this.props.onBlur();},_initializeTextarea:function(p){if(this._mentionsInput||this._bootloadingMentions)return;this._bootloadingMentions=true;g.loadModules(["CompactTypeaheadRenderer","ContextualTypeaheadView","CLoggerX","InputSelection","MentionsInput","TextAreaControl","Typeahead","TypeaheadAreaCore","TypeaheadBestName","TypeaheadHoistFriends","TypeaheadMetrics","TypeaheadMetricsX","TypingDetector","UFIComments"],function(q,r,s,t,u,v,w,x,y,z,aa,ba,ca,da){var ea=this.refs.textarea.getDOMNode();new v(ea);if(h.gkResults){var fa=da.getComment(this.props.replyCommentID),ga=fa?fa.fbid:null;s.trackMentionsInput(ea,ga);}if(this.props.onTypingStateChange){var ha=new ca(ea);ha.init();ha.subscribe('change',this.props.onTypingStateChange);}var ia={autoSelect:true,renderer:q,causalElement:ea};if(this.props.viewOptionsTypeObjects)ia.typeObjects=this.props.viewOptionsTypeObjects;if(this.props.viewOptionsTypeObjectsOrder)ia.typeObjectsOrder=this.props.viewOptionsTypeObjectsOrder;var ja=new w(this.props.datasource,{ctor:r,options:ia},{ctor:x},this.refs.typeahead.getDOMNode()),ka=[y,z];if(i.gkResults){var la=new ba({extraData:{event_name:'mention_metric_x'}});la.init(ja);}var ma=new aa({extraData:{event_name:'mentions'}});w.initNow(ja,ka,ma);this._mentionsInput=new u(p,ja,ea,{hashtags:this.props.hashtags});this._mentionsInput.init({},this.props.initialData);if(this.props.initialData)t.set(ea,ea.value.length);if(this.props.onPaste)j.listen(ea,'paste',this.props.onPaste);this._bootloadingMentions=false;}.bind(this));},focus:function(){try{this.refs.textarea.getDOMNode().focus();}catch(p){}},render:function(){var p=(("textInput")+(' '+"mentionsTextarea")+(' '+"uiTextareaAutogrow")+(' '+"uiTextareaNoResize")+(' '+"UFIAddCommentInput")+(' '+"DOMControl_placeholder"));return (l.DOM.div({ref:"root",className:"uiMentionsInput textBoxContainer ReactLegacyMentionsInput"},l.DOM.div({className:"highlighter"},l.DOM.div(null,l.DOM.span({className:"highlighterContent hidden_elem"}))),l.DOM.div({ref:"typeahead",className:"uiTypeahead mentionsTypeahead"},l.DOM.div({className:"wrap"},l.DOM.input({type:"hidden",autoComplete:"off",className:"hiddenInput"}),l.DOM.div({className:"innerWrap"},l.DOM.textarea({ref:"textarea",name:"add_comment_text",className:p,title:this.props.placeholder,placeholder:this.props.placeholder,onFocus:this._handleFocus,onBlur:this._handleBlur,onKeyDown:this._handleKeydown,defaultValue:this.props.placeholder})))),l.DOM.input({type:"hidden",autoComplete:"off",className:"mentionsHidden",defaultValue:""})));}});e.exports=o;});
__d("UFIClassNames",["cx"],function(a,b,c,d,e,f){var g=b('cx');e.exports={ACTOR_IMAGE:"img UFIActorImage _54ru",ROW:"UFIRow",UNSEEN_ITEM:"UFIUnseenItem"};});
__d("UFIImageBlock.react",["ImageBlock.react","React","cx"],function(a,b,c,d,e,f){var g=b('ImageBlock.react'),h=b('React'),i=b('cx'),j=h.createClass({displayName:'UFIImageBlock',render:function(){return this.transferPropsTo(g({imageClassName:"UFIImageBlockImage",contentClassName:"UFIImageBlockContent"},this.props.children));}});e.exports=j;});
__d("UFIStickerButton.react",["Bootloader","React","ReactLayeredComponentMixin","cx","fbt"],function(a,b,c,d,e,f){var g=b('Bootloader'),h=b('React'),i=b('ReactLayeredComponentMixin'),j=b('cx'),k=b('fbt'),l=h.createClass({displayName:'UFIStickerButton',mixins:[i],getInitialState:function(){return {renderFlyout:null,flyoutShown:false};},render:function(){var m="Attach a Sticker";return (h.DOM.div({'aria-label':m,className:"UFICommentStickerButton",'data-hover':"tooltip",'data-tooltip-alignh':"center",onClick:this._onLinkClicked,ref:"link"},h.DOM.div({className:"UFICommentStickerIcon"})));},renderLayers:function(){return !this.state.renderFlyout?{}:this.state.renderFlyout();},_onLinkClicked:function(){if(this.state.renderFlyout!==null){this.setState({flyoutShown:!this.state.flyoutShown});return;}g.loadModules(["XUIContextualDialog.react","LayerHideOnBlur","StickersFlyout.react"],function(m,n,o){this.setState({flyoutShown:true,renderFlyout:function(){return {contextualDialog:m({alignment:"right",behaviors:{LayerHideOnBlur:n},className:"_5e-r",contextRef:"link",onToggle:this._onFlyoutToggled,position:"above",shown:this.state.flyoutShown,width:256},o({onStickerSelect:this._onStickerSelected}))};}.bind(this)});}.bind(this));},_onFlyoutToggled:function(m){this.setState({flyoutShown:m});},_onStickerSelected:function(m){this.props.onStickerSelected(m);}});e.exports=l;});
__d("UFIAddComment.react",["AsyncRequest","Bootloader","ClipboardPhotoUploader","CloseButton.react","DOMContainer.react","Event","Focus","HTML","Keys","LitestandStoryInsertionStatus","LoadingIndicator.react","React","LegacyMentionsInput.react","Run","Sticker.react","TrackingNodes","UFIClassNames","UFIImageBlock.react","UFIStickerButton.react","cx","fbt","joinClasses","tx"],function(a,b,c,d,e,f){var g=b('AsyncRequest'),h=b('Bootloader'),i=b('ClipboardPhotoUploader'),j=b('CloseButton.react'),k=b('DOMContainer.react'),l=b('Event'),m=b('Focus'),n=b('HTML'),o=b('Keys'),p=b('LitestandStoryInsertionStatus'),q=b('LoadingIndicator.react'),r=b('React'),s=b('LegacyMentionsInput.react'),t=b('Run'),u=b('Sticker.react'),v=b('TrackingNodes'),w=b('UFIClassNames'),x=b('UFIImageBlock.react'),y=b('UFIStickerButton.react'),z=b('cx'),aa=b('fbt'),ba=b('joinClasses'),ca=b('tx'),da="Write a comment...",ea="Write a reply...",fa="fcg fss UFICommentTip",ga=19,ha='/ajax/ufi/upload/',ia=80,ja='/ajax/ufi/sticker_preview/',ka=r.createClass({displayName:'UFIAddComment',getInitialState:function(){if(this.props.attachedPhoto)this.props.contextArgs.attachedphoto=this.props.attachedPhoto;if(this.props.attachedSticker)this.props.contextArgs.attachedsticker=this.props.attachedSticker;return {attachedPhoto:this.props.attachedPhoto?this.props.attachedPhoto:null,attachedSticker:this.props.attachedSticker?this.props.attachedSticker:null,isCommenting:false,isLoadingPhoto:false};},_onKeyDown:function(event){if(this.props.isEditing&&l.getKeyCode(event.nativeEvent)===o.ESC)this.props.onCancel();if(this.isMounted()&&!this._isOnBeforeUnloadListenerAdded){t.onBeforeUnload(this._handleUnsavedChanges);this._isOnBeforeUnloadListenerAdded=true;}},_handleUnsavedChanges:function(){var la=a.PageTransitions;if(la){var ma=la.getNextURI(),na=la.getMostRecentURI();if(ma.getQueryData().hasOwnProperty('theater')||na.getQueryData().hasOwnProperty('theater'))return;}if(this.refs&&this.refs.mentionsinput&&this.refs.mentionsinput.hasEnteredText())return "You haven't finished your comment yet. Do you want to leave without finishing?";},_blur:function(){if(this.refs.mentionsinput&&this.refs.mentionsinput.hasEnteredText())return;this.setState({isCommenting:false});},_onPaste:function(event){var la=new i(ha,this._getPhotoUploadData());this._cancelCurrentSubscriptions();this._subscriptions=[la.subscribe('upload_start',this._prepareForAttachedPhotoPreview),la.subscribe('upload_error',this._onRemoveAttachedPhotoPreviewClicked),la.subscribe('upload_success',function(ma,na){this._onPhotoUploadComplete(na);}.bind(this))];la.handlePaste(event);},_onEnterSubmit:function(la,event){var ma=this.state.attachedPhoto||this.state.attachedSticker,na=this.props.isEditing||ma;if(this.state.isLoadingPhoto){return false;}else if(!la.encodedValue.trim()&&!na)return false;if(ma){this.setState({isLoadingPhoto:false,attachedPhoto:null,attachedSticker:null});la.attachedPhoto=this.props.contextArgs.attachedphoto;la.attachedSticker=this.props.contextArgs.attachedsticker;}else{la.attachedPhoto=null;la.attachedSticker=null;}this.props.onCommentSubmit(la,event);return true;},_cancelCurrentSubscriptions:function(){if(this._subscriptions)this._subscriptions.forEach(function(la){la.unsubscribe();});},componentWillMount:function(){this._isOnBeforeUnloadListenerAdded=false;this._storyInsertionBlocker=p.registerBlocker(function(){return this.state.isCommenting;}.bind(this));},componentWillUnmount:function(){this._cancelCurrentSubscriptions();this._storyInsertionBlocker&&this._storyInsertionBlocker.unsubscribe();this._storyInsertionBlocker=null;},focus:function(){if(this.refs&&this.refs.mentionsinput)this.refs.mentionsinput.focus();},render:function(){var la=!this.props.contextArgs.collapseaddcomment||this.state.isCommenting,ma=null;if(this.props.isEditing){ma=r.DOM.span({className:fa},"Press Esc to cancel.");}else if(this.props.showSendOnEnterTip){ma=r.DOM.span({className:fa},"Press Enter to post.");}else if(this.props.subtitle)ma=r.DOM.span({className:fa},this.props.subtitle);var na=null,oa=null,pa=this.state.attachedPhoto||this.state.attachedSticker,qa=null;if(this.props.allowStickerAttachments&&!pa)oa=y({onStickerSelected:this._prepareForAttachedStickerPreview});if(this.props.allowPhotoAttachments){qa=this._onPaste;var ra="Choose a file to upload",sa=r.DOM.input({ref:"PhotoInput",accept:"image/*",className:"_n",name:"file[]",type:"file",multiple:false,title:ra,'aria-label':ra}),ta=pa?"UFICommentPhotoAttachedIcon":"UFICommentPhotoIcon",ua="UFIPhotoAttachLinkWrapper _m";na=r.DOM.div({ref:"PhotoInputContainer",className:ua,'data-hover':"tooltip",'data-tooltip-alignh':"center",'aria-label':"Attach a Photo"},r.DOM.i({ref:"PhotoInputControl",className:ta}),sa);}var va=v.getTrackingInfo(v.types.ADD_COMMENT_BOX),wa=ba(w.ACTOR_IMAGE,((!la?"hidden_elem":''))),xa=r.DOM.div({className:"UFIReplyActorPhotoWrapper",onClick:this.focus},r.DOM.img({className:wa,src:this.props.viewerActor.thumbSrc,alt:this.props.viewerActor.name})),ya=ba(w.ROW,((this.props.hide?"noDisplay":'')+(' '+"UFIAddComment")+(this.props.allowPhotoAttachments?' '+"UFIAddCommentWithPhotoAttacher":'')+(this.props.withoutSeparator?' '+"UFIAddCommentWithoutSeparator":'')+(this.props.isFirstComponent?' '+"UFIFirstComponent":'')+(this.props.isLastComponent?' '+"UFILastComponent":''))),za;if(!!this.props.replyCommentID){za=ea;}else if(this.props.isQAndA){za="Ask a question...";}else za=da;var ab=this.props.contextArgs.entstream?this._blur:null,bb=this.props.contextArgs.viewoptionstypeobjects,cb=this.props.contextArgs.viewoptionstypeobjectsorder,db=null;if(this.state.attachedSticker){var eb=this._getScaledDimensions(pa.metadata.height,pa.metadata.width);db=u({animationTrigger:"load_and_hover",frameCount:pa.metadata.frameCount,framesPerCol:pa.metadata.framesPerCol,framesPerRow:pa.metadata.framesPerRow,spriteURI:pa.metadata.sprite_uri,sourceHeight:eb.height,sourceURI:pa.metadata.source_uri,sourceWidth:eb.width});}else if(this.state.attachedPhoto){var fb=pa.markupPreview;if(n.isHTML(fb.markup))fb=n.replaceJSONWrapper(fb.markup).getRootNode();db=k(null,fb);ma=null;}else if(this.state.isLoadingPhoto)db=q({color:"white",className:"UFICommentPhotoAttachedPreviewLoadingIndicator",size:"medium"});var gb,hb=this.state.attachedPhoto?this._onRemoveAttachedPhotoPreviewClicked:this._onRemoveAttachedStickerPreviewClicked;if(db!=null){var ib=null;if(this.state.attachedSticker){ib="Remove Sticker";}else if(this.state.attachedPhoto)ib="Remove Photo";gb=r.DOM.div({className:"UFICommentPhotoAttachedPreview pas"},db,j({tooltip:ib,onClick:hb}));}var jb=this.props.allowStickerAttachments?ba("UFIMentionsInputWrap","UFIStickersEnabledInput"):"UFIMentionsInputWrap",kb=this.props.contextArgs.mentionsinput||s;return (r.DOM.li({className:ya,onKeyDown:this._onKeyDown,'data-ft':va},x({className:jb},xa,r.DOM.div({className:"UFICommentContainer"},r.DOM.div({className:"UFIInputContainer"},kb({replyCommentID:this.props.replyCommentID,initialData:this.props.initialData,placeholder:za,datasource:this.props.mentionsDataSource,ref:"mentionsinput",viewOptionsTypeObjects:bb,viewOptionsTypeObjectsOrder:cb,hashtags:this.props.contextArgs.sht,onEnterSubmit:this._onEnterSubmit,onFocus:this.setState.bind(this,{isCommenting:true},null),onBlur:ab,onTypingStateChange:this.props.onTypingStateChange,onPaste:qa}),r.DOM.div({className:"UFICommentAttachmentButtons clearfix"},na,oa)),gb,ma))));},componentDidUpdate:function(la,ma,na){if(!ma.attachedPhoto&&this.state.attachedPhoto||!ma.attachedSticker&&this.state.attachedSticker)this.refs.mentionsinput.focus();},componentDidMount:function(){if(!this.props.allowPhotoAttachments)return;var la=this.refs.PhotoInputContainer.getDOMNode(),ma=this.refs.PhotoInputControl.getDOMNode(),na=this.refs.PhotoInput.getDOMNode(),oa=l.listen(la,'click',function(event){h.loadModules(["FileInput","FileInputUploader","Input"],function(pa,qa,ra){var sa=new pa(la,ma,na),ta=new qa(undefined,la).setURI(ha).setData(this._getPhotoUploadData());sa.subscribe('change',function(event){if(sa.getValue()){this._prepareForAttachedPhotoPreview();ta.setInput(sa.getInput()).send();}}.bind(this));ta.subscribe('success',function(ua,va){sa.clear();this._onPhotoUploadComplete(va.response);}.bind(this));ta.subscribe('failure',function(ua,va){sa.clear();this._onPhotoUploadComplete(va.response);}.bind(this));m.setWithoutOutline(ma);}.bind(this));oa.remove();}.bind(this));},_getScaledDimensions:function(la,ma){var na,oa,pa;if(ma>la){pa=ia/ma;na=la*pa;oa=ma*pa;}else{pa=ia/la;na=la*pa;oa=ma*pa;}return {height:Math.round(na),width:Math.round(oa)};},_getPhotoUploadData:function(){return {profile_id:this.props.viewerActor.id,target_id:this.props.targetID,source:ga};},_onPhotoUploadComplete:function(la){if(!this.state.isLoadingPhoto)return;var ma=la.getPayload();if(ma&&ma.fbid){this.props.contextArgs.attachedphoto=ma;this.setState({attachedPhoto:ma,isLoadingPhoto:false});}else{h.loadModules(["Dialog"],function(na){var oa="Upload Failed",pa="There was a problem uploading the image file.";new na().setTitle(oa).setBody(pa).setButtons(na.OK).show();});this._onRemoveAttachedPhotoPreviewClicked(null);}},_onRemoveAttachedPhotoPreviewClicked:function(event){this.props.contextArgs.attachedphoto=null;this.setState({attachedPhoto:null,isLoadingPhoto:false});},_prepareForAttachedPhotoPreview:function(){this.props.contextArgs.attachedphoto=null;this.setState({attachedPhoto:null,isLoadingPhoto:true});},_onStickerUploadComplete:function(la){if(!this.state.isLoadingPhoto)return;var ma=la.getPayload();if(ma&&ma.fbid){this.props.contextArgs.attachedsticker=ma;this.setState({attachedSticker:ma,isLoadingPhoto:false});}else{h.loadModules(["Dialog"],function(na){var oa="Sticker Failed",pa="There was a problem attaching the sticker.";new na().setTitle(oa).setBody(pa).setButtons(na.OK).show();});this._onRemoveAttachedStickerPreviewClicked(null);}},_onRemoveAttachedStickerPreviewClicked:function(event){this.props.contextArgs.attachedsticker=null;this.setState({attachedSticker:null,isLoadingPhoto:false});},_prepareForAttachedStickerPreview:function(la){this.props.contextArgs.attachedsticker=null;this.setState({attachedSticker:null,isLoadingPhoto:true});new g(ja).setData({sticker_id:la}).setErrorHandler(this._onRemoveAttachedStickerPreviewClicked).setHandler(this._onStickerUploadComplete).send();}});e.exports=ka;});
__d("UFIAddCommentController",["Arbiter","copyProperties","MentionsInputUtils","Parent","UFIAddComment.react","React","ShortProfiles","UFICentralUpdates","UFIComments","UFIFeedbackTargets","UFIInstanceState","UFIUserActions"],function(a,b,c,d,e,f){var g=b('Arbiter'),h=b('copyProperties'),i=b('MentionsInputUtils'),j=b('Parent'),k=b('UFIAddComment.react'),l=b('React'),m=b('ShortProfiles'),n=b('UFICentralUpdates'),o=b('UFIComments'),p=b('UFIFeedbackTargets'),q=b('UFIInstanceState'),r=b('UFIUserActions');function s(t,u,v,w){this.id=u;this._ufiInstanceID=w.instanceid;this._contextArgs=w;this._replyCommentID=v;if(t){this.root=t;if(!this._contextArgs.rootid)this._contextArgs.rootid=t.id;this.render();n.subscribe('instance-updated',function(x,y){var z=y.updates;if(this._ufiInstanceID in z)this.render();}.bind(this));}n.subscribe('feedback-id-changed',function(x,y){var z=y.updates;if(this.id in z)this.id=z[this.id];}.bind(this));}h(s.prototype,{_onCommentSubmit:function(t,event){r.addComment(this.id,t.visibleValue,t.encodedValue,{source:this._contextArgs.source,ufiinstanceid:this._ufiInstanceID,target:event.target,replyid:this._replyCommentID,timelinelogdata:this._contextArgs.timelinelogdata,rootid:this._contextArgs.rootid,attachedphoto:this._contextArgs.attachedphoto,attachedsticker:this._contextArgs.attachedsticker,giftoccasion:this._contextArgs.giftoccasion});this._contextArgs.attachedphoto=null;this._contextArgs.attachedsticker=null;p.getFeedbackTarget(this.id,function(u){var v=j.byTag(this.root,'form');if(v)g.inform('ufi/comment',{form:v,isranked:u.isranked});}.bind(this));return false;},_onTypingStateChange:function(t,u){},renderAddComment:function(t,u,v,w,x,y,z,aa,ba,ca){var da=this._contextArgs.logtyping?this._onTypingStateChange.bind(this):null,ea=null,fa=q.getKeyForInstance(this._ufiInstanceID,'isediting')&&!this._replyCommentID;return (k({hide:fa,replyCommentID:this._replyCommentID,viewerActor:t,targetID:u,initialData:ea,ref:x,withoutSeparator:y,onCommentSubmit:this._onCommentSubmit.bind(this),mentionsDataSource:v,onTypingStateChange:da,showSendOnEnterTip:w,allowPhotoAttachments:aa,allowStickerAttachments:ba,source:this._contextArgs.source,contextArgs:this._contextArgs,subtitle:z,isQAndA:ca}));},renderEditComment:function(t,u,v,w,x,y,z,aa,ba){var ca=o.getComment(v),da;if(ca.attachment)da=ca.attachment.type=='sticker'?ca.attachment:null;var ea=i.generateDataFromTextWithEntities(ca.body);return (k({viewerActor:t,targetID:u,initialData:ea,onCommentSubmit:x,onCancel:y,mentionsDataSource:w,source:this._contextArgs.source,contextArgs:this._contextArgs,isEditing:true,editingCommentID:v,attachedPhoto:ca.photo_comment,attachedSticker:da,allowPhotoAttachments:z,allowStickerAttachments:aa,isQAndA:ba}));},render:function(){if(!this.root)throw new Error('render called on UFIAddCommentController with no root');p.getFeedbackTarget(this.id,function(t){if(t.cancomment&&t.actorforpost)m.get(t.actorforpost,function(u){var v=this.renderAddComment(u,t.ownerid,t.mentionsdatasource,t.showsendonentertip,null,null,t.subtitle,t.allowphotoattachments,t.allowstickerattachments,t.isqanda);this._addComment=l.renderComponent(v,this.root);}.bind(this));}.bind(this));}});e.exports=s;});
__d("UFIAddCommentLink.react",["React","UFIClassNames","cx","fbt","joinClasses","tx"],function(a,b,c,d,e,f){var g=b('React'),h=b('UFIClassNames'),i=b('cx'),j=b('fbt'),k=b('joinClasses'),l=b('tx'),m=g.createClass({displayName:'UFIAddCommentLink',render:function(){var n=k(h.ROW,(("UFIAddCommentLink")+(this.props.isFirstCommentComponent?' '+"UFIFirstCommentComponent":'')+(this.props.isLastCommentComponent?' '+"UFILastCommentComponent":'')+(this.props.isFirstComponent?' '+"UFIFirstComponent":'')+(this.props.isLastComponent?' '+"UFILastComponent":''))),o;if(this.props.isQAndA){o="Ask a question...";}else o="Write a comment...";return (g.DOM.li({className:n,'data-ft':this.props['data-ft']},g.DOM.a({className:"UFICommentLink",onClick:this.props.onClick,href:"#",role:"button"},o)));}});e.exports=m;});
__d("URITruncator",["URI","URIBase","tx"],function(a,b,c,d,e,f){var g=b('URI'),h=b('URIBase'),i=b('tx'),j=3;function k(l,m){var n="...",o=n.length;if(!l||m===undefined||l.length<=m||m<=o||l.toString().length<=o)return l;if(!h.isValidURI(l))return l.substring(0,m-o)+n;var p=new g(l),q=p.getOrigin();if(q.length>m-o)return q.substring(0,m-o)+n;var r=false;if(!!p.getFragment()){r=true;p.setFragment('');if(p.toString().length<=m-o)return p.toString()+n;}var s=p.getQueryData();if(s){var t=Object.keys(s);if(t.length>0){r=true;for(var u=t.length-1;u>=0;u--){p.removeQueryData(t[u]);if(p.toString().length<=m-o)return p.toString()+n;}}}var v=p.getPath()+(r?n:''),w=v.split('/'),x=(q.length+v.length)-m,y=0;while(x>0&&w.length>y+1){var z=y+1,aa=w[z];if(x+o+j<=aa.length){var ba=aa.length-1,ca=aa.length-x-o,da=/[a-zA-Z0-9]/;x+=o;while(x>0){while(ba>0&&da.test(aa[ba])){ba--;x--;}while(ba>0&&!da.test(aa[ba])){ba--;x--;}}if(ba===0)ba=ca-1;w[z]=aa.substring(0,ba+1)+n;}else{y++;x-=aa.length;if(y===1){x+=o;}else x--;}}if(y>0){if(w[w.length-1].length===0&&w.length===y+2)y++;w.splice(1,y,n);}var ea=q+w.join('/');if(ea.length>m)ea=ea.substring(0,m-o)+n;return ea;}e.exports=k;});
__d("HovercardLinkInterpolator",["HovercardLink","Link.react","React","RTLConfig","URI","URITruncator","cx","isRTL"],function(a,b,c,d,e,f){var g=b('HovercardLink'),h=b('Link.react'),i=b('React'),j=b('RTLConfig'),k=b('URI'),l=b('URITruncator'),m=b('cx'),n=b('isRTL');function o(p,q,r,s,t,u){var v=q.entities[0],w=r||(v.external?'_blank':null),x,y=((!v.external?"profileLink":'')+(v.weakreference?' '+"weakReference":'')),z;if(j.gkCheckSuccess){var aa=v.hashtag?p.substring(1):p;z=n(aa)?'rtl':'ltr';}if(v.hashtag){var ba=new k(v.url).setSubdomain('www');x=i.DOM.a({className:"_58cn",dir:z,href:ba.toString()},i.DOM.span({className:"_58cl"},p.substring(0,1)),i.DOM.span({className:"_58cm"},p.substring(1)));}else if(v.weakreference){x=h({className:y,dir:z,href:v,target:w},i.DOM.i({className:"UFIWeakReferenceIcon"}),p);}else{if(u&&v.external)p=l(p,u);x=h({className:y,dir:z,href:v,target:w},p);}if(!v.external&&!v.hashtag&&!v.photo)x.props['data-hovercard']=g.constructEndpointWithGroupAndLocation(v,s,t).toString();return x;}e.exports=o;});
__d("SeeMore.react",["React","cx","tx"],function(a,b,c,d,e,f){var g=b('React'),h=b('cx'),i=b('tx'),j=g.createClass({displayName:'SeeMore',getInitialState:function(){return {isCollapsed:true};},handleClick:function(){this.setState({isCollapsed:false});},render:function(){var k=this.state.isCollapsed,l=k?g.DOM.span({className:"_5uzb"},"..."):null,m=this.props.children[0],n=k?null:g.DOM.span(null,this.props.children[1]),o=!k?null:g.DOM.a({className:"_5v47 fss",onClick:this.handleClick,href:"#",role:"button"},"See More");return (g.DOM.span({className:this.props.className},m,l,o,n));}});e.exports=j;});
__d("TruncatedTextWithEntities.react",["React","TextWithEntities.react","SeeMore.react"],function(a,b,c,d,e,f){var g=b('React'),h=b('TextWithEntities.react'),i=b('SeeMore.react');function j(n,o){var p=n.offset+n.length;return o>n.offset&&o<p;}function k(n,o){for(var p=0;p<n.length;p++){var q=n[p];if(j(q,o))return q.offset;}return o;}var l=function(n,o,p){var q=[],r=[],s=k(o,p);for(var t=0;t<o.length;t++){var u=o[t];if(u.offset<s){q.push(u);}else r.push({offset:u.offset-s,length:u.length,entities:u.entities});}return {first:{ranges:q,text:n.substr(0,s)},second:{ranges:r,text:n.substr(s)}};},m=g.createClass({displayName:'TruncatedTextWithEntities',render:function(){var n=this.props.maxLines,o=this.props.maxLength,p=this.props.truncationPercent||.6,q=Math.floor(p*o),r=this.props.text||'',s=this.props.ranges||[],t=r.split('\n'),u=t.length-1,v=o&&r.length>o,w=n&&u>n;if(w)q=Math.min(t.slice(0,n).join('\n').length,q);if(v||w){var x=l(r,s,q);return (g.DOM.span({'data-ft':this.props['data-ft'],dir:this.props.dir},i({className:this.props.className},h({interpolator:this.props.interpolator,ranges:x.first.ranges,text:x.first.text,renderEmoticons:this.props.renderEmoticons,renderEmoji:this.props.renderEmoji}),h({interpolator:this.props.interpolator,ranges:x.second.ranges,text:x.second.text,renderEmoticons:this.props.renderEmoticons,renderEmoji:this.props.renderEmoji}))));}else return (g.DOM.span({'data-ft':this.props['data-ft'],dir:this.props.dir},h({className:this.props.className,interpolator:this.props.interpolator,ranges:s,text:r,renderEmoticons:this.props.renderEmoticons,renderEmoji:this.props.renderEmoji})));}});e.exports=m;});
__d("UFICommentAttachment.react",["DOM","HTML","React","Sticker.react"],function(a,b,c,d,e,f){var g=b('DOM'),h=b('HTML'),i=b('React'),j=b('Sticker.react'),k=80,l=i.createClass({displayName:'UFICommentAttachment',_attachmentFromCommentData:function(m){return m.photo_comment||m.attachment;},_getScaledDimensions:function(m,n){var o,p,q;if(n>m){q=k/n;o=m*q;p=n*q;}else{q=k/m;o=m*q;p=n*q;}return {height:Math.round(o),width:Math.round(p)};},componentDidMount:function(){var m=this._attachmentFromCommentData(this.props.comment);if(m)this.renderAttachment(m);},shouldComponentUpdate:function(m,n){var o=this._attachmentFromCommentData(this.props.comment),p=this._attachmentFromCommentData(m.comment);if(!o&&!p)return false;if(!o||!p||o.markup!=p.markup){return true;}else return false;},componentDidUpdate:function(m){var n=this._attachmentFromCommentData(this.props.comment);if(n.type!=='sticker')this.renderAttachment(n);},renderAttachment:function(m){if(m&&this.refs&&this.refs.contents){var n=m.markup;if(h.isHTML(n.markup))n=h.replaceJSONWrapper(n.markup).getRootNode();var o=n.parentNode,p=this.refs.contents.getDOMNode();if(o&&o!==p)n=n.cloneNode(true);g.setContent(p,n);}},renderSticker:function(m){var n=this._getScaledDimensions(m.metadata.height,m.metadata.width);return (j({animationTrigger:"load_and_hover",frameCount:m.metadata.frameCount,framesPerCol:m.metadata.framesPerCol,framesPerRow:m.metadata.framesPerRow,spriteURI:m.metadata.sprite_uri,sourceHeight:n.height,sourceURI:m.metadata.source_uri,sourceWidth:n.width}));},render:function(){var m=this._attachmentFromCommentData(this.props.comment);if(m)if(m&&m.type==='sticker'){return this.renderSticker(m);}else return i.DOM.div({ref:"contents"});return i.DOM.span(null);}});e.exports=l;});
__d("UFIReplyLink.react",["React","tx"],function(a,b,c,d,e,f){var g=b('React'),h=b('tx'),i=g.createClass({displayName:'UFIReplyLink',render:function(){return (g.DOM.a({className:"UFIReplyLink",href:"#",onClick:this.props.onClick},"Reply"));}});e.exports=i;});
__d("UFISpamCount",["UFISpamCountImpl"],function(a,b,c,d,e,f){e.exports=b('UFISpamCountImpl').module||{enabled:false};});
__d("UFIComment.react",["Badge.react","Bootloader","CloseButton.react","CurrentLocale","Focus","HovercardLink","HovercardLinkInterpolator","NumberFormat","ProfileBrowserLink","ProfileBrowserTypes","React","Timestamp.react","TrackingNodes","TruncatedTextWithEntities.react","UFIClassNames","UFICommentAttachment.react","UFIConfig","UFIConstants","UFIImageBlock.react","UFIReplyLink.react","UFISpamCount","URI","cx","joinClasses","keyMirror","tx","RTLConfig"],function(a,b,c,d,e,f){"use strict";var g=b('Badge.react'),h=b('Bootloader'),i=b('CloseButton.react'),j=b('CurrentLocale'),k=b('Focus'),l=b('HovercardLink'),m=b('HovercardLinkInterpolator'),n=b('NumberFormat'),o=b('ProfileBrowserLink'),p=b('ProfileBrowserTypes'),q=b('React'),r=b('Timestamp.react'),s=b('TrackingNodes'),t=b('TruncatedTextWithEntities.react'),u=b('UFIClassNames'),v=b('UFICommentAttachment.react'),w=b('UFIConfig'),x=b('UFIConstants'),y=b('UFIImageBlock.react'),z=b('UFIReplyLink.react'),aa=b('UFISpamCount'),ba=b('URI'),ca=b('cx'),da=b('joinClasses'),ea=b('keyMirror'),fa=b('tx'),ga=b('RTLConfig'),ha=x.UFIStatus,ia=' \u00b7 ',ja=ea({edit:true,hide:true,remove:true}),ka="UFICommentBody",la="UFICommentActorName",ma="UFICommentNotSpamLink",na="fsm fwn fcg UFICommentActions",oa="UFIDeletedMessageIcon",pa="UFIDeletedMessage",qa="UFIFailureMessageIcon",ra="UFIFailureMessage",sa="UFICommentLikeIcon",ta="UFITranslateLink",ua="UFITranslatedText",va="uiLinkSubtle",wa="pls",xa="fcg",ya=27,za=null,ab=function(ib,jb){var kb=new ba('/ajax/like/tooltip.php').setQueryData({comment_fbid:ib.fbid,comment_from:ib.author,comment_likecount:ib.likecount||0,comment_id:ib.id,cache_buster:ib.likeconfirmhash||0});if(jb)kb.addQueryData({viewas:jb});return kb;},bb=function(ib){var jb=ib.status;return jb===ha.FAILED_ADD||jb===ha.FAILED_EDIT;};function cb(ib){return ib.commenterIsFOF!==undefined&&ib.userIsMinor!==undefined&&ib.reportLink!==undefined;}var db=q.createClass({displayName:'UFICommentLikeCount',render:function(){var ib=this.props.comment,jb=n.formatIntegerWithDelimiter(ib.likecount||0,this.props.contextArgs.numberdelimiter),kb=p.LIKES,lb={id:ib.fbid},mb=ab(this.props.comment,this.props.viewas),nb=q.DOM.i({className:sa}),ob=q.DOM.span(null,jb),pb=(("UFICommentLikeButton")+(this.props.comment.hasviewerliked?' '+"UFICommentLikedButton":''));return (q.DOM.a({className:pb,role:"button",rel:"dialog",'data-hover':"tooltip",'data-tooltip-alignh':"center",'data-tooltip-uri':mb.toString(),ajaxify:o.constructDialogURI(kb,lb).toString(),href:o.constructPageURI(kb,lb).toString()},nb,ob));}}),eb=q.createClass({displayName:'UFICommentActions',render:function(){var ib=this.props,jb=ib.comment,kb=ib.permalink,lb=ib.feedback,mb=ib.markedAsSpamHere,nb=jb.status===ha.SPAM_DISPLAY,ob=this.props.showReplyLink,pb=this.props.hideAsSpamForPageAdmin,qb,rb,sb,tb,ub,vb,wb=!jb.islocal&&jb.status!==ha.LIVE_DELETED;if(wb){if(nb&&!mb){if(ib.viewerCanMarkNotSpam)qb=q.DOM.a({onClick:ib.onMarkAsNotSpam,className:ma,href:"#",role:"button"},"Unhide");if(pb&&lb.isthreaded&&lb.cancomment&&ob)ub=z({comment:jb,onClick:ib.onCommentReply,contextArgs:ib.contextArgs});}else{if(lb.viewercanlike){var xb=s.getTrackingInfo(jb.hasviewerliked?s.types.UNLIKE_LINK:s.types.LIKE_LINK),yb=jb.hasviewerliked?"Unlike this comment":"Like this comment";rb=q.DOM.a({className:"UFILikeLink",href:"#",role:"button",onClick:ib.onCommentLikeToggle,'data-ft':xb,title:yb},jb.hasviewerliked?"Unlike":"Like");}if(lb.isthreaded&&lb.cancomment&&ob)ub=z({comment:jb,onClick:ib.onCommentReply,contextArgs:ib.contextArgs});if(jb.likecount>0)sb=db({comment:jb,viewas:this.props.viewas,contextArgs:this.props.contextArgs});if(jb.spamcount&&aa.enabled)tb=aa({count:jb.spamcount});}if(jb.attachment&&jb.attachment.type=="share"&&jb.canremove)vb=q.DOM.a({onClick:ib.onPreviewRemove,href:"#",role:"button"},"Remove Preview");}var zb=fb({comment:jb,permalink:kb,onRetrySubmit:ib.onRetrySubmit,showPermalink:ib.showPermalink}),ac;if(lb.isqanda){ac={likeCount:sb,spamCount:tb,likeToggle:rb,commentReply:ub,spamToggle:qb,metadata:zb,removePreview:vb};}else if(ib.contextArgs.entstream){ac={metadata:zb,likeToggle:rb,likeCount:sb,commentReply:ub,spamCount:tb,spamToggle:qb,removePreview:vb};}else if(lb.isthreaded){ac={likeToggle:rb,commentReply:ub,spamToggle:qb,removePreview:vb,likeCount:sb,spamCount:tb,metadata:zb};}else ac={metadata:zb,likeToggle:rb,likeCount:sb,spamCount:tb,commentReply:ub,spamToggle:qb,removePreview:vb};if(jb.status===ha.LIVE_DELETED){var bc=q.DOM.span({className:pa},q.DOM.i({className:oa,'data-hover':"tooltip",'aria-label':"Comment deleted"}));ac.deletionWarning=bc;}var cc=true,dc={};for(var ec in ac){var fc=ac[ec];if(fc){dc[ec]=cc?fc:{MIDDOT:ia,action:fc};cc=false;}}return (q.DOM.div({className:na},dc));}}),fb=q.createClass({displayName:'UFICommentMetadata',render:function(){var ib=this.props.comment,jb=this.props.permalink,kb=this.props.onRetrySubmit,lb,mb;if(bb(ib)){lb=[q.DOM.span({className:ra},q.DOM.i({className:qa}),"Unable to post comment."),ib.allowRetry&&kb?[' ',q.DOM.a({onClick:kb,href:"#",role:"button"},"Try Again")]:null];}else{var nb=this.props.showPermalink?jb:null,ob=s.getTrackingInfo(s.types.SOURCE);mb=q.DOM.a({className:va,href:nb,'data-ft':ob},r({time:ib.timestamp.time,text:ib.timestamp.text,verbose:ib.timestamp.verbose}));}var pb=null;if(ib.originalTimestamp){var qb=new ba('/ajax/edits/browser/comment').addQueryData({comment_token:ib.id}).toString();pb=[ia,q.DOM.a({ref:"EditLink",href:"#",role:"button",rel:"dialog",className:"uiLinkSubtle",ajaxify:qb,'data-hover':"tooltip",'aria-label':"Show edit history",title:"Show edit history"},"Edited")];}return (q.DOM.span(null,mb,lb,pb));},componentWillUpdate:function(ib){var jb=this.props.comment,kb=ib.comment;if(!jb.editnux&&!!kb.editnux)h.loadModules(["LegacyContextualDialog"],function(lb){var mb=new lb();mb.init(kb.editnux).setContext(this.refs.EditLink.getDOMNode()).setWidth(300).setPosition('below').show();}.bind(this));}}),gb=q.createClass({displayName:'UFISocialContext',render:function(){var ib=this.props.topMutualFriend,jb=this.props.otherMutualCount,kb=this.props.commentAuthor,lb=l.constructEndpoint(ib).toString(),mb=q.DOM.a({href:ib.uri,'data-hovercard':lb},ib.name),nb=kb.name.length+ib.name.length,ob;if(jb===0){ob=fa._("Friends with {name}",{name:mb});}else if(nb<ya){var pb;if(jb==1){pb="1 other";}else pb=fa._("{count} others",{count:jb});ob=fa._("Friends with {name} and {others}",{name:mb,others:this.getOthersLink(pb,kb,ib)});}else{var qb=fa._("{count} mutual friends",{count:jb+1});ob=this.getOthersLink(qb,kb);}return (q.DOM.span({className:"UFICommentSocialContext"},ia,ob));},getOthersLink:function(ib,jb,kb){var lb=p.MUTUAL_FRIENDS,mb={uid:jb.id},nb=new ba('/ajax/mutual_friends/tooltip.php').setQueryData({friend_id:jb.id});if(kb)nb.addQueryData({exclude_id:kb.id});var ob=o.constructDialogURI(lb,mb).toString();return (q.DOM.a({rel:"dialog",'data-hover':"tooltip",'data-tooltip-alignh':"center",'data-tooltip-uri':nb.toString(),ajaxify:ob,href:o.constructPageURI(lb,mb).toString()},ib));}}),hb=q.createClass({displayName:'UFIComment',getInitialState:function(){return {isHighlighting:this.props.comment.highlightcomment,wasHighlighted:this.props.comment.highlightcomment,markedAsSpamHere:false,oneClickRemovedHere:false,isInlinePageDeleted:false,isInlineBanned:false};},_onHideAsSpam:function(event){this.props.onHideAsSpam(event);this.setState({markedAsSpamHere:true});},_onMarkAsNotSpam:function(event){this.props.onMarkAsNotSpam(event);this.setState({markedAsSpamHere:false});},_onDeleteSpam:function(event){this.props.onOneClickRemove(event);this.setState({isInlinePageDeleted:true});},_onUndoDeleteSpam:function(event){this.props.onUndoOneClickRemove(event);this.setState({isInlinePageDeleted:false});},_onInlineBan:function(event){this.props.onInlineBan(event);this.setState({isInlineBanned:true});},_onUndoInlineBan:function(event){this.props.onUndoInlineBan(event);this.setState({isInlineBanned:false});},_onOneClickRemove:function(event){this.props.onOneClickRemove(event);this.setState({oneClickRemovedHere:true});},_onUndoOneClickRemove:function(event){this.props.onUndoOneClickRemove(event);this.setState({oneClickRemovedHere:false});},_onAction:function(event,ib){setTimeout(function(){if(ib===ja.remove){this.props.onRemove(event);}else if(ib===ja.edit){this.props.onEdit(event);}else if(ib===ja.hide)this._onHideAsSpam(event);}.bind(this),0);},_createRemoveReportMenu:function(event){if(this._hasBootloadedRemoveReportMenu)return;this._hasBootloadedRemoveReportMenu=true;event.persist();h.loadModules(["LegacyMenuUtils"],function(ib){var jb=[{label:"Delete Comment...",value:ja.remove},{label:"Hide Comment",value:ja.hide}];ib.createAndShowPopoverMenu(event.target,jb,this._onAction.bind(this,event));}.bind(this));},_createEditDeleteMenu:function(event){if(this._hasBootloadedEditDeleteMenu)return;this._hasBootloadedEditDeleteMenu=true;event.persist();h.loadModules(["LegacyMenuUtils"],function(ib){var jb=[{label:"Edit...",value:ja.edit},{label:"Delete...",value:ja.remove}];ib.createAndShowPopoverMenu(event.target,jb,this._onAction.bind(this,event));}.bind(this));},_renderCloseButton:function(){var ib=this.props.comment,jb=this.props.feedback,kb=null,lb=null,mb=false;if(ib.canremove&&!this.props.hideAsSpamForPageAdmin){if(this.props.viewerIsAuthor){if(ib.canedit){lb="Edit or Delete";kb=this._createEditDeleteMenu;mb=true;}else{lb="Remove";kb=this.props.onRemove;}}else if(jb.canremoveall)if(this.props.showRemoveReportMenu){lb="Remove or Report";kb=this._createRemoveReportMenu;}else{lb="Remove";kb=this._onOneClickRemove;}}else if(ib.canreport){lb="Hide";kb=this._onHideAsSpam;}var nb=(("UFICommentCloseButton")+(mb?' '+"UFIEditButton":'')+(kb===null?' '+"hdn":'')),ob=null,pb=null;if(this.props.contextArgs.viewas){ob="/ajax/profile/link_disabled_in_viewas.php";pb="dialog";kb=null;}return (i({ajaxify:ob,onClick:kb,rel:pb,tooltip:lb,className:nb}));},componentDidMount:function(){if(this.state.isHighlighting){var ib=this.getDOMNode();h.loadModules(["UFIScrollHighlight"],function(jb){setTimeout(jb.actOn.bind(null,ib),0);});this.setState({isHighlighting:false});}if(this.props.focusOnMount)k.setWithoutOutline(this.refs.AuthorName.getDOMNode());},shouldComponentUpdate:function(ib,jb){var kb=this.props,lb=this.state;return (ib.comment!==kb.comment||ib.showReplyLink!==kb.showReplyLink||ib.showReplies!==kb.showReplies||ib.isFirst!==kb.isFirst||ib.isLast!==kb.isLast||ib.isFirstCommentComponent!==kb.isFirstCommentComponent||ib.isLastCommentComponent!==kb.isLastCommentComponent||ib.isFirstComponent!==kb.isFirstComponent||ib.isLastComponent!==kb.isLastComponent||ib.isFeaturedComment!==kb.isFeaturedComment||ib.hasPartialBorder!==kb.hasPartialBorder||jb.wasHighlighted!==lb.wasHighlighted||jb.isHighlighting!==lb.isHighlighting||jb.markedAsSpamHere!==lb.markedAsSpamHere||jb.isInlinePageDeleted!==lb.isInlinePageDeleted||jb.isInlineBanned!==lb.isInlineBanned||jb.oneClickRemovedHere!==lb.oneClickRemovedHere);},render:function(){var ib=this.props.comment,jb=this.props.feedback,kb=ib.status===ha.DELETED,lb=ib.status===ha.LIVE_DELETED,mb=ib.status===ha.SPAM_DISPLAY,nb=ib.status===ha.PENDING_UNDO_DELETE,ob=this.state.markedAsSpamHere,pb=this.state.oneClickRemovedHere,qb=this.state.isInlinePageDeleted,rb=this.props.hideAsSpamForPageAdmin,sb=this.state.isInlineBanned,tb=cb(ib),ub=!ib.status&&(ib.isunseen||ib.islocal);if(!ib.status&&jb.lastseentime){var vb=ib.originalTimestamp||ib.timestamp.time;ub=ub||vb>jb.lastseentime;}var wb=this.props.contextArgs.markedcomments;if(wb&&wb[ib.legacyid])ub=true;if(tb)if(za){var xb,yb=null,zb=null,ac=null;if(rb){zb=sb?this._onUndoInlineBan:this._onInlineBan;if(qb){yb=this._onUndoDeleteSpam;var bc=q.DOM.a({href:"#",onClick:yb},"Undo");xb=fa._("You've deleted this comment so no one can see it. {undo}.",{undo:bc});}else if(ob){xb="Now this is only visible to the person who wrote it and their friends.";ac=this._onDeleteSpam;yb=this._onMarkAsNotSpam;}}else if(ob){xb="This comment has been hidden.";ac=this._onDeleteSpam;yb=this._onMarkAsNotSpam;}else if(pb){xb="This comment has been removed.";yb=this._onUndoOneClickRemove;}if(xb)return (q.DOM.li({className:da(u.ROW,"UFIHide")},za({notice:xb,comment:this.props.comment,authorProfiles:this.props.authorProfiles,onUndo:yb,onBanAction:zb,onDeleteAction:ac,isInlineBanned:sb,hideAsSpamForPageAdmin:rb})));}else h.loadModules(["UFICommentRemovalControls.react"],function(fc){za=fc;setTimeout(function(){this.forceUpdate();}.bind(this));}.bind(this));var cc=!kb||pb,dc=da(u.ROW,(("UFIComment")+(bb(ib)?' '+"UFICommentFailed":'')+(kb||lb||mb||nb?' '+"UFITranslucentComment":'')+(this.state.isHighlighting?' '+"highlightComment":'')+(!cc?' '+"noDisplay":'')+(cc?' '+"display":'')+(this.props.isFirst&&!this.props.isReply?' '+"UFIFirstComment":'')+(this.props.isLast&&!this.props.isReply?' '+"UFILastComment":'')+(this.props.isFirstCommentComponent?' '+"UFIFirstCommentComponent":'')+(this.props.isLastCommentComponent?' '+"UFILastCommentComponent":'')+(this.props.isFirstComponent?' '+"UFIFirstComponent":'')+(this.props.isLastComponent?' '+"UFILastComponent":'')+(this.props.isFeatured&&!this.props.contextArgs.showverified?' '+"UFIFeaturedComment":'')+(this.props.hasPartialBorder&&!this.props.contextArgs.entstream?' '+"UFIPartialBorder":''))),ec=this.renderComment();if(ub)if(this.props.contextArgs.snowliftredesign){ec=q.DOM.div({className:"_5cis"},q.DOM.div({className:"_5cit"}),ec);}else if(this.props.contextArgs.entstream&&!this.props.isReply){ec=q.DOM.div({className:"_52mp"},q.DOM.div({className:"_52mq"}),ec);}else dc=da(dc,u.UNSEEN_ITEM);return (q.DOM.li({className:dc,'data-ft':this.props['data-ft']},ec));},renderComment:function(){var ib=this.props,jb=ib.comment,kb=ib.permalink,lb=ib.feedback,mb=ib.authorProfiles[jb.author],nb=jb.status===ha.SPAM_DISPLAY,ob=jb.status===ha.LIVE_DELETED,pb=!(nb||ob),qb=lb.canremoveall||jb.hiddenbyviewer,rb=null,sb=null;if(!ib.isLocallyComposed&&!this.state.wasHighlighted&&!jb.fromfetch){sb=x.commentTruncationLength;rb=x.commentTruncationMaxLines;}var tb=s.getTrackingInfo(s.types.SMALL_ACTOR_PHOTO),ub=s.getTrackingInfo(s.types.USER_NAME),vb=s.getTrackingInfo(s.types.USER_MESSAGE),wb=null,xb=null;if(jb.istranslatable&&(jb.translatedtext===undefined))wb=q.DOM.a({href:"#",role:"button",title:"Translate this comment",className:ta,onClick:ib.onCommentTranslate},"See Translation");if(jb.translatedtext){var yb=new ba('http://bing.com/translator').addQueryData({text:jb.body.text});xb=q.DOM.span({className:ua},jb.translatedtext,q.DOM.span({className:wa},' ',"(",q.DOM.a({href:yb.toString(),className:xa},"Translated by Bing"),")"));}var zb,ac;if(j.isRTL()&&jb.body.dir==='ltr'){zb='rtl';if(ga.gkCheckSuccess)ac="_5wjy _5wjz";}else if(!j.isRTL()&&jb.body.dir==='rtl'){zb='ltr';if(ga.gkCheckSuccess)ac="_5wj- _5wj_";}var bc=l.constructEndpointWithLocation(mb,'ufi').toString(),cc=q.DOM.a({ref:"AuthorName",className:la,href:mb.uri,'data-hovercard':bc,'data-ft':ub,dir:zb},mb.name),dc=function(lc,mc){return m(lc,mc,'_blank',lb.grouporeventid,'ufi',x.commentURLTruncationLength);},ec=t({className:ka,interpolator:dc,ranges:jb.body.ranges,text:jb.body.text,truncationPercent:x.commentTruncationPercent,maxLength:sb,maxLines:rb,renderEmoticons:w.renderEmoticons,renderEmoji:w.renderEmoji,'data-ft':vb,dir:jb.body.dir}),fc,gc;if(ib.isFeatured&&ib.contextArgs.showverified)gc=g({size:"xsmall",type:"verified"});if(jb.socialcontext){var hc=jb.socialcontext,ic=gb({topMutualFriend:ib.authorProfiles[hc.topmutualid],otherMutualCount:hc.othermutualcount,commentAuthor:mb});fc=[cc,gc,ic,q.DOM.div(null,ec)];}else{if(ac!=null)ec=q.DOM.div({className:ac},ec);fc=[cc,gc,' ',ec];}var jc=null;if(jb.photo_comment_status)jc=q.DOM.div({className:"_50f8"},jb.photo_comment_status);var kc=null;if(jb.sticker_attachment_status)kc=q.DOM.div({className:"_50f8"},jb.sticker_attachment_status);return (y({spacing:"medium"},q.DOM.a({href:mb.uri,'data-hovercard':bc,'data-ft':tb},q.DOM.img({src:mb.thumbSrc,className:u.ACTOR_IMAGE,alt:""})),q.DOM.div(null,q.DOM.div({className:"UFICommentContent"},fc,wb,xb,v({comment:ib.comment})),jc,kc,eb({comment:jb,feedback:lb,onBlingBoxClick:ib.onBlingBoxClick,onCommentLikeToggle:ib.onCommentLikeToggle,onCommentReply:ib.onCommentReply,onPreviewRemove:ib.onPreviewRemove,onRetrySubmit:ib.onRetrySubmit,onMarkAsNotSpam:this._onMarkAsNotSpam,permalink:kb,viewerCanMarkNotSpam:qb,viewas:ib.contextArgs.viewas,showPermalink:ib.showPermalink,showReplyLink:ib.showReplyLink,showReplies:ib.showReplies,contextArgs:ib.contextArgs,markedAsSpamHere:this.state.markedAsSpamHere,hideAsSpamForPageAdmin:ib.hideAsSpamForPageAdmin})),pb?this._renderCloseButton():null));}});e.exports=hb;});
__d("UFIContainer.react",["React","TrackingNodes","cx"],function(a,b,c,d,e,f){var g=b('React'),h=b('TrackingNodes'),i=b('cx'),j=g.createClass({displayName:'UFIContainer',render:function(){var k=null;if(this.props.hasNub)k=g.DOM.li({className:"UFIArrow"},g.DOM.i(null));var l=((!this.props.isReplyList?"UFIList":'')+(this.props.isReplyList?' '+"UFIReplyList":'')+(this.props.isParentLiveDeleted?' '+"UFITranslucentReplyList":'')+(this.props.isFirstCommentComponent?' '+"UFIFirstCommentComponent":'')+(this.props.isLastCommentComponent?' '+"UFILastCommentComponent":'')+(this.props.isFirstComponent?' '+"UFIFirstComponent":'')+(this.props.isLastComponent?' '+"UFILastComponent":''));return (g.DOM.ul({className:l,'data-ft':h.getTrackingInfo(h.types.UFI)},k,this.props.children));}});e.exports=j;});
__d("UFILikeSentenceText.react",["HovercardLinkInterpolator","ProfileBrowserLink","ProfileBrowserTypes","React","TextWithEntities.react","URI"],function(a,b,c,d,e,f){var g=b('HovercardLinkInterpolator'),h=b('ProfileBrowserLink'),i=b('ProfileBrowserTypes'),j=b('React'),k=b('TextWithEntities.react'),l=b('URI');function m(p,q,r,s){if(s.count!=null){var t=i.LIKES,u={id:p.targetfbid};return (j.DOM.a({href:h.constructPageURI(t,u).toString(),target:"_blank"},r));}else return g(r,s,'_blank',null,'ufi');}function n(p,q,r,s){if(s.count!=null){var t=i.LIKES,u={id:p.targetfbid},v=[];for(var w=0;w<q.length;w++)if(!q[w].count)v.push(q[w].entities[0].id);var x=new l('/ajax/like/tooltip.php').setQueryData({comment_fbid:p.targetfbid,comment_from:p.actorforpost,seen_user_fbids:v.length?v:true});return (j.DOM.a({rel:"dialog",ajaxify:h.constructDialogURI(t,u).toString(),href:h.constructPageURI(t,u).toString(),'data-hover':"tooltip",'data-tooltip-alignh':"center",'data-tooltip-uri':x.toString(),role:"button"},r));}else return g(r,s,null,null,'ufi');}var o=j.createClass({displayName:'UFILikeSentenceText',render:function(){var p=this.props.feedback,q=this.props.likeSentenceData,r;if(this.props.contextArgs.embedded){r=m;}else r=n;r=r.bind(null,p,q.ranges);return (k({interpolator:r,ranges:q.ranges,aggregatedRanges:q.aggregatedranges,text:q.text}));}});e.exports=o;});
__d("UFILikeSentence.react",["Bootloader","LeftRight.react","ProfileBrowserLink","ProfileBrowserTypes","React","UFIClassNames","UFIImageBlock.react","UFILikeSentenceText.react","URI","cx","joinClasses","tx"],function(a,b,c,d,e,f){var g=b('Bootloader'),h=b('LeftRight.react'),i=b('ProfileBrowserLink'),j=b('ProfileBrowserTypes'),k=b('React'),l=b('UFIClassNames'),m=b('UFIImageBlock.react'),n=b('UFILikeSentenceText.react'),o=b('URI'),p=b('cx'),q=b('joinClasses'),r=b('tx'),s=k.createClass({displayName:'UFILikeSentence',getInitialState:function(){return {selectorModule:null,bootloadedSelectorModule:false};},componentWillMount:function(){this._bootloadSelectorModule(this.props);},componentWillReceiveProps:function(t){this._bootloadSelectorModule(t);},_bootloadSelectorModule:function(t){if(t.showOrderingModeSelector&&!t.contextArgs.embedded&&!this.state.bootloadedSelectorModule){var u=function(v){this.setState({selectorModule:v});}.bind(this);if(t.contextArgs.entstream){g.loadModules(["UFIEntStreamOrderingModeSelector.react"],u);}else g.loadModules(["UFIOrderingModeSelector.react"],u);this.setState({bootloadedSelectorModule:true});}},render:function(){var t=this.props.feedback,u=t.likesentences.current,v=this.props.contextArgs.entstream,w=q(l.ROW,t.likesentences.isunseen?l.UNSEEN_ITEM:'',(("UFILikeSentence")+(this.props.isFirstComponent?' '+"UFIFirstComponent":'')+(this.props.isLastComponent?' '+"UFILastComponent":''))),x=null,y=null;if(u.text)y=k.DOM.div({className:"UFILikeSentenceText"},n({contextArgs:this.props.contextArgs,feedback:t,likeSentenceData:u}));if(y&&!v){x=k.DOM.i({className:"UFILikeIcon"});if(t.viewercanlike&&!t.hasviewerliked)x=k.DOM.a({className:"UFILikeThumb",href:"#",tabIndex:"-1",title:"Like this",onClick:this.props.onTargetLikeToggle,role:"button",'aria-label':"Like this"},x);}var z=y,aa=null;if(t.seencount>0&&!v){var ba=j.GROUP_MESSAGE_VIEWERS,ca={id:t.targetfbid},da=i.constructDialogURI(ba,ca),ea=i.constructPageURI(ba,ca),fa=new o('/ajax/ufi/seen_tooltip.php').setQueryData({ft_ent_identifier:t.entidentifier,displayed_count:t.seencount}),ga;if(t.seenbyall){ga="Seen by everyone";}else ga=t.seencount==1?"Seen by 1":r._("Seen by {count}",{count:t.seencount});aa=k.DOM.a({rel:"dialog",ajaxify:da.toString(),href:ea.toString(),tabIndex:"-1",'data-hover':"tooltip",'data-tooltip-alignh':"left",'data-tooltip-uri':fa.toString(),className:(("UFISeenCount")+(!!u.text?' '+"UFISeenCountRight":''))},k.DOM.span({className:"UFISeenCountIcon"}),ga);}else if(this.props.showOrderingModeSelector&&this.state.selectorModule&&!this.props.contextArgs.embedded){var ha=this.state.selectorModule;aa=ha({currentOrderingMode:this.props.orderingMode,entstream:v,orderingmodes:t.orderingmodes,onOrderChanged:this.props.onOrderingModeChange});if(!z)z=k.DOM.div(null);}var ia=null;if(x&&y){ia=m(null,x,y,aa);}else if(z){ia=h({direction:h.DIRECTION.right},z,aa);}else ia=aa;return (k.DOM.li({className:w},ia));}});e.exports=s;});
__d("UFIPager.react",["LeftRight.react","React","UFIClassNames","UFIImageBlock.react","cx","joinClasses"],function(a,b,c,d,e,f){var g=b('LeftRight.react'),h=b('React'),i=b('UFIClassNames'),j=b('UFIImageBlock.react'),k=b('cx'),l=b('joinClasses'),m=h.createClass({displayName:'UFIPager',onPagerClick:function(n){!this.props.isLoading&&this.props.onPagerClick&&this.props.onPagerClick();n.nativeEvent.prevent();},render:function(){var n=this.onPagerClick,o=((this.props.isLoading?"ufiPagerLoading":'')),p=l(i.ROW,this.props.isUnseen?i.UNSEEN_ITEM:'',(("UFIPagerRow")+(this.props.isFirstCommentComponent?' '+"UFIFirstCommentComponent":'')+(this.props.isLastCommentComponent?' '+"UFILastCommentComponent":'')+(this.props.isFirstComponent?' '+"UFIFirstComponent":'')+(this.props.isLastComponent?' '+"UFILastComponent":''))),q=h.DOM.a({className:"UFIPagerLink",onClick:n,href:"#",role:"button"},h.DOM.span({className:o},this.props.pagerLabel)),r=(("fcg")+(' '+"UFIPagerCount")),s=h.DOM.span({className:r},this.props.countSentence),t;if(this.props.contextArgs.entstream){t=(g({direction:g.DIRECTION.right},q,s));}else t=(j(null,h.DOM.a({className:"UFIPagerIcon",onClick:n,href:"#",role:"button"}),q,s));return (h.DOM.li({className:p,'data-ft':this.props['data-ft']},t));}});e.exports=m;});
__d("UFIPagerLabel",["fbt","tx"],function(a,b,c,d,e,f){var g=b('fbt'),h=b('tx'),i={VIEW_ONE:'view_one',VIEW_ONE_MORE:'view_one_more',VIEW_ALL:'view_all',VIEW_MORE_EXPLICIT:'view_more_explicit',VIEW_MORE:'view_more',VIEW_PREVIOUS:'view_previous',getReplyLabel:function(j,k){switch(j){case i.VIEW_ONE:return "View 1 reply";case i.VIEW_ONE_MORE:return "View 1 more reply";case i.VIEW_ALL:return h._("View all {count} replies",{count:k.count});case i.VIEW_MORE_EXPLICIT:return h._("View {count} more replies",{count:k.count});case i.VIEW_MORE:return "View more replies";case i.VIEW_PREVIOUS:return "View previous replies";default:return null;}},getCommentLabel:function(j,k){switch(j){case i.VIEW_ONE:return "View 1 comment";case i.VIEW_ONE_MORE:return "View 1 more comment";case i.VIEW_ALL:return h._("View all {count} comments",{count:k.count});case i.VIEW_MORE_EXPLICIT:return h._("View {count} more comments",{count:k.count});case i.VIEW_MORE:return "View more comments";case i.VIEW_PREVIOUS:return "View previous comments";default:return null;}},getQuestionLabel:function(j,k){switch(j){case i.VIEW_ONE:return "View 1 question";case i.VIEW_ONE_MORE:return "View 1 more question";case i.VIEW_ALL:return g._("View all {count} questions",[g.param("count",k.count)]);case i.VIEW_MORE_EXPLICIT:return g._("View {count} more questions",[g.param("count",k.count)]);case i.VIEW_MORE:return "View more questions";case i.VIEW_PREVIOUS:return "View previous questions";default:return null;}},getLabel:function(j,k,l,m){if(k){return i.getReplyLabel(j,m);}else if(l){return i.getQuestionLabel(j,m);}else return i.getCommentLabel(j,m);}};e.exports=i;});
__d("UFIReplySocialSentence.react",["Badge.react","LiveTimer","React","Timestamp.react","UFIClassNames","UFIConstants","UFIImageBlock.react","cx","joinClasses","tx"],function(a,b,c,d,e,f){var g=b('Badge.react'),h=b('LiveTimer'),i=b('React'),j=b('Timestamp.react'),k=b('UFIClassNames'),l=b('UFIConstants'),m=b('UFIImageBlock.react'),n=b('cx'),o=b('joinClasses'),p=b('tx'),q=' \u00b7 ',r=43200,s=i.createClass({displayName:'UFIReplySocialSentence',render:function(){var t=((this.props.isLoading?"UFIReplySocialSentenceLoading":'')),u=o(k.ROW,(("UFIReplySocialSentenceRow")+(this.props.isFirstComponent?' '+"UFIFirstComponent":'')+(this.props.isLastComponent?' '+"UFILastComponent":''))),v,w;if(this.props.isExpanded){v=this.props.replies>1?p._("Hide {count} Replies",{count:this.props.replies}):"Hide 1 Reply";}else{v=this.props.replies>1?p._("{count} Replies",{count:this.props.replies}):"1 Reply";if(this.props.timestamp){var x=h.getApproximateServerTime()/1000-this.props.timestamp.time;if(x<r||this.props.orderingMode==l.UFICommentOrderingMode.RECENT_ACTIVITY)w=i.DOM.span({className:"fcg"},q,j({time:this.props.timestamp.time,text:this.props.timestamp.text,verbose:this.props.timestamp.verbose}));}}var y=Object.keys(this.props.authors),z=y.length&&!this.props.isExpanded,aa,ba;if(z){var ca=this.props.authors[y[0]];aa=i.DOM.img({alt:"",src:ca.thumbSrc,className:k.ACTOR_IMAGE});var da=ca.name;if(this.props.showVerified)da=[ca.name,g({size:"xsmall",type:"verified"})];ba=[p._("{author} replied",{author:da}),q,v];}else{aa=i.DOM.i({className:((!this.props.isExpanded?"UFIPagerIcon":'')+(this.props.isExpanded?' '+"UFICollapseIcon":''))});ba=v;}return (i.DOM.li({className:u,'data-ft':this.props['data-ft']},i.DOM.a({className:"UFICommentLink",onClick:this.props.onClick,href:"#",role:"button"},m(null,i.DOM.div({className:((z?"UFIReplyActorPhotoWrapper":''))},aa),i.DOM.span({className:t},i.DOM.span({className:(("UFIReplySocialSentenceLinkText")+(this.props.showVerified?' '+"UFIReplySocialSentenceVerified":''))},ba),w)))));}});e.exports=s;});
__d("UFIShareRow.react",["NumberFormat","React","UFIClassNames","UFIImageBlock.react","URI","cx","joinClasses","tx"],function(a,b,c,d,e,f){var g=b('NumberFormat'),h=b('React'),i=b('UFIClassNames'),j=b('UFIImageBlock.react'),k=b('URI'),l=b('cx'),m=b('joinClasses'),n=b('tx'),o=h.createClass({displayName:'UFIShareRow',render:function(){var p=new k('/ajax/shares/view').setQueryData({target_fbid:this.props.targetID}),q=new k('/shares/view').setSubdomain('www').setQueryData({id:this.props.targetID}),r;if(this.props.shareCount>1){var s=g.formatIntegerWithDelimiter(this.props.shareCount,this.props.contextArgs.numberdelimiter||',');r=n._("{count} shares",{count:s});}else r="1 share";var t=m(i.ROW,(("UFIShareRow")+(this.props.isFirstComponent?' '+"UFIFirstComponent":'')+(this.props.isLastComponent?' '+"UFILastComponent":'')));return (h.DOM.li({className:t},j(null,h.DOM.a({className:"UFIShareIcon",rel:"dialog",ajaxify:p.toString(),href:q.toString()}),h.DOM.a({className:"UFIShareLink",rel:"dialog",ajaxify:p.toString(),href:q.toString()},r))));}});e.exports=o;});
__d("UFISpamPlaceholder.react",["React","UFIClassNames","cx","fbt","tx"],function(a,b,c,d,e,f){var g=b('React'),h=b('UFIClassNames'),i=b('cx'),j=b('fbt'),k=b('tx'),l=g.createClass({displayName:'UFISpamPlaceholder',render:function(){var m=(("UFISpamCommentWrapper")+(this.props.isLoading?' '+"UFISpamCommentLoading":''));return (g.DOM.li({className:h.ROW},g.DOM.a({href:"#",role:"button",className:"UFISpamCommentLink",onClick:this.props.onClick,'aria-label':"Show comments marked as spam"},g.DOM.span({'data-hover':"tooltip",'data-tooltip-alignh':"center",'aria-label':k._("{count} hidden",{count:this.props.numHidden}),className:m},g.DOM.i({className:"placeholderIcon"})))));}});e.exports=l;});
__d("UFI.react",["Event","NumberFormat","React","LegacyScrollableArea.react","ScrollAwareDOM","TrackingNodes","UFIAddCommentController","UFIAddCommentLink.react","UFIComment.react","UFIConstants","UFIContainer.react","UFIInstanceState","UFILikeSentence.react","UFIPager.react","UFIPagerLabel","UFIReplySocialSentence.react","UFIShareRow.react","UFISpamPlaceholder.react","copyProperties","isEmpty","throttle","tx"],function(a,b,c,d,e,f){"use strict";var g=b('Event'),h=b('NumberFormat'),i=b('React'),j=b('LegacyScrollableArea.react'),k=b('ScrollAwareDOM'),l=b('TrackingNodes'),m=b('UFIAddCommentController'),n=b('UFIAddCommentLink.react'),o=b('UFIComment.react'),p=b('UFIConstants'),q=b('UFIContainer.react'),r=b('UFIInstanceState'),s=b('UFILikeSentence.react'),t=b('UFIPager.react'),u=b('UFIPagerLabel'),v=b('UFIReplySocialSentence.react'),w=b('UFIShareRow.react'),x=b('UFISpamPlaceholder.react'),y=b('copyProperties'),z=b('isEmpty'),aa=b('throttle'),ba=b('tx'),ca={TOP:'top',BOTTOM:'bottom',ALL:'all'},da=i.createClass({displayName:'UFI',getInitialState:function(){return {instanceShowRepliesMap:{},instanceShowReplySocialSentenceMap:{},loadingSpamIDs:{},isActiveLoading:{},commentIDToFocusOnMount:null,replyComposerIDToFocusOnMount:null,hasPagedToplevel:false};},componentDidMount:function(){this.suppressScrolls=0;this.scrollSubscription=k.subscribe('scroll',function(){if(this.suppressScrolls>0){this.suppressScrolls--;return false;}return true;}.bind(this));},componentWillUnmount:function(){if(this.scrollSubscription){k.unsubscribe(this.scrollSubscription);this.scrollSubscription=null;}},componentWillReceiveProps:function(ea){var fa=y({},this.state.isActiveLoading),ga;for(ga in this.state.isActiveLoading){var ha=this.props.ranges[this.props.id],ia=ea.ranges[this.props.id];if(ha.getOffset()!=ia.getOffset()||ha.getLength()!=ia.getLength()){var ja=(ia.getOffset()<ha.getOffset())?0:ha.getLength();if(ja<ea.availableComments.length)this.setState({commentIDToFocusOnMount:ea.availableComments[ja].id});}delete fa[ga];}this.setState({isActiveLoading:fa});},componentDidUpdate:function(ea,fa,ga){var ha=this.state.replyComposerIDToFocusOnMount;if(this.refs&&ha in this.refs){this.refs[ha].focus();this.setState({replyComposerIDToFocusOnMount:null});}},componentWillUpdate:function(ea,fa,ga){var ha,ia;for(ha in this.state.isActiveLoading){ia=this.state.isActiveLoading[ha];if(ia!==ca.TOP)this.suppressScrolls++;}},render:function(){var ea=this.props,fa=ea.feedback,ga=ea.contextArgs,ha=ea.source!=p.UFIFeedbackSourceType.ADS,ia=!ea.hideOrderingModeSelector&&fa.orderingmodes&&ea.commentCounts[ea.id]>=p.minCommentsForOrderingModeSelector,ja=(!z(fa.likesentences.current)||(fa.seencount>0&&!ga.entstream)||ia)&&ga.search!==true&&ha,ka=null;if(ja)ka=s({contextArgs:ga,feedback:fa,onTargetLikeToggle:ea.onTargetLikeToggle,onOrderingModeChange:ea.onOrderingModeChange,orderingMode:ea.orderingMode,showOrderingModeSelector:ia});var la=ea.availableComments&&ea.availableComments.length&&ha,ma=null;if(la)ma=this.renderCommentMap(ea.availableComments,ea.ranges[ea.id].getOffset());var na=null,oa=fa.cancomment,pa=oa&&ga.showaddcomment&&fa.actorforpost&&!ga.embedded&&ea.canAddCommentMap[ea.id];if(pa){var qa=new m(null,ea.id,null,ga),ra=ea.authorProfiles[fa.actorforpost];na=qa.renderAddComment(ra,fa.ownerid,fa.mentionsdatasource,fa.showsendonentertip,'toplevelcomposer',null,fa.subtitle,fa.allowphotoattachments,fa.allowstickerattachments,fa.isqanda);}var sa=null,ta=ga.showshares&&fa.sharecount&&ha;if(ta&&!ga.entstream&&!ga.embedded)sa=w({targetID:fa.targetfbid,shareCount:fa.sharecount,contextArgs:ga});var ua=ja||ta||la||oa,va=this.renderPagers();this.applyToUFIComponents([va.topPager],ma,[va.bottomPager],{isFirstCommentComponent:true},{isLastCommentComponent:true});var wa=fa.commentboxhoisted?na:null,xa=fa.commentboxhoisted?null:na,ya=null;if(pa&&fa.hasaddcommentlink&&this.state.hasPagedToplevel&&!ga.embedded)ya=n({onClick:this.onComment,isQAndA:fa.isqanda});this.applyToUFIComponents([ka,sa,wa,va.topPager],ma,[va.bottomPager,xa,ya],{isFirstComponent:true},{isLastComponent:true});var za=[va.topPager,ma,va.bottomPager];if(ga.embedded){za=null;}else if(ga.scrollcomments&&ga.scrollwidth)za=i.DOM.li(null,j({width:ga.scrollwidth},i.DOM.ul(null,za)));return (q({hasNub:ga.shownub&&ua},ka,sa,wa,za,xa,ya));},applyToUFIComponents:function(ea,fa,ga,ha,ia){var ja=Object.keys(fa||{}).map(function(la){return fa[la];}),ka=[].concat(ea,ja,ga);this._applyToFirstComponent(ka,ha);ka.reverse();this._applyToFirstComponent(ka,ia);},_applyToFirstComponent:function(ea,fa){for(var ga=0;ga<(ea||[]).length;ga++)if(ea[ga]){y(ea[ga].props,fa);return;}},renderCommentMap:function(ea,fa){var ga=this.props,ha={},ia=ea.length;if(!ia)return ha;var ja=ea[0].parentcommentid,ka=[],la=function(){if(ka.length>0){var ta=function(ua,va){this.state.loadingSpamIDs[ua[0]]=true;this.forceUpdate();ga.onSpamFetch(ua,va);}.bind(this,ka,ja);ha['spam'+ka[0]]=x({onClick:ta,numHidden:ka.length,isLoading:!!this.state.loadingSpamIDs[ka[0]]});ka=[];}}.bind(this),ma=ga.instanceid,na=r.getKeyForInstance(ma,'editcommentid'),oa=!!ea[0].parentcommentid;for(var pa=0;pa<ia;pa++)if(ea[pa].status==p.UFIStatus.SPAM){ka.push(ea[pa].id);}else{la();var qa=Math.max(ga.loggingOffset-pa-fa,0),ra=ea[pa],sa;if(ra.id==na){sa=this.renderEditCommentBox(ra);}else{sa=this.renderComment(ra,qa);sa.props.isFirst=pa===0;sa.props.isLast=pa===ia-1;if(!oa)sa.props.showReplyLink=true;}ha['comment'+ra.id]=sa;if(ra.status!==p.UFIStatus.DELETED)ha['replies'+ra.id]=this.renderReplyContainer(ra);}la();return ha;},renderReplyContainer:function(ea){var fa=this.props,ga={};for(var ha=0;ha<(ea.replyauthors||[]).length;ha++){var ia=fa.authorProfiles[ea.replyauthors[ha]];if(ia)ga[ia.id]=ia;}var ja=fa.repliesMap&&fa.repliesMap[ea.id]&&this._shouldShowCommentReplies(ea.id),ka,la=fa.commentCounts[ea.id],ma=Math.max(la-ea.spamreplycount,0);if(ma&&this._shouldShowReplySocialSentence(ea.id)){var na=this._shouldShowCommentReplies(ea.id)&&(this.isLoadingPrev(ea.id)||this.isLoadingNext(ea.id));ka=v({authors:ga,replies:ma,timestamp:ea.recentreplytimestamp,onClick:this.onToggleReplies.bind(this,ea),isLoading:na,isExpanded:ja,showVerified:this.props.contextArgs.showverified&&this.props.feedback.showfeaturedreplies,orderingMode:this.props.orderingMode});}var oa,pa,qa,ra;if(ja){var sa=this.renderPagers(ea.id);oa=sa.topPager;qa=sa.bottomPager;pa=this.renderCommentMap(fa.repliesMap[ea.id],fa.ranges[ea.id].getOffset());var ta=Object.keys(pa);for(var ua=0;ua<ta.length;ua++){var va=pa[ta[ua]];if(va)va.props.hasPartialBorder=ua!==0;}if(fa.feedback.cancomment&&fa.canAddCommentMap[ea.id]){var wa=false,xa=Object.keys(pa);for(var ha=xa.length-1;ha>=0;ha--){var ya=xa[ha];if(ya&&pa[ya]){wa=pa[ya].props.isAuthorReply;break;}}ra=this.renderReplyComposer(ea,!wa);}}var za;if(ka||oa||pa||qa||ra){this.applyToUFIComponents([ka,oa],pa,[qa,ra],{isFirstComponent:true},{isLastComponent:true});var ab=ea.status===p.UFIStatus.LIVE_DELETED;za=q({isParentLiveDeleted:ab,isReplyList:true},ka,oa,pa,qa,ra);}return za;},renderReplyComposer:function(ea,fa){var ga=this.props;return (new m(null,ga.id,ea.id,ga.contextArgs)).renderAddComment(ga.authorProfiles[ga.feedback.actorforpost],ga.feedback.ownerid,ga.feedback.mentionsdatasource,false,'replycomposer-'+ea.id,fa,null,ga.feedback.allowphotoattachments,ga.feedback.allowstickerattachments,ga.feedback.isqanda);},renderEditCommentBox:function(ea){var fa=new m(null,this.props.id,null,{mentionsinput:this.props.contextArgs.mentionsinput}),ga=fa.renderEditComment(this.props.authorProfiles[this.props.feedback.actorforpost],this.props.feedback.ownerid,ea.id,this.props.feedback.mentionsdatasource,this.props.onEditAttempt.bind(null,ea),this.props.onCancelEdit,this.props.feedback.allowphotoattachments,this.props.feedback.allowstickerattachments,this.props.feedback.isqanda);return ga;},_shouldShowCommentReplies:function(ea){if(ea in this.state.instanceShowRepliesMap){return this.state.instanceShowRepliesMap[ea];}else if(ea in this.props.showRepliesMap)return this.props.showRepliesMap[ea];return false;},_shouldShowReplySocialSentence:function(ea){if(ea in this.state.instanceShowReplySocialSentenceMap){return this.state.instanceShowReplySocialSentenceMap[ea];}else if(ea in this.props.showReplySocialSentenceMap)return this.props.showReplySocialSentenceMap[ea];return false;},renderComment:function(ea,fa){var ga=this.props,ha=ga.feedback,ia=ha.actorforpost===ea.author,ja=r.getKeyForInstance(this.props.instanceid,'locallycomposed'),ka=ea.islocal||ja&&ja[ea.id],la=ha.showremovemenu||(ha.viewerid===ea.author),ma=ha.canremoveall&&ha.isownerpage&&!ia,na=ga.source!=p.UFIFeedbackSourceType.INTERN,oa=l.getTrackingInfo(l.types.COMMENT,fa),pa=!!ea.parentcommentid,qa=this._shouldShowCommentReplies(ea.id),ra=!!ea.isfeatured;return (o({comment:ea,authorProfiles:this.props.authorProfiles,viewerIsAuthor:ia,feedback:ha,'data-ft':oa,contextArgs:this.props.contextArgs,hideAsSpamForPageAdmin:ma,isLocallyComposed:ka,isReply:pa,isFeatured:ra,permalink:ga.commentPermalinks[ea.id],showPermalink:na,showRemoveReportMenu:la,showReplies:qa,focusOnMount:ea.id===this.state.commentIDToFocusOnMount,onCommentLikeToggle:ga.onCommentLikeToggle.bind(null,ea),onCommentReply:this.onCommentReply.bind(this,ea),onCommentTranslate:ga.onCommentTranslate.bind(null,ea),onEdit:ga.onCommentEdit.bind(null,ea),onHideAsSpam:ga.onCommentHideAsSpam.bind(null,ea),onInlineBan:ga.onCommentInlineBan.bind(null,ea),onMarkAsNotSpam:ga.onCommentMarkAsNotSpam.bind(null,ea),onOneClickRemove:ga.onCommentOneClickRemove.bind(null,ea),onPreviewRemove:ga.onPreviewRemove.bind(null,ea),onRemove:ga.onCommentRemove.bind(null,ea),onRetrySubmit:ga.onRetrySubmit.bind(null,ea),onUndoInlineBan:ga.onCommentUndoInlineBan.bind(null,ea),onUndoOneClickRemove:ga.onCommentUndoOneClickRemove.bind(null,ea)}));},_updateRepliesState:function(ea,fa,ga){var ha=this.state.instanceShowRepliesMap;ha[ea]=fa;var ia=this.state.instanceShowReplySocialSentenceMap;ia[ea]=ga;this.setState({instanceShowRepliesMap:ha,instanceShowReplySocialSentenceMap:ia,replyComposerIDToFocusOnMount:fa?'replycomposer-'+ea:null});},onToggleReplies:function(ea){var fa=!this._shouldShowCommentReplies(ea.id),ga=this.props.commentCounts[ea.id],ha=this._shouldShowReplySocialSentence(ea.id)&&!(fa&&ga<=this.props.replySocialSentenceMaxReplies);this._updateRepliesState(ea.id,fa,ha);var ia=this.props.ranges[ea.id].getRequestedLength();ia-=this.props.deletedCounts[ea.id];if(fa&&ia===0){var ja=this.props.commentCounts[ea.id],ka=Math.min(ja,this.props.pageSize);this.onPage(ea.id,ca.BOTTOM,{offset:ja-ka,length:ka});}},onPage:function(ea,fa,ga){var ha=this.state.hasPagedToplevel||ea===this.props.id,ia=y({},this.state.isActiveLoading);ia[ea]=fa;this.setState({isActiveLoading:ia,hasPagedToplevel:ha});this.props.onChangeRange(ea,ga);},isLoadingPrev:function(ea){var fa=this.props;ea=ea||fa.id;var ga=fa.ranges[ea].getRequestedOffset(),ha=fa.ranges[ea].getOffset();return ga<ha;},isLoadingNext:function(ea){var fa=this.props;ea=ea||fa.id;var ga=fa.ranges[ea].getRequestedOffset(),ha=fa.ranges[ea].getRequestedLength(),ia=fa.ranges[ea].getOffset(),ja=fa.ranges[ea].getLength();return ga+ha>ia+ja;},renderPagers:function(ea){var fa=this.props;ea=ea||fa.id;var ga=fa.ranges[ea].getOffset(),ha=fa.ranges[ea].getLength(),ia=fa.deletedCounts[ea],ja=fa.commentCounts[ea],ka=ja-ia,la=ha-ia,ma=fa.contextArgs.numberdelimiter||',',na=ea!==fa.id,oa={topPager:null,bottomPager:null};if(fa.source==p.UFIFeedbackSourceType.ADS)return oa;var pa=this.isLoadingPrev(ea),qa=this.isLoadingNext(ea);if(ha==ja)return oa;var ra=(ga+ha)==ja;if((ja<fa.pageSize&&ra)||la===0){var sa=Math.min(ja,fa.pageSize),ta=this.onPage.bind(this,ea,fa.feedback.isranked&&!na?ca.BOTTOM:ca.TOP,{offset:ja-sa,length:sa}),ua,va;if(la===0){if(ka==1){ua=u.VIEW_ONE;}else{va=h.formatIntegerWithDelimiter(ka,ma);ua=u.VIEW_ALL;}}else if(ka-la==1){ua=u.VIEW_ONE_MORE;}else{ua=u.VIEW_MORE_EXPLICIT;va=h.formatIntegerWithDelimiter(ka-la,ma);}var wa=l.getTrackingInfo(l.types.VIEW_ALL_COMMENTS),xa=u.getLabel(ua,na,fa.feedback.isqanda,{count:va}),ya=t({key:"allPager",contextArgs:fa.contextArgs,isUnseen:fa.feedback.hasunseencollapsed,isLoading:pa,pagerLabel:xa,onPagerClick:ta,'data-ft':wa});if(fa.feedback.isranked&&!na){oa.bottomPager=ya;}else oa.topPager=ya;return oa;}var za=u.getLabel(u.VIEW_MORE,na,fa.feedback.isqanda),ab=u.getLabel(u.VIEW_PREVIOUS,na,fa.feedback.isqanda);if(ga>0){var bb=Math.max(ga-fa.pageSize,0),sa=ga+ha-bb,cb=h.formatIntegerWithDelimiter(la,ma),db=h.formatIntegerWithDelimiter(ka,ma),eb=ba._("{countshown} of {totalcount}",{countshown:cb,totalcount:db}),fb;if(fa.feedback.isranked&&!na){fb=this.onPage.bind(this,ea,ca.BOTTOM,{offset:bb,length:sa});oa.bottomPager=t({key:"bottomPager",contextArgs:fa.contextArgs,isLoading:pa,pagerLabel:za,onPagerClick:fb,countSentence:eb});if(fa.feedback.isqanda&&fa.feedback.infinitescroll){var gb=aa(this.loadMoreComments.bind(this,ea,oa.bottomPager),20);g.listen(window,'scroll',gb);g.listen(window,'resize',gb);}}else{fb=this.onPage.bind(this,ea,ca.TOP,{offset:bb,length:sa});oa.topPager=t({key:"topPager",contextArgs:fa.contextArgs,isLoading:pa,pagerLabel:ab,onPagerClick:fb,countSentence:eb});}}if(ga+ha<ja){var hb=Math.min(ha+fa.pageSize,ja-ga),ib;if(fa.feedback.isranked&&!na){ib=this.onPage.bind(this,ea,ca.TOP,{offset:ga,length:hb});oa.topPager=t({key:"topPager",contextArgs:fa.contextArgs,isLoading:qa,pagerLabel:ab,onPagerClick:ib});}else{ib=this.onPage.bind(this,ea,ca.BOTTOM,{offset:ga,length:hb});oa.bottomPager=t({key:"bottomPager",contextArgs:fa.contextArgs,isLoading:qa,pagerLabel:za,onPagerClick:ib});}}return oa;},loadMoreComments:function(ea,fa){if(this.scrollSubscription&&fa.isMounted()&&!(ea in this.state.isActiveLoading)){var ga=fa.getDOMNode(),ha=document.body.scrollTop+p.infiniteScrollRangeForQANDAPermalinks;if(ga.offsetHeight&&ga.offsetTop<ha)fa.props.onPagerClick();}},onCommentReply:function(ea){var fa=ea.parentcommentid||ea.id;if(!this._shouldShowCommentReplies(fa)){this.onToggleReplies(ea);}else if(this.refs&&this.refs['replycomposer-'+fa])this.refs['replycomposer-'+fa].focus();},onComment:function(){if(this.refs&&this.refs.toplevelcomposer)this.refs.toplevelcomposer.focus();}});e.exports=da;});
__d("UFIReplyCommentList",["MercuryServerDispatcher","UFICentralUpdates","UFICommentList","UFIComments","UFIConstants","URI"],function(a,b,c,d,e,f){"use strict";var g=b('MercuryServerDispatcher'),h=b('UFICentralUpdates'),i=b('UFICommentList'),j=b('UFIComments'),k=b('UFIConstants'),l=b('URI'),m={};for(var n in i)if(i.hasOwnProperty(n))p[n]=i[n];var o=i===null?null:i.prototype;p.prototype=Object.create(o);p.prototype.constructor=p;p.__superConstructor__=i;p.getCommentList=function(s,t){if(!m[t])m[t]=new p(s,t);return m[t];};function p(s,t){i.call(this,s);this.parentCommentID=t;}p.prototype.fetchComments=function(s,t,u){g.trySend('/ajax/ufi/reply_fetch.php',{ft_ent_identifier:this.feedbackTargetID,parent_comment_ids:[this.parentCommentID],source:null,offsets:[s],lengths:[t]});};p.prototype.deferredCallback=function(s,t,u,v){var w={};for(var x=0;x<t;x++){var y=j.getComment(v[s+x]);if(y)w[s+x]=y;}u(w);};p.prototype.reset=function(){var s=o.reset.call(this),t={};for(var u in s){var v=s[u];t[v]=true;}j.resetComments(t);};p.prototype.getParentCommentID=function(){return this.parentCommentID;};p.prototype.buildCommentPermalink=function(s,t,u){if(!this.basePermalink)return null;var v=j.getComment(this.parentCommentID);return (l(this.basePermalink).addQueryData({comment_id:v.legacyid,reply_comment_id:t,total_comments:this.count}).toString());};g.registerEndpoints({'/ajax/ufi/reply_fetch.php':{mode:g.IMMEDIATE}});function q(s){var t=j.getComment(s.commentid),u=t.id,v=t.ftentidentifier,w=t.parentcommentid;if(!w)return;if(t.status!==k.UFIStatus.DELETED&&t.status!==k.UFIStatus.FAILED_ADD)p.getCommentList(v,w).deleteComment(u);}function r(s){var t=j.getComment(s.commentid),u=t.id,v=t.ftEntIdentifier,w=t.parentcommentid;if(!w)return;if(t.status===k.UFIStatus.DELETED)p.getCommentList(v,w).undoDeleteComment(u);}h.subscribe('update-actions',function(s,t){if(t.actions&&t.actions.length)for(var u=0;u<t.actions.length;u++){var v=t.actions[u];switch(v.actiontype){case k.UFIActionType.DELETE_COMMENT:q(v);break;case k.UFIActionType.UNDO_DELETE_COMMENT:r(v);break;}}});h.subscribe('update-comment-lists',function(s,t){var u=t.commentlists;if(u&&u.replies&&Object.keys(u).length)for(var v in u.replies){var w=u.replies[v],x=w.ftentidentifier;p.getCommentList(x,v).addCommentIDs(w.range.offset,w.range.length,w.values).updateCommentCount(w.count);}});h.subscribe('update-comments',function(s,t){if(t.comments&&t.comments.length)t.comments.forEach(function(u){var v=u.entidentifier,w=u.parentcommentid;if(!w)return;p.getCommentList(v,w).addComment(u.id,u.clientid,u.legacyid);});});e.exports=p;});
__d("UFIFeaturedReplyCommentList",["UFIReplyCommentList"],function(a,b,c,d,e,f){"use strict";var g=b('UFIReplyCommentList');for(var h in g)if(g.hasOwnProperty(h))j[h]=g[h];var i=g===null?null:g.prototype;j.prototype=Object.create(i);j.prototype.constructor=j;j.__superConstructor__=g;j.getCommentList=function(k,l){};function j(k,l,m,n){g.call(this,k,l);var o=0,p=m.length;this.updateCommentCount(p);this.addCommentIDs(o,p,m);var q={};n.forEach(function(r){q[r.id]=r;});m.forEach(function(r){var s=q[r];this.addComment(s.id,s.clientid,s.legacyid);}.bind(this));}j.prototype.fetchComments=function(k,l,m){};e.exports=j;});
__d("UFIFeaturedToplevelCommentList",["UFIConstants","UFIToplevelCommentList"],function(a,b,c,d,e,f){"use strict";var g=b('UFIConstants'),h=b('UFIToplevelCommentList');for(var i in h)if(h.hasOwnProperty(i))k[i]=h[i];var j=h===null?null:h.prototype;k.prototype=Object.create(j);k.prototype.constructor=k;k.__superConstructor__=h;k.getCommentList=function(l,m){};k.getCommentListsForFeedbackTargetID=function(l){};k.getCommentListForFeedbackTargetID_UNSAFE=function(l){};k.resetCommentListsForFeedbackTargetID=function(l){};function k(l,m,n){h.call(this,l,g.UFICommentOrderingMode.FEATURED);var o=0,p=m.length;this.updateCommentCount(p);this.addCommentIDs(o,p,m);var q={};n.forEach(function(r){q[r.id]=r;});m.forEach(function(r){var s=q[r];this.addComment(s.id,s.clientid,s.legacyid);}.bind(this));}k.prototype.fetchComments=function(l,m,n){};e.exports=k;});
__d("UFIRange",[],function(a,b,c,d,e,f){"use strict";function g(h,i){this.offset=h||0;this.length=i||0;this.requestedOffset=this.offset;this.requestedLength=this.length;}g.prototype.getOffset=function(){return this.offset;};g.prototype.getLength=function(){return this.length;};g.prototype.updateRange=function(h,i){this.offset=h;this.length=i;if(this.requestedLength>0){var j=Math.min(this.offset,this.requestedOffset),k=Math.max(this.offset+this.length,this.requestedOffset+this.requestedLength);this.requestedOffset=j;this.requestedLength=k-j;}else{this.requestedOffset=this.offset;this.requestedLength=this.length;}};g.prototype.getRequestedOffset=function(){return this.requestedOffset;};g.prototype.getRequestedLength=function(){return this.requestedLength;};g.prototype.updateRequestedRange=function(h,i){this.requestedOffset=h;this.requestedLength=i;};e.exports=g;});
__d("UFIController",["Arbiter","Bootloader","CSS","DOM","LayerRemoveOnHide","LiveTimer","Parent","React","ReactMount","ShortProfiles","UFI.react","UFIActionLinkController","UFICentralUpdates","UFIFeaturedReplyCommentList","UFIFeaturedToplevelCommentList","UFICommentTemplates","UFIConstants","UFIFeedbackTargets","UFIInstanceState","UFIRange","UFIReplyCommentList","UFIToplevelCommentList","UFIUserActions","URI","isEmpty","onEnclosingPageletDestroy","tx"],function(a,b,c,d,e,f){"use strict";var g=b('Arbiter'),h=b('Bootloader'),i=b('CSS'),j=b('DOM'),k=b('LayerRemoveOnHide'),l=b('LiveTimer'),m=b('Parent'),n=b('React'),o=b('ReactMount'),p=b('ShortProfiles'),q=b('UFI.react'),r=b('UFIActionLinkController'),s=b('UFICentralUpdates'),t=b('UFIFeaturedReplyCommentList'),u=b('UFIFeaturedToplevelCommentList'),v=b('UFICommentTemplates'),w=b('UFIConstants'),x=b('UFIFeedbackTargets'),y=b('UFIInstanceState'),z=b('UFIRange'),aa=b('UFIReplyCommentList'),ba=b('UFIToplevelCommentList'),ca=b('UFIUserActions'),da=b('URI'),ea=b('isEmpty'),fa=b('onEnclosingPageletDestroy'),ga=b('tx'),ha=function(la,ma,na,oa,pa){var qa=la+ma===na;return {offset:la,length:(qa&&ia(pa))?oa-la:ma};},ia=function(la){return la==w.UFIPayloadSourceType.USER_ACTION||la==w.UFIPayloadSourceType.LIVE_SEND;},ja=function(la,ma){for(var na=0;na<ma.length;na++){var oa=ma[na];if(oa.author)la.push(oa.author);if(oa.socialcontext)la.push(oa.socialcontext.topmutualid);if(oa.replyauthors&&oa.replyauthors.length)for(var pa=0;pa<oa.replyauthors.length;pa++)la.push(oa.replyauthors[pa]);}};function ka(la,ma,na){this.root=la;this.id=ma.ftentidentifier;this.source=ma.source;this.$UFIController0=ma.instanceid;this.featuredToplevelCommentList=null;this.featuredReplyCommentLists={};this.$UFIController1=ma;this.$UFIController1.rootid=this.root.id;this.$UFIController2=false;var oa=na.feedbacktargets[0];this.actionLink=new r(la,this.$UFIController1,oa);this.orderingMode=oa.defaultcommentorderingmode;var pa=null;if(na.featuredcommentlists&&na.featuredcommentlists.comments&&na.featuredcommentlists.comments[this.id]){pa=na.featuredcommentlists.comments[this.id];this.featuredToplevelCommentList=new u(this.id,pa.values,na.comments);}else pa=na.commentlists.comments[this.id][this.orderingMode];this.ranges={};this.replyRanges={};this.repliesMap={};this.showRepliesMap={};this.showReplySocialSentenceMap={};this.commentcounts={};this.commentcounts[this.id]=this.getToplevelCommentList().getCommentCount();var qa=oa.orderingmodes||[{value:this.orderingMode}];qa.forEach(function(ua){this.ranges[ua.value]=new z(pa.range.offset,pa.range.length);}.bind(this));var ra,sa,ta;if(na.commentlists.replies)for(ra=0;ra<pa.values.length;ra++){sa=pa.values[ra];ta=na.commentlists.replies[sa];if(ta){this.commentcounts[sa]=this.getReplyCommentList(sa).getCommentCount();this.getReplyRange(sa).updateRange(ta.range.offset,ta.range.length);}}if(na.featuredcommentlists)if(na.featuredcommentlists.replies)for(ra=0;ra<pa.values.length;ra++){sa=pa.values[ra];ta=na.featuredcommentlists.replies[sa];if(ta){this.featuredReplyCommentLists[sa]=new t(this.id,sa,ta.values,na.comments);this.commentcounts[sa]=this.getReplyCommentList(sa).getCommentCount();this.getReplyRange(sa).updateRange(ta.range.offset,ta.range.length);}}this.$UFIController3=null;this.$UFIController4=null;this.ufiCentralUpdatesSubscriptions=[s.subscribe('feedback-updated',function(ua,va){var wa=va.updates,xa=va.payloadSource;if(xa!=w.UFIPayloadSourceType.COLLAPSED_UFI&&this.id in wa)this.fetchAndUpdate(this.render.bind(this),xa);}.bind(this)),s.subscribe('feedback-id-changed',function(ua,va){var wa=va.updates;if(this.id in wa)this.id=wa[this.id];}.bind(this)),s.subscribe('instance-updated',function(ua,va){var wa=va.updates;if(this.$UFIController0 in wa){var xa=wa[this.$UFIController0];if(xa.editcommentid)this.render(va.payloadSource);}}.bind(this))];this.clearPageletSubscription=fa(this.root,this.$UFIController6.bind(this));this.clearPageSubscription=g.subscribe('ufi/page_cleared',this.$UFIController7.bind(this));s.handleUpdate(w.UFIPayloadSourceType.INITIAL_SERVER,na);if(this.$UFIController1.viewas)this.viewasUFICleanSubscription=g.subscribe('pre_page_transition',function(ua,va){if(this.$UFIController1.viewas!==da(va.to).getQueryData('viewas'))ba.resetCommentListsForFeedbackTargetID(this.id);}.bind(this));h.loadModules(["ScrollAwareDOM"],function(ua){o.scrollMonitor=ua.monitor;});if(ma.notifyonload)g.inform('inlineStory/ufiLoaded');}ka.prototype.$UFIController8=function(){if(!this.$UFIController9)this.$UFIController9=m.byTag(this.root,'form');return this.$UFIController9;};ka.prototype.$UFIControllera=function(event){var la=!this.feedback.hasviewerliked;ca.changeLike(this.id,la,{source:this.source,target:event.target,rootid:this.$UFIController1.rootid});event.preventDefault();};ka.prototype.$UFIControllerb=function(la,event){var ma=!la.hasviewerliked;ca.changeCommentLike(la.id,ma,{source:this.source,target:event.target});};ka.prototype.$UFIControllerc=function(la){y.updateState(this.$UFIController0,'isediting',true);y.updateState(this.$UFIController0,'editcommentid',la.id);};ka.prototype.$UFIControllerd=function(la,ma,event){if(!ma.visibleValue&&!ma.attachedPhoto&&!ma.attachedSticker){this.$UFIControllere(la,event);}else ca.editComment(la.id,ma.visibleValue,ma.encodedValue,{source:this.$UFIController1.source,target:event.target,attachedPhoto:ma.attachedPhoto,attachedSticker:ma.attachedSticker});y.updateStateField(this.$UFIController0,'locallycomposed',la.id,true);this.$UFIControllerf();};ka.prototype.$UFIControllerf=function(){y.updateState(this.$UFIController0,'isediting',false);y.updateState(this.$UFIController0,'editcommentid',null);};ka.prototype.$UFIControllere=function(la,event){var ma=v[':fb:ufi:hide-dialog-template'].build();j.setContent(ma.getNode('body'),"Are you sure you want to delete this comment?");j.setContent(ma.getNode('title'),"Delete Comment");h.loadModules(["DialogX"],function(na){var oa=new na({modal:true,width:465,addedBehaviors:[k]},ma.getRoot());oa.subscribe('confirm',function(){ca.removeComment(la.id,{source:this.source,oneclick:false,target:event.target,timelinelogdata:this.$UFIController1.timelinelogdata});oa.hide();}.bind(this));oa.show();}.bind(this));};ka.prototype.$UFIControllerg=function(la,event){ca.removeComment(la.id,{source:this.source,oneclick:true,target:event.target,timelinelogdata:this.$UFIController1.timelinelogdata});};ka.prototype.$UFIControllerh=function(la,event){var ma=this.feedback.canremoveall&&this.feedback.isownerpage&&this.feedback.actorforpost!==this.authorProfiles[la.author];ca.undoRemoveComment(la.id,ma,{source:this.source,target:event.target});};ka.prototype.$UFIControlleri=function(la,event){ca.setHideAsSpam(la.id,true,{source:this.source,target:event.target});};ka.prototype.$UFIControllerj=function(la,event){ca.setHideAsSpam(la.id,false,{source:this.source,target:event.target});};ka.prototype.$UFIControllerk=function(la,event){ca.translateComment(la,{source:this.source,target:event.target});};ka.prototype.$UFIControllerl=function(la,ma,event){ca.banUser(la,this.feedback.ownerid,ma,{source:this.source,target:event.target});};ka.prototype.$UFIControllerm=function(la,event){this.$UFIControllerl(la,true,event);};ka.prototype.$UFIControllern=function(la,event){this.$UFIControllerl(la,false,event);};ka.prototype.$UFIControllero=function(la,ma){ca.fetchSpamComments(this.id,la,ma,this.$UFIController1.viewas);};ka.prototype.$UFIControllerp=function(la,event){ca.removePreview(la,{source:this.source,target:event.target});};ka.prototype.$UFIControllerq=function(la){h.loadModules(["UFIRetryActions"],function(ma){ma.retrySubmit(la,{source:this.source});}.bind(this));};ka.prototype.$UFIControllerr=function(){if(this.$UFIController2)return;var la=m.byTag(this.root,'form');if(la){i.removeClass(la,'collapsed_comments');this.$UFIController2=true;}};ka.prototype.setRange=function(la){this.getRange().updateRange(la.offset,la.length);};ka.prototype.setReplyRange=function(la,ma){this.getReplyRange(la).updateRange(ma.offset,ma.length);};ka.prototype.render=function(la){var ma=this.comments.length||!ea(this.feedback.likesentences.current);if(ma&&ia(la))this.$UFIControllerr();var na=this.getRange();if(this.$UFIController3===null)this.$UFIController3=na.getOffset()+na.getLength()-1;var oa=this.feedback.replysocialsentencemaxreplies||-1,pa={};pa[this.id]=this.getToplevelCommentList().getDeletedCount();var qa={},ra={};ra[this.id]=!this.featuredToplevelCommentList;this.comments.forEach(function(wa){var xa=wa.id;pa[xa]=this.getReplyCommentList(xa).getDeletedCount();qa[xa]=this.getToplevelCommentList().getPermalinkForComment(xa);ra[xa]=!this.featuredReplyCommentLists[xa];if(this.repliesMap[xa])this.repliesMap[xa].forEach(function(ya){var za=ya.id;qa[za]=aa.getCommentList(this.id,xa).getPermalinkForComment(za);}.bind(this));}.bind(this));var sa={};sa[this.id]=na;for(var ta in this.replyRanges)sa[ta]=this.replyRanges[ta];var ua=!!this.featuredToplevelCommentList,va=q({feedback:this.feedback,id:this.id,onTargetLikeToggle:this.$UFIControllera.bind(this),onCommentLikeToggle:this.$UFIControllerb.bind(this),onCommentRemove:this.$UFIControllere.bind(this),onCommentHideAsSpam:this.$UFIControlleri.bind(this),onCommentMarkAsNotSpam:this.$UFIControllerj.bind(this),onCommentEdit:this.$UFIControllerc.bind(this),onCommentOneClickRemove:this.$UFIControllerg.bind(this),onCommentUndoOneClickRemove:this.$UFIControllerh.bind(this),onCommentTranslate:this.$UFIControllerk.bind(this),onCommentInlineBan:this.$UFIControllerm.bind(this),onCommentUndoInlineBan:this.$UFIControllern.bind(this),onEditAttempt:this.$UFIControllerd.bind(this),onCancelEdit:this.$UFIControllerf.bind(this),onChangeRange:this.$UFIControllers.bind(this),onSpamFetch:this.$UFIControllero.bind(this),onPreviewRemove:this.$UFIControllerp.bind(this),onRetrySubmit:this.$UFIControllerq.bind(this),onOrderingModeChange:this.$UFIControllert.bind(this),contextArgs:this.$UFIController1,repliesMap:this.repliesMap,showRepliesMap:this.showRepliesMap,showReplySocialSentenceMap:this.showReplySocialSentenceMap,commentCounts:this.commentcounts,deletedCounts:pa,availableComments:this.comments,source:this.source,ranges:sa,pageSize:w.defaultPageSize,authorProfiles:this.authorProfiles,instanceid:this.$UFIController0,loggingOffset:this.$UFIController3,replySocialSentenceMaxReplies:oa,orderingMode:this.orderingMode,hideOrderingModeSelector:ua,commentPermalinks:qa,canAddCommentMap:ra});this.$UFIController4=n.renderComponent(va,this.root);l.updateTimeStamps();if(this.$UFIController8())g.inform('ufi/changed',{form:this.$UFIController8()});if(la!=w.UFIPayloadSourceType.INITIAL_SERVER&&la!=w.UFIPayloadSourceType.COLLAPSED_UFI)g.inform('reflow');};ka.prototype.deferredCallback=function(la,ma,na,oa){la.callbackCount++;if(la.callbackCount<la.expectedCallbackCount)return;p.getMulti(ma,function(pa){this.authorProfiles=pa;oa(na);if(na==w.UFIPayloadSourceType.ENDPOINT_COMMENT_FETCH)g.inform('CommentUFI.Pager');}.bind(this));};ka.prototype.fetchAndUpdate=function(la,ma){x.getFeedbackTarget(this.id,function(na){this.feedback=na;var oa=this.getToplevelCommentList(this.orderingMode).getCommentCount(),pa=this.getRange(),qa=ha(pa.getRequestedOffset(),pa.getRequestedLength(),this.commentcounts[this.id],oa,ma),ra=[];if(this.feedback.actorforpost)ra.push(this.feedback.actorforpost);var sa={expectedCallbackCount:0,callbackCount:0},ta=qa.offset,ua=qa.length,va;if(this.$UFIController1.viewas)va=this.$UFIController1.viewas+'';this.getToplevelCommentList().getComments(ta,ua,va,function(wa,xa,ya){this.commentcounts[this.id]=xa;this.setRange(wa);this.comments=[];for(var za in ya)this.comments.push(ya[za]);ja(ra,this.comments);if(this.feedback.isthreaded&&this.comments.length){sa.expectedCallbackCount=this.comments.length;}else sa.expectedCallbackCount=1;for(var ab in ya){var bb=ya[ab],cb=bb.id;if(this.feedback.isthreaded){var db=this.getReplyCommentList(cb).getCommentCount(),eb;if(this.replyRanges[cb]){var fb=this.getReplyRange(cb);eb=ha(fb.getRequestedOffset(),fb.getRequestedLength(),this.commentcounts[cb],db,ma);}else eb={offset:0,length:Math.min(db,2)};var gb=eb.offset,hb=eb.length;this.getReplyCommentList(cb).getComments(gb,hb,null,function(ib,jb,kb,lb){this.commentcounts[ib]=kb;this.setReplyRange(ib,jb);this.repliesMap[ib]=[];for(var mb in lb)this.repliesMap[ib].push(lb[mb]);ja(ra,this.repliesMap[ib]);this.showRepliesMap[ib]=jb.length>0;if(this.showReplySocialSentenceMap[ib]===undefined&&this.commentcounts[ib]>0)this.showReplySocialSentenceMap[ib]=!this.showRepliesMap[ib];this.deferredCallback(sa,ra,ma,la);}.bind(this,cb,eb,db));}}if(!this.feedback.isthreaded||!this.comments.length)this.deferredCallback(sa,ra,ma,la);}.bind(this,qa,oa));}.bind(this));};ka.prototype.getToplevelCommentList=function(){if(this.featuredToplevelCommentList)return this.featuredToplevelCommentList;return ba.getCommentList(this.id,this.orderingMode);};ka.prototype.getReplyCommentList=function(la){if(la in this.featuredReplyCommentLists)return this.featuredReplyCommentLists[la];return aa.getCommentList(this.id,la);};ka.prototype.getRange=function(){if(!(this.orderingMode in this.ranges))this.ranges[this.orderingMode]=new z();return this.ranges[this.orderingMode];};ka.prototype.getReplyRange=function(la){if(!(la in this.replyRanges))this.replyRanges[la]=new z();return this.replyRanges[la];};ka.prototype.$UFIControllers=function(la,ma){if(la==this.id){this.getRange().updateRequestedRange(ma.offset,ma.length);}else this.replyRanges[la].updateRequestedRange(ma.offset,ma.length);this.fetchAndUpdate(this.render.bind(this),w.UFIPayloadSourceType.USER_ACTION);};ka.prototype.$UFIController6=function(){n.unmountComponentAtNode(this.root);this.ufiCentralUpdatesSubscriptions.forEach(s.unsubscribe.bind(s));g.unsubscribe(this.clearPageSubscription);this.viewasUFICleanSubscription&&g.unsubscribe(this.viewasUFICleanSubscription);};ka.prototype.$UFIController7=function(){this.$UFIController6();g.unsubscribe(this.clearPageletSubscription);};ka.prototype.$UFIControllert=function(la){this.orderingMode=la;this.fetchAndUpdate(this.render.bind(this),w.UFIPayloadSourceType.USER_ACTION);};e.exports=ka;});